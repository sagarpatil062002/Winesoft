[2025-10-15 05:19:15] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 05:19:15] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-15 05:19:15] POST data: {
    "mode": "F",
    "voc_no": "9",
    "date": "2025-08-31",
    "auto_tp_no": "FL173-310825\/7587",
    "tp_no": "7585",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "BHARAT WINES",
    "supplier_code": "BHAR",
    "items": [
        {
            "code": "SCMPL0034977",
            "name": "ICONIQ WHITE FINEST INTERNATIONAL GRAIN WHISKY .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "171",
            "auto_batch": "BTP14-250725\/168",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "460"
        },
        {
            "code": "SCMPL0034978",
            "name": "ICONIQ WHITE FINEST INTERNATIONAL GRAIN WHISKY .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "206",
            "auto_batch": "BTP14-130825\/203",
            "mfg_month": "Aug-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "230"
        },
        {
            "code": "SCMPL0038199",
            "name": "ICONIQ WHITE FINEST INTERNATIONAL GRAIN WHISKY .",
            "size": "2000 ML Pet (6)",
            "bottles_per_case": "6",
            "batch_no": "202",
            "auto_batch": "BTP14-090825\/199",
            "mfg_month": "Aug-2025",
            "bl": "12",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "2300"
        },
        {
            "code": "SCMWN0041743",
            "name": "SAMSON XXX PREMIUM QUALITY FORTIFIED WINE .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "SM02",
            "auto_batch": "BTWN44-170825\/11",
            "mfg_month": "Aug-2025",
            "bl": "38.88",
            "vv": "24",
            "tot_bott": "216",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "4",
            "bottles": "24",
            "case_rate": "800.000",
            "mrp": "58"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "24900.00",
    "tamt": "24900.00"
}
[2025-10-15 05:19:15] GET data: []
[2025-10-15 05:19:15] Company ID from session: 1
[2025-10-15 05:19:15] Database connection included
[2025-10-15 05:19:15] License functions included
[2025-10-15 05:19:15] License type: FL-II
[2025-10-15 05:19:15] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 05:19:15] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 05:19:15] Purchase mode: F
[2025-10-15 05:19:15] Next voucher number: 9
[2025-10-15 05:19:15] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 05:19:15] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 05:19:16] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 05:19:16] Suppliers fetched: {
    "count": 36
}
[2025-10-15 05:19:16] === FORM SUBMISSION STARTED ===
[2025-10-15 05:19:16] Form data extracted: {
    "date": "2025-08-31",
    "voc_no": "9",
    "auto_tp_no": "FL173-310825\/7587",
    "tp_no": "7585",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "BHAR",
    "supplier_name": "BHARAT WINES",
    "basic_amt": "24900.00",
    "total_amt": "24900.00"
}
[2025-10-15 05:19:16] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-08-31",
        "BHAR",
        "FL173-310825\/7587",
        "9",
        "",
        "",
        "24900.00",
        "7585",
        "2025-08-31",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-15 05:40:50] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 05:40:50] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-15 05:40:50] POST data: []
[2025-10-15 05:40:50] GET data: []
[2025-10-15 05:40:50] Company ID from session: 1
[2025-10-15 05:40:50] Database connection included
[2025-10-15 05:40:50] License functions included
[2025-10-15 05:40:50] License type: FL-II
[2025-10-15 05:40:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 05:40:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 05:40:50] Purchase mode: F
[2025-10-15 05:40:50] Next voucher number: 9
[2025-10-15 05:40:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 05:40:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 05:40:50] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 05:40:50] Suppliers fetched: {
    "count": 36
}
[2025-10-15 05:43:02] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 05:43:02] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "success_message": "Supplier updated successfully!"
}
[2025-10-15 05:43:02] POST data: []
[2025-10-15 05:43:02] GET data: []
[2025-10-15 05:43:02] Company ID from session: 1
[2025-10-15 05:43:02] Database connection included
[2025-10-15 05:43:02] License functions included
[2025-10-15 05:43:02] License type: FL-II
[2025-10-15 05:43:02] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 05:43:02] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 05:43:02] Purchase mode: F
[2025-10-15 05:43:02] Next voucher number: 9
[2025-10-15 05:43:02] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 05:43:02] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 05:43:02] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 05:43:02] Suppliers fetched: {
    "count": 36
}
[2025-10-15 05:43:02] Database connection closed
[2025-10-15 05:43:02] === PURCHASE SESSION ENDED ===
[2025-10-15 05:45:13] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 05:45:13] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "success_message": "Supplier updated successfully!"
}
[2025-10-15 05:45:13] POST data: []
[2025-10-15 05:45:13] GET data: []
[2025-10-15 05:45:13] Company ID from session: 1
[2025-10-15 05:45:13] Database connection included
[2025-10-15 05:45:13] License functions included
[2025-10-15 05:45:13] License type: FL-II
[2025-10-15 05:45:13] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 05:45:13] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 05:45:13] Purchase mode: F
[2025-10-15 05:45:13] Next voucher number: 9
[2025-10-15 05:45:13] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 05:45:13] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 05:45:13] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 05:45:13] Suppliers fetched: {
    "count": 36
}
[2025-10-15 05:45:14] Database connection closed
[2025-10-15 05:45:14] === PURCHASE SESSION ENDED ===
[2025-10-15 05:47:15] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 05:47:15] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "success_message": "Supplier updated successfully!"
}
[2025-10-15 05:47:15] POST data: []
[2025-10-15 05:47:15] GET data: []
[2025-10-15 05:47:15] Company ID from session: 1
[2025-10-15 05:47:15] Database connection included
[2025-10-15 05:47:15] License functions included
[2025-10-15 05:47:15] License type: FL-II
[2025-10-15 05:47:15] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 05:47:15] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 05:47:15] Purchase mode: F
[2025-10-15 05:47:15] Next voucher number: 9
[2025-10-15 05:47:15] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 05:47:15] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 05:47:15] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 05:47:15] Suppliers fetched: {
    "count": 36
}
[2025-10-15 05:47:15] Database connection closed
[2025-10-15 05:47:15] === PURCHASE SESSION ENDED ===
[2025-10-15 05:47:38] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 05:47:38] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "success_message": "Supplier updated successfully!"
}
[2025-10-15 05:47:38] POST data: {
    "mode": "F",
    "voc_no": "9",
    "date": "2025-07-01",
    "auto_tp_no": "CL2296-300625\/1197",
    "tp_no": "1197",
    "tp_date": "2025-06-30",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMCL0012761",
            "name": "DESHI DARU TANGO PUNCH-NV .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "149",
            "auto_batch": "BTC27-280625\/149",
            "mfg_month": "Jun-2025",
            "bl": "180",
            "vv": "42.8",
            "tot_bott": "2000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "20",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "40"
        },
        {
            "code": "SCMCL0013629",
            "name": "ICAP SANTRA .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "87",
            "auto_batch": "BTC32-300625\/87",
            "mfg_month": "Jun-2025",
            "bl": "90",
            "vv": "35.7",
            "tot_bott": "1000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "25"
        },
        {
            "code": "SCMCL0013677",
            "name": "THREE X-Sangali .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "84",
            "auto_batch": "BTC32-280625\/84",
            "mfg_month": "Jun-2025",
            "bl": "180",
            "vv": "42.8",
            "tot_bott": "2000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "20",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "40"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "6000.00",
    "tamt": "6000.00"
}
[2025-10-15 05:47:38] GET data: []
[2025-10-15 05:47:38] Company ID from session: 1
[2025-10-15 05:47:38] Database connection included
[2025-10-15 05:47:38] License functions included
[2025-10-15 05:47:38] License type: FL-II
[2025-10-15 05:47:38] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 05:47:38] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 05:47:38] Purchase mode: F
[2025-10-15 05:47:38] Next voucher number: 9
[2025-10-15 05:47:38] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 05:47:38] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 05:47:38] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 05:47:38] Suppliers fetched: {
    "count": 36
}
[2025-10-15 05:47:38] === FORM SUBMISSION STARTED ===
[2025-10-15 05:47:38] Form data extracted: {
    "date": "2025-07-01",
    "voc_no": "9",
    "auto_tp_no": "CL2296-300625\/1197",
    "tp_no": "1197",
    "tp_date": "2025-06-30",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "6000.00",
    "total_amt": "6000.00"
}
[2025-10-15 05:47:38] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-07-01",
        "RAJ",
        "CL2296-300625\/1197",
        "9",
        "",
        "",
        "6000.00",
        "1197",
        "2025-06-30",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-15 05:47:38] Purchase header inserted successfully: {
    "purchase_id": 10,
    "affected_rows": 1
}
[2025-10-15 05:47:38] Starting to process purchase items: {
    "item_count": 3
}
[2025-10-15 05:47:38] Processing item 0: {
    "item_code": "SCMCL0012761",
    "item_name": "DESHI DARU TANGO PUNCH-NV .",
    "cases": 20,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 2400,
    "tot_bott": 2000,
    "bl": 180
}
[2025-10-15 05:47:38] Item 0 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMCL0012761"
}
[2025-10-15 05:47:38] Checking if month is archived: {
    "company_id": 1,
    "month": "7",
    "year": "2025",
    "archive_table": "tbldailystock_1_07_25"
}
[2025-10-15 05:47:38] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_07_25'"
}
[2025-10-15 05:47:39] Processing item 1: {
    "item_code": "SCMCL0013629",
    "item_name": "ICAP SANTRA .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1200,
    "tot_bott": 1000,
    "bl": 90
}
[2025-10-15 05:47:39] Item 1 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMCL0013629"
}
[2025-10-15 05:47:39] Checking if month is archived: {
    "company_id": 1,
    "month": "7",
    "year": "2025",
    "archive_table": "tbldailystock_1_07_25"
}
[2025-10-15 05:47:39] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_07_25'"
}
[2025-10-15 05:47:39] Processing item 2: {
    "item_code": "SCMCL0013677",
    "item_name": "THREE X-Sangali .",
    "cases": 20,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 2400,
    "tot_bott": 2000,
    "bl": 180
}
[2025-10-15 05:47:39] Item 2 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMCL0013677"
}
[2025-10-15 05:47:39] Checking if month is archived: {
    "company_id": 1,
    "month": "7",
    "year": "2025",
    "archive_table": "tbldailystock_1_07_25"
}
[2025-10-15 05:47:39] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_07_25'"
}
[2025-10-15 05:47:39] Purchase items processing completed: {
    "successful_items": 3,
    "total_items": 3
}
[2025-10-15 05:47:39] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-15 16:29:35] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 16:29:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-15 16:29:35] POST data: []
[2025-10-15 16:29:35] GET data: {
    "mode": "F"
}
[2025-10-15 16:29:35] Company ID from session: 1
[2025-10-15 16:29:35] Database connection included
[2025-10-15 16:29:35] License functions included
[2025-10-15 16:29:35] License type: FL-II
[2025-10-15 16:29:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 16:29:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 16:29:35] Purchase mode: F
[2025-10-15 16:29:35] Next voucher number: 10
[2025-10-15 16:29:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 16:29:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 16:29:35] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 16:29:35] Suppliers fetched: {
    "count": 36
}
[2025-10-15 16:29:35] Database connection closed
[2025-10-15 16:29:35] === PURCHASE SESSION ENDED ===
[2025-10-15 16:30:36] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 16:30:36] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-15 16:30:36] POST data: []
[2025-10-15 16:30:36] GET data: {
    "mode": "F"
}
[2025-10-15 16:30:36] Company ID from session: 1
[2025-10-15 16:30:36] Database connection included
[2025-10-15 16:30:36] License functions included
[2025-10-15 16:30:36] License type: FL-II
[2025-10-15 16:30:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 16:30:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 16:30:36] Purchase mode: F
[2025-10-15 16:30:36] Next voucher number: 10
[2025-10-15 16:30:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 16:30:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 16:30:36] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 16:30:36] Suppliers fetched: {
    "count": 36
}
[2025-10-15 16:30:36] Database connection closed
[2025-10-15 16:30:36] === PURCHASE SESSION ENDED ===
[2025-10-15 16:42:39] === NEW PURCHASE SESSION STARTED ===
[2025-10-15 16:42:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-15 16:42:39] POST data: []
[2025-10-15 16:42:39] GET data: {
    "mode": "F"
}
[2025-10-15 16:42:39] Company ID from session: 1
[2025-10-15 16:42:39] Database connection included
[2025-10-15 16:42:39] License functions included
[2025-10-15 16:42:39] License type: FL-II
[2025-10-15 16:42:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-15 16:42:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-15 16:42:39] Purchase mode: F
[2025-10-15 16:42:39] Next voucher number: 10
[2025-10-15 16:42:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-15 16:42:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-15 16:42:39] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-15 16:42:39] Suppliers fetched: {
    "count": 36
}
[2025-10-15 16:42:40] Database connection closed
[2025-10-15 16:42:40] === PURCHASE SESSION ENDED ===
[2025-10-16 05:06:35] === NEW PURCHASE SESSION STARTED ===
[2025-10-16 05:06:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-16 05:06:35] POST data: []
[2025-10-16 05:06:35] GET data: []
[2025-10-16 05:06:35] Company ID from session: 1
[2025-10-16 05:06:35] Database connection included
[2025-10-16 05:06:35] License functions included
[2025-10-16 05:06:35] License type: FL-II
[2025-10-16 05:06:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-16 05:06:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-16 05:06:35] Purchase mode: F
[2025-10-16 05:06:35] Next voucher number: 10
[2025-10-16 05:06:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-16 05:06:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-16 05:06:35] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-16 05:06:35] Suppliers fetched: {
    "count": 36
}
[2025-10-16 05:06:35] Database connection closed
[2025-10-16 05:06:35] === PURCHASE SESSION ENDED ===
[2025-10-16 06:25:56] === NEW PURCHASE SESSION STARTED ===
[2025-10-16 06:25:56] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-16 06:25:56] POST data: []
[2025-10-16 06:25:56] GET data: []
[2025-10-16 06:25:56] Company ID from session: 1
[2025-10-16 06:25:56] Database connection included
[2025-10-16 06:25:56] License functions included
[2025-10-16 06:25:56] License type: FL-II
[2025-10-16 06:25:56] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-16 06:25:56] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-16 06:25:56] Purchase mode: F
[2025-10-16 06:25:56] Next voucher number: 10
[2025-10-16 06:25:56] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-16 06:25:56] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-16 06:25:56] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-16 06:25:56] Suppliers fetched: {
    "count": 36
}
[2025-10-16 06:25:56] Database connection closed
[2025-10-16 06:25:56] === PURCHASE SESSION ENDED ===
[2025-10-16 06:26:33] === NEW PURCHASE SESSION STARTED ===
[2025-10-16 06:26:33] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-16 06:26:33] POST data: []
[2025-10-16 06:26:33] GET data: []
[2025-10-16 06:26:33] Company ID from session: 1
[2025-10-16 06:26:33] Database connection included
[2025-10-16 06:26:33] License functions included
[2025-10-16 06:26:33] License type: FL-II
[2025-10-16 06:26:33] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-16 06:26:33] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-16 06:26:33] Purchase mode: F
[2025-10-16 06:26:33] Next voucher number: 10
[2025-10-16 06:26:33] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-16 06:26:33] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-16 06:26:33] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-16 06:26:33] Suppliers fetched: {
    "count": 36
}
[2025-10-16 06:26:33] Database connection closed
[2025-10-16 06:26:33] === PURCHASE SESSION ENDED ===
[2025-10-16 06:26:57] === NEW PURCHASE SESSION STARTED ===
[2025-10-16 06:26:57] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-16 06:26:57] POST data: {
    "mode": "F",
    "voc_no": "10",
    "date": "2025-05-15",
    "auto_tp_no": "CL2296-150525\/574",
    "tp_no": "574",
    "tp_date": "2025-05-15",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMCL0012761",
            "name": "DESHI DARU TANGO PUNCH-NV .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "45",
            "auto_batch": "BTC27-050525\/45",
            "mfg_month": "May-2025",
            "bl": "180",
            "vv": "42.8",
            "tot_bott": "2000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "20",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "35"
        },
        {
            "code": "SCMCL0012763",
            "name": "DESHI DARU TANGO PUNCH-NV .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "45",
            "auto_batch": "BTC27-050525\/45",
            "mfg_month": "May-2025",
            "bl": "43.2",
            "vv": "42.8",
            "tot_bott": "240",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "70"
        },
        {
            "code": "SCMCL0012765",
            "name": "DESHI DARU TANGO PUNCH-NV .",
            "size": "750 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "6",
            "auto_batch": "BTC27-050425\/6",
            "mfg_month": "Apr-2025",
            "bl": "18",
            "vv": "42.8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "290"
        },
        {
            "code": "SCMCL0013629",
            "name": "ICAP SANTRA .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "17",
            "auto_batch": "BTC32-170425\/17",
            "mfg_month": "Apr-2025",
            "bl": "45",
            "vv": "35.7",
            "tot_bott": "500",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "25"
        },
        {
            "code": "SCMCL0013677",
            "name": "THREE X-Sangali .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "28",
            "auto_batch": "BTC32-300425\/28",
            "mfg_month": "May-2025",
            "bl": "225",
            "vv": "42.8",
            "tot_bott": "2500",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "25",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "35"
        },
        {
            "code": "SCMCL0013679",
            "name": "THREE X-Sangali .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "20",
            "auto_batch": "BTC32-210425\/20",
            "mfg_month": "Apr-2025",
            "bl": "43.2",
            "vv": "42.8",
            "tot_bott": "240",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "70"
        },
        {
            "code": "SCMCL0013681",
            "name": "THREE X-Sangali .",
            "size": "750 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "250",
            "auto_batch": "BTC32-310325\/250",
            "mfg_month": "Mar-2025",
            "bl": "18",
            "vv": "42.8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "290"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "7680.00",
    "tamt": "7680.00"
}
[2025-10-16 06:26:57] GET data: []
[2025-10-16 06:26:57] Company ID from session: 1
[2025-10-16 06:26:57] Database connection included
[2025-10-16 06:26:57] License functions included
[2025-10-16 06:26:57] License type: FL-II
[2025-10-16 06:26:57] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-16 06:26:57] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-16 06:26:57] Purchase mode: F
[2025-10-16 06:26:57] Next voucher number: 10
[2025-10-16 06:26:57] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-16 06:26:57] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-16 06:26:57] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-16 06:26:57] Suppliers fetched: {
    "count": 36
}
[2025-10-16 06:26:57] === FORM SUBMISSION STARTED ===
[2025-10-16 06:26:57] Form data extracted: {
    "date": "2025-05-15",
    "voc_no": "10",
    "auto_tp_no": "CL2296-150525\/574",
    "tp_no": "574",
    "tp_date": "2025-05-15",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "7680.00",
    "total_amt": "7680.00"
}
[2025-10-16 06:26:57] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-05-15",
        "RAJ",
        "CL2296-150525\/574",
        "10",
        "",
        "",
        "7680.00",
        "574",
        "2025-05-15",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-16 06:26:57] Purchase header inserted successfully: {
    "purchase_id": 11,
    "affected_rows": 1
}
[2025-10-16 06:26:57] Starting to process purchase items: {
    "item_count": 7
}
[2025-10-16 06:26:57] Processing item 0: {
    "item_code": "SCMCL0012761",
    "item_name": "DESHI DARU TANGO PUNCH-NV .",
    "cases": 20,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 2400,
    "tot_bott": 2000,
    "bl": 180
}
[2025-10-16 06:26:57] Item 0 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMCL0012761"
}
[2025-10-16 06:26:57] Checking if month is archived: {
    "company_id": 1,
    "month": "5",
    "year": "2025",
    "archive_table": "tbldailystock_1_05_25"
}
[2025-10-16 06:26:57] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_05_25'"
}
[2025-10-16 06:26:57] Processing item 1: {
    "item_code": "SCMCL0012763",
    "item_name": "DESHI DARU TANGO PUNCH-NV .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 240,
    "bl": 43.2
}
[2025-10-16 06:26:57] Item 1 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMCL0012763"
}
[2025-10-16 06:26:57] Checking if month is archived: {
    "company_id": 1,
    "month": "5",
    "year": "2025",
    "archive_table": "tbldailystock_1_05_25"
}
[2025-10-16 06:26:57] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_05_25'"
}
[2025-10-16 06:26:57] Processing item 2: {
    "item_code": "SCMCL0012765",
    "item_name": "DESHI DARU TANGO PUNCH-NV .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-10-16 06:26:57] Item 2 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMCL0012765"
}
[2025-10-16 06:26:57] Checking if month is archived: {
    "company_id": 1,
    "month": "5",
    "year": "2025",
    "archive_table": "tbldailystock_1_05_25"
}
[2025-10-16 06:26:57] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_05_25'"
}
[2025-10-16 06:26:57] Processing item 3: {
    "item_code": "SCMCL0013629",
    "item_name": "ICAP SANTRA .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 500,
    "bl": 45
}
[2025-10-16 06:26:57] Item 3 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMCL0013629"
}
[2025-10-16 06:26:57] Checking if month is archived: {
    "company_id": 1,
    "month": "5",
    "year": "2025",
    "archive_table": "tbldailystock_1_05_25"
}
[2025-10-16 06:26:57] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_05_25'"
}
[2025-10-16 06:26:57] Processing item 4: {
    "item_code": "SCMCL0013677",
    "item_name": "THREE X-Sangali .",
    "cases": 25,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3000,
    "tot_bott": 2500,
    "bl": 225
}
[2025-10-16 06:26:57] Item 4 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMCL0013677"
}
[2025-10-16 06:26:57] Checking if month is archived: {
    "company_id": 1,
    "month": "5",
    "year": "2025",
    "archive_table": "tbldailystock_1_05_25"
}
[2025-10-16 06:26:57] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_05_25'"
}
[2025-10-16 06:26:57] Processing item 5: {
    "item_code": "SCMCL0013679",
    "item_name": "THREE X-Sangali .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 240,
    "bl": 43.2
}
[2025-10-16 06:26:57] Item 5 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMCL0013679"
}
[2025-10-16 06:26:57] Checking if month is archived: {
    "company_id": 1,
    "month": "5",
    "year": "2025",
    "archive_table": "tbldailystock_1_05_25"
}
[2025-10-16 06:26:57] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_05_25'"
}
[2025-10-16 06:26:57] Processing item 6: {
    "item_code": "SCMCL0013681",
    "item_name": "THREE X-Sangali .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-10-16 06:26:57] Item 6 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMCL0013681"
}
[2025-10-16 06:26:57] Checking if month is archived: {
    "company_id": 1,
    "month": "5",
    "year": "2025",
    "archive_table": "tbldailystock_1_05_25"
}
[2025-10-16 06:26:57] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_05_25'"
}
[2025-10-16 06:26:57] Purchase items processing completed: {
    "successful_items": 7,
    "total_items": 7
}
[2025-10-16 06:26:57] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-16 06:42:46] === NEW PURCHASE SESSION STARTED ===
[2025-10-16 06:42:46] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-16 06:42:46] POST data: []
[2025-10-16 06:42:46] GET data: []
[2025-10-16 06:42:46] Company ID from session: 1
[2025-10-16 06:42:46] Database connection included
[2025-10-16 06:42:46] License functions included
[2025-10-16 06:42:46] License type: FL-II
[2025-10-16 06:42:46] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-16 06:42:46] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-16 06:42:46] Purchase mode: F
[2025-10-16 06:42:46] Next voucher number: 11
[2025-10-16 06:42:46] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-16 06:42:46] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-16 06:42:46] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-16 06:42:46] Suppliers fetched: {
    "count": 36
}
[2025-10-16 06:42:46] Database connection closed
[2025-10-16 06:42:46] === PURCHASE SESSION ENDED ===
[2025-10-16 07:04:33] === NEW PURCHASE SESSION STARTED ===
[2025-10-16 07:04:33] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-16 07:04:33] POST data: []
[2025-10-16 07:04:33] GET data: []
[2025-10-16 07:04:33] Company ID from session: 1
[2025-10-16 07:04:33] Database connection included
[2025-10-16 07:04:33] License functions included
[2025-10-16 07:04:33] License type: FL-II
[2025-10-16 07:04:33] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-16 07:04:33] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-16 07:04:33] Purchase mode: F
[2025-10-16 07:04:33] Next voucher number: 11
[2025-10-16 07:04:33] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-16 07:04:33] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-16 07:04:33] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-16 07:04:33] Suppliers fetched: {
    "count": 36
}
[2025-10-16 07:04:33] Database connection closed
[2025-10-16 07:04:33] === PURCHASE SESSION ENDED ===
[2025-10-16 07:05:23] === NEW PURCHASE SESSION STARTED ===
[2025-10-16 07:05:23] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-16 07:05:23] POST data: []
[2025-10-16 07:05:23] GET data: []
[2025-10-16 07:05:23] Company ID from session: 1
[2025-10-16 07:05:23] Database connection included
[2025-10-16 07:05:23] License functions included
[2025-10-16 07:05:23] License type: FL-II
[2025-10-16 07:05:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-16 07:05:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-16 07:05:23] Purchase mode: F
[2025-10-16 07:05:23] Next voucher number: 11
[2025-10-16 07:05:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-16 07:05:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-16 07:05:23] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-16 07:05:23] Suppliers fetched: {
    "count": 36
}
[2025-10-17 06:15:45] === NEW PURCHASE SESSION STARTED ===
[2025-10-17 06:15:45] Session data: {
    "user_id": "2",
    "username": "Digvijay",
    "CompID": 2,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Digvijay"
}
[2025-10-17 06:15:45] POST data: []
[2025-10-17 06:15:45] GET data: []
[2025-10-17 06:15:45] Company ID from session: 2
[2025-10-17 06:15:45] Database connection included
[2025-10-17 06:15:45] License functions included
[2025-10-17 06:15:45] License type: FLBR-II
[2025-10-17 06:15:45] Available classes: [
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-17 06:15:45] Allowed class SGROUP values: [
    "V",
    "F",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-17 06:15:45] Purchase mode: F
[2025-10-17 06:15:45] Next voucher number: 1
[2025-10-17 06:15:45] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-17 06:15:45] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "V",
        "F",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssss"
}
[2025-10-17 06:15:45] Items fetched from database: {
    "count": 821,
    "license_filter_applied": true
}
[2025-10-17 06:15:45] Suppliers fetched: {
    "count": 36
}
[2025-10-17 06:15:45] Database connection closed
[2025-10-17 06:15:45] === PURCHASE SESSION ENDED ===
[2025-10-20 09:36:22] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 09:36:22] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760944709
}
[2025-10-20 09:36:22] POST data: []
[2025-10-20 09:36:22] GET data: {
    "mode": "F"
}
[2025-10-20 09:36:22] Company ID from session: 1
[2025-10-20 09:36:22] Database connection included
[2025-10-20 09:36:22] License functions included
[2025-10-20 09:36:22] License type: FL-II
[2025-10-20 09:36:22] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 09:36:22] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 09:36:22] Purchase mode: F
[2025-10-20 09:36:22] Next voucher number: 11
[2025-10-20 09:36:22] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 09:36:22] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 09:36:22] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 09:36:22] Suppliers fetched: {
    "count": 36
}
[2025-10-20 09:36:22] Database connection closed
[2025-10-20 09:36:22] === PURCHASE SESSION ENDED ===
[2025-10-20 09:38:18] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 09:38:18] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760944709
}
[2025-10-20 09:38:18] POST data: {
    "mode": "F",
    "voc_no": "11",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMIT0020165",
            "name": "ABSOLUTE VODKA .",
            "size": "200 ML (24)",
            "bottles_per_case": "24",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "4.80",
            "vv": "0",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "100.00",
    "tamt": "100.00"
}
[2025-10-20 09:38:18] GET data: {
    "mode": "F"
}
[2025-10-20 09:38:18] Company ID from session: 1
[2025-10-20 09:38:18] Database connection included
[2025-10-20 09:38:18] License functions included
[2025-10-20 09:38:18] License type: FL-II
[2025-10-20 09:38:18] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 09:38:18] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 09:38:18] Purchase mode: F
[2025-10-20 09:38:18] Next voucher number: 11
[2025-10-20 09:38:18] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 09:38:18] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 09:38:18] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 09:38:18] Suppliers fetched: {
    "count": 36
}
[2025-10-20 09:38:18] === FORM SUBMISSION STARTED ===
[2025-10-20 09:38:18] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "11",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "100.00",
    "total_amt": "100.00"
}
[2025-10-20 09:38:18] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "",
        "FL1305-310825\/7654",
        "11",
        "",
        "",
        "100.00",
        "7654",
        "",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 09:38:18] Purchase header inserted successfully: {
    "purchase_id": 12,
    "affected_rows": 1
}
[2025-10-20 09:38:18] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 09:38:18] Processing item 0: {
    "item_code": "SCMIT0020165",
    "item_name": "ABSOLUTE VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 4.8
}
[2025-10-20 09:38:18] Item 0 inserted successfully: {
    "purchase_id": 12,
    "item_code": "SCMIT0020165"
}
[2025-10-20 09:38:18] Checking if month is archived: {
    "company_id": 1,
    "month": "10",
    "year": "2025",
    "archive_table": "tbldailystock_1_10_25"
}
[2025-10-20 09:38:18] Month archive check result: {
    "table_exists": false,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_10_25'"
}
[2025-10-20 09:38:18] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 09:38:18] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 09:38:26] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 09:38:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760944709
}
[2025-10-20 09:38:26] POST data: []
[2025-10-20 09:38:26] GET data: {
    "mode": "F"
}
[2025-10-20 09:38:26] Company ID from session: 1
[2025-10-20 09:38:26] Database connection included
[2025-10-20 09:38:26] License functions included
[2025-10-20 09:38:26] License type: FL-II
[2025-10-20 09:38:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 09:38:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 09:38:26] Purchase mode: F
[2025-10-20 09:38:26] Next voucher number: 12
[2025-10-20 09:38:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 09:38:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 09:38:26] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 09:38:26] Suppliers fetched: {
    "count": 36
}
[2025-10-20 09:38:26] Database connection closed
[2025-10-20 09:38:26] === PURCHASE SESSION ENDED ===
[2025-10-20 09:51:11] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 09:51:11] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760946332,
    "sale_quantities": []
}
[2025-10-20 09:51:11] POST data: []
[2025-10-20 09:51:11] GET data: []
[2025-10-20 09:51:11] Company ID from session: 1
[2025-10-20 09:51:11] Database connection included
[2025-10-20 09:51:11] License functions included
[2025-10-20 09:51:11] License type: FL-II
[2025-10-20 09:51:11] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 09:51:11] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 09:51:11] Purchase mode: F
[2025-10-20 09:51:11] Next voucher number: 12
[2025-10-20 09:51:11] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 09:51:11] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 09:51:11] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 09:51:11] Suppliers fetched: {
    "count": 36
}
[2025-10-20 09:51:11] Database connection closed
[2025-10-20 09:51:11] === PURCHASE SESSION ENDED ===
[2025-10-20 09:53:55] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 09:53:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760946332,
    "sale_quantities": []
}
[2025-10-20 09:53:55] POST data: {
    "mode": "F",
    "voc_no": "12",
    "date": "2025-10-17",
    "auto_tp_no": "FL170-280825\/15670",
    "tp_no": "15670",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": {
        "4": {
            "code": "SCMLS0030593",
            "name": "ABSOLUT VODKA RASPBERRI .",
            "size": "200 ML (24)",
            "bottles_per_case": "24",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "4.80",
            "vv": "0",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    },
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "120.00",
    "tamt": "120.00"
}
[2025-10-20 09:53:55] GET data: []
[2025-10-20 09:53:55] Company ID from session: 1
[2025-10-20 09:53:55] Database connection included
[2025-10-20 09:53:55] License functions included
[2025-10-20 09:53:55] License type: FL-II
[2025-10-20 09:53:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 09:53:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 09:53:55] Purchase mode: F
[2025-10-20 09:53:55] Next voucher number: 12
[2025-10-20 09:53:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 09:53:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 09:53:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 09:53:55] Suppliers fetched: {
    "count": 36
}
[2025-10-20 09:53:55] === FORM SUBMISSION STARTED ===
[2025-10-20 09:53:55] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "12",
    "auto_tp_no": "FL170-280825\/15670",
    "tp_no": "15670",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "120.00",
    "total_amt": "120.00"
}
[2025-10-20 09:53:55] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "AMAR",
        "FL170-280825\/15670",
        "12",
        "",
        "",
        "120.00",
        "15670",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 09:53:55] Purchase header inserted successfully: {
    "purchase_id": 13,
    "affected_rows": 1
}
[2025-10-20 09:53:55] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 09:53:55] Processing item 4: {
    "item_code": "SCMLS0030593",
    "item_name": "ABSOLUT VODKA RASPBERRI .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 4.8
}
[2025-10-20 09:53:55] Item 4 inserted successfully: {
    "purchase_id": 13,
    "item_code": "SCMLS0030593"
}
[2025-10-20 09:53:55] Checking if month is archived: {
    "company_id": 1,
    "month": "10",
    "year": "2025",
    "archive_table": "tbldailystock_1_10_25"
}
[2025-10-20 09:53:55] Month archive check result: {
    "table_exists": false,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_10_25'"
}
[2025-10-20 09:53:55] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 09:53:55] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 10:08:09] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 10:08:09] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760947607
}
[2025-10-20 10:08:09] POST data: []
[2025-10-20 10:08:09] GET data: []
[2025-10-20 10:08:09] Company ID from session: 1
[2025-10-20 10:08:09] Database connection included
[2025-10-20 10:08:09] License functions included
[2025-10-20 10:08:09] License type: FL-II
[2025-10-20 10:08:09] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 10:08:09] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 10:08:09] Purchase mode: F
[2025-10-20 10:08:09] Next voucher number: 13
[2025-10-20 10:08:09] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 10:08:09] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 10:08:09] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 10:08:09] Suppliers fetched: {
    "count": 36
}
[2025-10-20 10:08:09] Database connection closed
[2025-10-20 10:08:09] === PURCHASE SESSION ENDED ===
[2025-10-20 10:10:00] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 10:10:00] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760947607
}
[2025-10-20 10:10:00] POST data: {
    "mode": "F",
    "voc_no": "13",
    "date": "2025-10-18",
    "auto_tp_no": "FL1305-180725\/5746",
    "tp_no": "5746",
    "tp_date": "2025-10-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "MILLENINUM SPIRITS",
    "supplier_code": "MILL",
    "items": [
        {
            "code": "SCMPL0009679",
            "name": "Bacardi Black Rum .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "9.00",
            "vv": "0",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "100.00",
    "tamt": "100.00"
}
[2025-10-20 10:10:00] GET data: []
[2025-10-20 10:10:00] Company ID from session: 1
[2025-10-20 10:10:00] Database connection included
[2025-10-20 10:10:00] License functions included
[2025-10-20 10:10:00] License type: FL-II
[2025-10-20 10:10:00] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 10:10:00] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 10:10:00] Purchase mode: F
[2025-10-20 10:10:00] Next voucher number: 13
[2025-10-20 10:10:00] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 10:10:00] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 10:10:00] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 10:10:00] Suppliers fetched: {
    "count": 36
}
[2025-10-20 10:10:00] === FORM SUBMISSION STARTED ===
[2025-10-20 10:10:00] Form data extracted: {
    "date": "2025-10-18",
    "voc_no": "13",
    "auto_tp_no": "FL1305-180725\/5746",
    "tp_no": "5746",
    "tp_date": "2025-10-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "MILL",
    "supplier_name": "MILLENINUM SPIRITS",
    "basic_amt": "100.00",
    "total_amt": "100.00"
}
[2025-10-20 10:10:00] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-18",
        "MILL",
        "FL1305-180725\/5746",
        "13",
        "",
        "",
        "100.00",
        "5746",
        "2025-10-18",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 10:10:00] Purchase header inserted successfully: {
    "purchase_id": 14,
    "affected_rows": 1
}
[2025-10-20 10:10:00] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 10:10:00] Processing item 0: {
    "item_code": "SCMPL0009679",
    "item_name": "Bacardi Black Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-20 10:10:00] Item 0 inserted successfully: {
    "purchase_id": 14,
    "item_code": "SCMPL0009679"
}
[2025-10-20 10:10:00] Checking if month is archived: {
    "company_id": 1,
    "month": "10",
    "year": "2025",
    "archive_table": "tbldailystock_1_10_25"
}
[2025-10-20 10:10:00] Month archive check result: {
    "table_exists": false,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_10_25'"
}
[2025-10-20 10:10:00] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 10:10:00] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 10:42:04] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 10:42:04] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 10:42:04] POST data: []
[2025-10-20 10:42:04] GET data: []
[2025-10-20 10:42:04] Company ID from session: 1
[2025-10-20 10:42:04] Database connection included
[2025-10-20 10:42:04] License functions included
[2025-10-20 10:42:04] License type: FL-II
[2025-10-20 10:42:04] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 10:42:04] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 10:42:04] Purchase mode: F
[2025-10-20 10:42:04] Next voucher number: 1
[2025-10-20 10:42:04] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 10:42:04] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 10:42:04] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 10:42:04] Suppliers fetched: {
    "count": 36
}
[2025-10-20 10:42:04] Database connection closed
[2025-10-20 10:42:04] === PURCHASE SESSION ENDED ===
[2025-10-20 10:56:59] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 10:56:59] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 10:56:59] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "supplier_code": "ABHI",
    "items": [
        {
            "code": "SCMPL0019030",
            "name": "20-20 Fine Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "7.50",
            "vv": "0",
            "tot_bott": "10",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "10",
            "case_rate": "800.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "8000.00",
    "tamt": "8000.00"
}
[2025-10-20 10:56:59] GET data: []
[2025-10-20 10:56:59] Company ID from session: 1
[2025-10-20 10:56:59] Database connection included
[2025-10-20 10:56:59] License functions included
[2025-10-20 10:57:00] License type: FL-II
[2025-10-20 10:57:00] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 10:57:00] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 10:57:00] Purchase mode: F
[2025-10-20 10:57:00] Next voucher number: 1
[2025-10-20 10:57:00] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 10:57:00] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 10:57:00] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 10:57:00] Suppliers fetched: {
    "count": 36
}
[2025-10-20 10:57:00] === FORM SUBMISSION STARTED ===
[2025-10-20 10:57:00] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ABHI",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "basic_amt": "8000.00",
    "total_amt": "8000.00"
}
[2025-10-20 10:57:00] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "ABHI",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "8000.00",
        "7654",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 10:57:00] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-10-20 10:57:00] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 10:57:00] Processing item 0: {
    "item_code": "SCMPL0019030",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 10,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 8000,
    "tot_bott": 10,
    "bl": 7.5
}
[2025-10-20 10:57:00] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0019030"
}
[2025-10-20 10:57:00] Checking if month is archived: {
    "company_id": 1,
    "month": "10",
    "year": "2025",
    "archive_table": "tbldailystock_1_10_25"
}
[2025-10-20 10:57:00] Month archive check result: {
    "table_exists": false,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_10_25'"
}
[2025-10-20 10:57:00] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 10:57:00] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 11:16:32] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 11:16:32] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 11:16:32] POST data: []
[2025-10-20 11:16:32] GET data: {
    "mode": "F"
}
[2025-10-20 11:16:32] Company ID from session: 1
[2025-10-20 11:16:32] Database connection included
[2025-10-20 11:16:32] License functions included
[2025-10-20 11:16:32] License type: FL-II
[2025-10-20 11:16:32] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 11:16:32] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 11:16:32] Purchase mode: F
[2025-10-20 11:16:32] Next voucher number: 1
[2025-10-20 11:16:32] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 11:16:32] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 11:16:32] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 11:16:32] Suppliers fetched: {
    "count": 36
}
[2025-10-20 11:16:32] Database connection closed
[2025-10-20 11:16:32] === PURCHASE SESSION ENDED ===
[2025-10-20 11:35:46] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 11:35:46] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 11:35:46] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "supplier_code": "ABHI",
    "items": [
        {
            "code": "SCMPL0019030",
            "name": "20-20 Fine Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "7.50",
            "vv": "0",
            "tot_bott": "10",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "",
            "bottles": "10",
            "case_rate": "800.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "8000.00",
    "tamt": "8000.00"
}
[2025-10-20 11:35:46] GET data: {
    "mode": "F"
}
[2025-10-20 11:35:46] Company ID from session: 1
[2025-10-20 11:35:46] Database connection included
[2025-10-20 11:35:46] License functions included
[2025-10-20 11:35:46] License type: FL-II
[2025-10-20 11:35:46] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 11:35:46] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 11:35:46] Purchase mode: F
[2025-10-20 11:35:46] Next voucher number: 1
[2025-10-20 11:35:46] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 11:35:46] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 11:35:46] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 11:35:46] Suppliers fetched: {
    "count": 36
}
[2025-10-20 11:35:46] === FORM SUBMISSION STARTED ===
[2025-10-20 11:35:46] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ABHI",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "basic_amt": "8000.00",
    "total_amt": "8000.00"
}
[2025-10-20 11:35:46] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "ABHI",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "8000.00",
        "7654",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 11:35:46] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-10-20 11:35:46] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 11:35:46] Processing item 0: {
    "item_code": "SCMPL0019030",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 10,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 8000,
    "tot_bott": 10,
    "bl": 7.5
}
[2025-10-20 11:35:46] Item 0 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0019030"
}
[2025-10-20 13:30:28] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 13:30:28] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 13:30:28] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "supplier_code": "ABHI",
    "items": [
        {
            "code": "SCMPL0019030",
            "name": "20-20 Fine Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "7.50",
            "vv": "0",
            "tot_bott": "10",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "",
            "bottles": "10",
            "case_rate": "800.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "8000.00",
    "tamt": "8000.00"
}
[2025-10-20 13:30:28] GET data: {
    "mode": "F"
}
[2025-10-20 13:30:28] Company ID from session: 1
[2025-10-20 13:30:52] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 13:30:52] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 13:30:52] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "supplier_code": "ABHI",
    "items": [
        {
            "code": "SCMPL0019030",
            "name": "20-20 Fine Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "7.50",
            "vv": "0",
            "tot_bott": "10",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "",
            "bottles": "10",
            "case_rate": "800.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "8000.00",
    "tamt": "8000.00"
}
[2025-10-20 13:30:52] GET data: {
    "mode": "F"
}
[2025-10-20 13:30:52] Company ID from session: 1
[2025-10-20 13:30:52] Database connection included
[2025-10-20 13:30:52] License functions included
[2025-10-20 13:30:52] License type: FL-II
[2025-10-20 13:30:52] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 13:30:52] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 13:30:52] Purchase mode: F
[2025-10-20 13:30:52] Next voucher number: 2
[2025-10-20 13:30:52] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 13:30:52] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 13:30:52] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 13:30:52] Suppliers fetched: {
    "count": 36
}
[2025-10-20 13:30:52] === FORM SUBMISSION STARTED ===
[2025-10-20 13:30:52] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ABHI",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "basic_amt": "8000.00",
    "total_amt": "8000.00"
}
[2025-10-20 13:30:52] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "ABHI",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "8000.00",
        "7654",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 13:30:52] Purchase header inserted successfully: {
    "purchase_id": 3,
    "affected_rows": 1
}
[2025-10-20 13:30:52] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 13:30:52] Processing item 0: {
    "item_code": "SCMPL0019030",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 10,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 8000,
    "tot_bott": 10,
    "bl": 7.5
}
[2025-10-20 13:30:52] Item 0 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMPL0019030"
}
[2025-10-20 13:30:53] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 13:30:53] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 13:45:20] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 13:45:20] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 13:45:20] POST data: []
[2025-10-20 13:45:20] GET data: {
    "mode": "F"
}
[2025-10-20 13:45:20] Company ID from session: 1
[2025-10-20 13:45:20] Database connection included
[2025-10-20 13:45:20] License functions included
[2025-10-20 13:45:20] License type: FL-II
[2025-10-20 13:45:20] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 13:45:20] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 13:45:20] Purchase mode: F
[2025-10-20 13:45:20] Next voucher number: 1
[2025-10-20 13:45:20] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 13:45:20] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 13:45:20] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 13:45:20] Suppliers fetched: {
    "count": 36
}
[2025-10-20 13:45:20] Database connection closed
[2025-10-20 13:45:20] === PURCHASE SESSION ENDED ===
[2025-10-20 13:45:59] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 13:45:59] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 13:45:59] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ASIAN TRADERS",
    "supplier_code": "ASIA",
    "items": [
        {
            "code": "SCMPL0019030",
            "name": "20-20 Fine Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.75",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-10-20 13:45:59] GET data: {
    "mode": "F"
}
[2025-10-20 13:45:59] Company ID from session: 1
[2025-10-20 13:45:59] Database connection included
[2025-10-20 13:45:59] License functions included
[2025-10-20 13:45:59] License type: FL-II
[2025-10-20 13:45:59] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 13:45:59] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 13:45:59] Purchase mode: F
[2025-10-20 13:45:59] Next voucher number: 1
[2025-10-20 13:45:59] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 13:45:59] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 13:45:59] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 13:45:59] Suppliers fetched: {
    "count": 36
}
[2025-10-20 13:45:59] === FORM SUBMISSION STARTED ===
[2025-10-20 13:45:59] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ASIA",
    "supplier_name": "ASIAN TRADERS",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-10-20 13:45:59] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "ASIA",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "800.00",
        "7654",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 13:45:59] Purchase header inserted successfully: {
    "purchase_id": 4,
    "affected_rows": 1
}
[2025-10-20 13:45:59] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 13:45:59] Processing item 0: {
    "item_code": "SCMPL0019030",
    "item_name": "20-20 Fine Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 1,
    "bl": 0.75
}
[2025-10-20 13:45:59] Item 0 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0019030"
}
[2025-10-20 13:45:59] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 13:45:59] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 13:47:45] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 13:47:45] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 13:47:45] POST data: []
[2025-10-20 13:47:45] GET data: {
    "mode": "F"
}
[2025-10-20 13:47:45] Company ID from session: 1
[2025-10-20 13:47:45] Database connection included
[2025-10-20 13:47:45] License functions included
[2025-10-20 13:47:45] License type: FL-II
[2025-10-20 13:47:45] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 13:47:45] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 13:47:45] Purchase mode: F
[2025-10-20 13:47:45] Next voucher number: 1
[2025-10-20 13:47:45] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 13:47:45] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 13:47:45] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 13:47:45] Suppliers fetched: {
    "count": 36
}
[2025-10-20 13:47:45] Database connection closed
[2025-10-20 13:47:45] === PURCHASE SESSION ENDED ===
[2025-10-20 13:48:41] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 13:48:41] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 13:48:41] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ANKUSH TRADERS",
    "supplier_code": "ANKU",
    "items": [
        {
            "code": "SCMPL0019029",
            "name": "20-20 Fine Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.90",
            "vv": "0",
            "tot_bott": "5",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "5",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "600.00",
    "tamt": "600.00"
}
[2025-10-20 13:48:41] GET data: {
    "mode": "F"
}
[2025-10-20 13:48:41] Company ID from session: 1
[2025-10-20 13:48:41] Database connection included
[2025-10-20 13:48:41] License functions included
[2025-10-20 13:48:41] License type: FL-II
[2025-10-20 13:48:41] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 13:48:41] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 13:48:41] Purchase mode: F
[2025-10-20 13:48:41] Next voucher number: 1
[2025-10-20 13:48:41] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 13:48:41] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 13:48:42] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 13:48:42] Suppliers fetched: {
    "count": 36
}
[2025-10-20 13:48:42] === FORM SUBMISSION STARTED ===
[2025-10-20 13:48:42] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ANKU",
    "supplier_name": "ANKUSH TRADERS",
    "basic_amt": "600.00",
    "total_amt": "600.00"
}
[2025-10-20 13:48:42] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "ANKU",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "600.00",
        "7654",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 13:48:42] Purchase header inserted successfully: {
    "purchase_id": 5,
    "affected_rows": 1
}
[2025-10-20 13:48:42] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 13:48:42] Processing item 0: {
    "item_code": "SCMPL0019029",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 5,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 5,
    "bl": 0.9
}
[2025-10-20 13:48:42] Item 0 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMPL0019029"
}
[2025-10-20 13:48:42] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 13:48:42] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 14:07:15] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 14:07:15] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760961153
}
[2025-10-20 14:07:15] POST data: []
[2025-10-20 14:07:15] GET data: []
[2025-10-20 14:07:15] Company ID from session: 1
[2025-10-20 14:07:15] Database connection included
[2025-10-20 14:07:15] License functions included
[2025-10-20 14:07:15] License type: FL-II
[2025-10-20 14:07:15] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 14:07:15] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 14:07:15] Purchase mode: F
[2025-10-20 14:07:15] Next voucher number: 2
[2025-10-20 14:07:15] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 14:07:15] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 14:07:15] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 14:07:15] Suppliers fetched: {
    "count": 36
}
[2025-10-20 14:07:15] Database connection closed
[2025-10-20 14:07:15] === PURCHASE SESSION ENDED ===
[2025-10-20 14:08:38] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 14:08:38] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760961153
}
[2025-10-20 14:08:38] POST data: []
[2025-10-20 14:08:38] GET data: []
[2025-10-20 14:08:38] Company ID from session: 1
[2025-10-20 14:08:38] Database connection included
[2025-10-20 14:08:38] License functions included
[2025-10-20 14:08:38] License type: FL-II
[2025-10-20 14:08:38] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 14:08:38] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 14:08:38] Purchase mode: F
[2025-10-20 14:08:38] Next voucher number: 1
[2025-10-20 14:08:38] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 14:08:38] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 14:08:38] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 14:08:38] Suppliers fetched: {
    "count": 36
}
[2025-10-20 14:08:38] Database connection closed
[2025-10-20 14:08:38] === PURCHASE SESSION ENDED ===
[2025-10-20 14:09:18] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 14:09:18] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760961153
}
[2025-10-20 14:09:18] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ANKUSH TRADERS",
    "supplier_code": "ANKU",
    "items": [
        {
            "code": "SCMPL0019029",
            "name": "20-20 Fine Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.90",
            "vv": "0",
            "tot_bott": "5",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "600.00",
    "tamt": "600.00"
}
[2025-10-20 14:09:18] GET data: []
[2025-10-20 14:09:18] Company ID from session: 1
[2025-10-20 14:09:18] Database connection included
[2025-10-20 14:09:18] License functions included
[2025-10-20 14:09:18] License type: FL-II
[2025-10-20 14:09:18] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 14:09:18] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 14:09:18] Purchase mode: F
[2025-10-20 14:09:18] Next voucher number: 1
[2025-10-20 14:09:18] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 14:09:18] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 14:09:18] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 14:09:18] Suppliers fetched: {
    "count": 36
}
[2025-10-20 14:09:18] === FORM SUBMISSION STARTED ===
[2025-10-20 14:09:18] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ANKU",
    "supplier_name": "ANKUSH TRADERS",
    "basic_amt": "600.00",
    "total_amt": "600.00"
}
[2025-10-20 14:09:18] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "ANKU",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "600.00",
        "7654",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 14:09:18] Purchase header inserted successfully: {
    "purchase_id": 6,
    "affected_rows": 1
}
[2025-10-20 14:09:18] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 14:09:18] Processing item 0: {
    "item_code": "SCMPL0019029",
    "item_name": "20-20 Fine Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 5,
    "bl": 0.9
}
[2025-10-20 14:09:18] Item 0 inserted successfully: {
    "purchase_id": 6,
    "item_code": "SCMPL0019029"
}
[2025-10-20 14:09:18] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 14:09:18] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 14:12:04] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 14:12:04] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760961153
}
[2025-10-20 14:12:04] POST data: []
[2025-10-20 14:12:04] GET data: {
    "mode": "F"
}
[2025-10-20 14:12:04] Company ID from session: 1
[2025-10-20 14:12:04] Database connection included
[2025-10-20 14:12:04] License functions included
[2025-10-20 14:12:04] License type: FL-II
[2025-10-20 14:12:04] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 14:12:04] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 14:12:04] Purchase mode: F
[2025-10-20 14:12:04] Next voucher number: 1
[2025-10-20 14:12:04] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 14:12:04] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 14:12:04] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 14:12:04] Suppliers fetched: {
    "count": 36
}
[2025-10-20 14:12:04] Database connection closed
[2025-10-20 14:12:04] === PURCHASE SESSION ENDED ===
[2025-10-20 14:13:07] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 14:13:07] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760961153
}
[2025-10-20 14:13:07] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": {
        "1": {
            "code": "SCMPL0019029",
            "name": "20-20 Fine Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.90",
            "vv": "0",
            "tot_bott": "5",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "5",
            "case_rate": "120.000",
            "mrp": "0"
        }
    },
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "600.00",
    "tamt": "600.00"
}
[2025-10-20 14:13:07] GET data: {
    "mode": "F"
}
[2025-10-20 14:13:07] Company ID from session: 1
[2025-10-20 14:13:07] Database connection included
[2025-10-20 14:13:07] License functions included
[2025-10-20 14:13:07] License type: FL-II
[2025-10-20 14:13:07] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 14:13:07] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 14:13:07] Purchase mode: F
[2025-10-20 14:13:07] Next voucher number: 1
[2025-10-20 14:13:07] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 14:13:07] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 14:13:07] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 14:13:07] Suppliers fetched: {
    "count": 36
}
[2025-10-20 14:13:07] === FORM SUBMISSION STARTED ===
[2025-10-20 14:13:07] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "600.00",
    "total_amt": "600.00"
}
[2025-10-20 14:13:07] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "HARE",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "600.00",
        "7654",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 14:13:07] Purchase header inserted successfully: {
    "purchase_id": 7,
    "affected_rows": 1
}
[2025-10-20 14:13:07] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 14:13:07] Processing item 1: {
    "item_code": "SCMPL0019029",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 5,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 5,
    "bl": 0.9
}
[2025-10-20 14:13:07] Item 1 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0019029"
}
[2025-10-20 14:13:07] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 14:13:07] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 14:16:05] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 14:16:05] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760962458
}
[2025-10-20 14:16:05] POST data: []
[2025-10-20 14:16:05] GET data: {
    "mode": "F"
}
[2025-10-20 14:16:05] Company ID from session: 1
[2025-10-20 14:16:05] Database connection included
[2025-10-20 14:16:05] License functions included
[2025-10-20 14:16:05] License type: FL-II
[2025-10-20 14:16:05] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 14:16:05] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 14:16:05] Purchase mode: F
[2025-10-20 14:16:05] Next voucher number: 1
[2025-10-20 14:16:05] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 14:16:05] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 14:16:05] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 14:16:05] Suppliers fetched: {
    "count": 36
}
[2025-10-20 14:16:05] Database connection closed
[2025-10-20 14:16:05] === PURCHASE SESSION ENDED ===
[2025-10-20 14:16:55] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 14:16:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "stock_columns_checked": true,
    "last_submission": 1760962458
}
[2025-10-20 14:16:55] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-18",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMPL0019029",
            "name": "20-20 Fine Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.90",
            "vv": "0",
            "tot_bott": "5",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "05",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "600.00",
    "tamt": "600.00"
}
[2025-10-20 14:16:55] GET data: {
    "mode": "F"
}
[2025-10-20 14:16:55] Company ID from session: 1
[2025-10-20 14:16:55] Database connection included
[2025-10-20 14:16:55] License functions included
[2025-10-20 14:16:55] License type: FL-II
[2025-10-20 14:16:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 14:16:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 14:16:55] Purchase mode: F
[2025-10-20 14:16:55] Next voucher number: 1
[2025-10-20 14:16:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 14:16:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 14:16:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 14:16:55] Suppliers fetched: {
    "count": 36
}
[2025-10-20 14:16:55] === FORM SUBMISSION STARTED ===
[2025-10-20 14:16:55] Form data extracted: {
    "date": "2025-10-18",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "600.00",
    "total_amt": "600.00"
}
[2025-10-20 14:16:55] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-18",
        "",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "600.00",
        "7654",
        "2025-10-18",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 14:16:55] Purchase header inserted successfully: {
    "purchase_id": 8,
    "affected_rows": 1
}
[2025-10-20 14:16:55] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-20 14:16:55] Processing item 0: {
    "item_code": "SCMPL0019029",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 5,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 5,
    "bl": 0.9
}
[2025-10-20 14:16:55] Item 0 inserted successfully: {
    "purchase_id": 8,
    "item_code": "SCMPL0019029"
}
[2025-10-20 14:16:55] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-20 14:16:55] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 15:45:23] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 15:45:23] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 15:45:23] POST data: []
[2025-10-20 15:45:23] GET data: {
    "mode": "F"
}
[2025-10-20 15:45:23] Company ID from session: 1
[2025-10-20 15:45:23] Database connection included
[2025-10-20 15:45:23] License functions included
[2025-10-20 15:45:23] License type: FL-II
[2025-10-20 15:45:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 15:45:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 15:45:23] Purchase mode: F
[2025-10-20 15:45:23] Next voucher number: 1
[2025-10-20 15:45:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 15:45:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 15:45:23] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 15:45:23] Suppliers fetched: {
    "count": 36
}
[2025-10-20 15:45:23] Database connection closed
[2025-10-20 15:45:23] === PURCHASE SESSION ENDED ===
[2025-10-20 15:45:59] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 15:45:59] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 15:45:59] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-17",
    "auto_tp_no": "CL2296-140625\/1003",
    "tp_no": "1003",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMCL0012761",
            "name": "DESHI DARU TANGO PUNCH-NV .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "312",
            "auto_batch": "BTC27-150924\/312",
            "mfg_month": "Sep-2024",
            "bl": "36",
            "vv": "42.8",
            "tot_bott": "400",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "4",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "35"
        },
        {
            "code": "SCMCL0013629",
            "name": "ICAP SANTRA .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "46",
            "auto_batch": "BTC32-210525\/46",
            "mfg_month": "May-2025",
            "bl": "36",
            "vv": "35.7",
            "tot_bott": "400",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "4",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "25"
        },
        {
            "code": "SCMCL0013629",
            "name": "ICAP SANTRA .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "62",
            "auto_batch": "BTC32-120625\/62",
            "mfg_month": "Jun-2025",
            "bl": "18",
            "vv": "42.8",
            "tot_bott": "200",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "35"
        },
        {
            "code": "SCMCL0013677",
            "name": "THREE X-Sangali .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "59",
            "auto_batch": "BTC32-070625\/59",
            "mfg_month": "Jun-2025",
            "bl": "270",
            "vv": "42.8",
            "tot_bott": "3000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "30",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "35"
        },
        {
            "code": "SCMCL0013681",
            "name": "THREE X-Sangali .",
            "size": "750 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "12",
            "auto_batch": "BTC32-110425\/12",
            "mfg_month": "Apr-2025",
            "bl": "18",
            "vv": "42.8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "290"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "5040.00",
    "tamt": "5040.00"
}
[2025-10-20 15:45:59] GET data: {
    "mode": "F"
}
[2025-10-20 15:45:59] Company ID from session: 1
[2025-10-20 15:45:59] Database connection included
[2025-10-20 15:45:59] License functions included
[2025-10-20 15:45:59] License type: FL-II
[2025-10-20 15:45:59] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 15:45:59] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 15:45:59] Purchase mode: F
[2025-10-20 15:45:59] Next voucher number: 1
[2025-10-20 15:45:59] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 15:45:59] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 15:45:59] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 15:45:59] Suppliers fetched: {
    "count": 36
}
[2025-10-20 15:45:59] === FORM SUBMISSION STARTED ===
[2025-10-20 15:45:59] Form data extracted: {
    "date": "2025-10-17",
    "voc_no": "1",
    "auto_tp_no": "CL2296-140625\/1003",
    "tp_no": "1003",
    "tp_date": "2025-10-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "5040.00",
    "total_amt": "5040.00"
}
[2025-10-20 15:45:59] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-17",
        "RAJ",
        "CL2296-140625\/1003",
        "1",
        "",
        "",
        "5040.00",
        "1003",
        "2025-10-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 15:45:59] Purchase header inserted successfully: {
    "purchase_id": 9,
    "affected_rows": 1
}
[2025-10-20 15:45:59] Starting to process purchase items: {
    "item_count": 5
}
[2025-10-20 15:45:59] Processing item 0: {
    "item_code": "SCMCL0012761",
    "item_name": "DESHI DARU TANGO PUNCH-NV .",
    "cases": 4,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 480,
    "tot_bott": 400,
    "bl": 36
}
[2025-10-20 15:45:59] Item 0 inserted successfully: {
    "purchase_id": 9,
    "item_code": "SCMCL0012761"
}
[2025-10-20 15:46:00] Processing item 1: {
    "item_code": "SCMCL0013629",
    "item_name": "ICAP SANTRA .",
    "cases": 4,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 480,
    "tot_bott": 400,
    "bl": 36
}
[2025-10-20 15:46:00] Item 1 inserted successfully: {
    "purchase_id": 9,
    "item_code": "SCMCL0013629"
}
[2025-10-20 15:46:00] Processing item 2: {
    "item_code": "SCMCL0013629",
    "item_name": "ICAP SANTRA .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 200,
    "bl": 18
}
[2025-10-20 15:46:00] Item 2 inserted successfully: {
    "purchase_id": 9,
    "item_code": "SCMCL0013629"
}
[2025-10-20 15:46:00] Processing item 3: {
    "item_code": "SCMCL0013677",
    "item_name": "THREE X-Sangali .",
    "cases": 30,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3600,
    "tot_bott": 3000,
    "bl": 270
}
[2025-10-20 15:46:00] Item 3 inserted successfully: {
    "purchase_id": 9,
    "item_code": "SCMCL0013677"
}
[2025-10-20 15:46:00] Processing item 4: {
    "item_code": "SCMCL0013681",
    "item_name": "THREE X-Sangali .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-10-20 15:46:00] Item 4 inserted successfully: {
    "purchase_id": 9,
    "item_code": "SCMCL0013681"
}
[2025-10-20 15:46:00] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-10-20 15:46:00] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-20 15:47:03] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 15:47:03] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 15:47:03] POST data: []
[2025-10-20 15:47:03] GET data: {
    "mode": "F"
}
[2025-10-20 15:47:03] Company ID from session: 1
[2025-10-20 15:47:04] Database connection included
[2025-10-20 15:47:04] License functions included
[2025-10-20 15:47:04] License type: FL-II
[2025-10-20 15:47:04] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 15:47:04] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 15:47:04] Purchase mode: F
[2025-10-20 15:47:04] Next voucher number: 2
[2025-10-20 15:47:04] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 15:47:04] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 15:47:04] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 15:47:04] Suppliers fetched: {
    "count": 36
}
[2025-10-20 15:47:04] Database connection closed
[2025-10-20 15:47:04] === PURCHASE SESSION ENDED ===
[2025-10-20 15:47:20] === NEW PURCHASE SESSION STARTED ===
[2025-10-20 15:47:20] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-20 15:47:20] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-05-31",
    "auto_tp_no": "CL2296-310525\/777",
    "tp_no": "777",
    "tp_date": "2025-05-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMCL0012761",
            "name": "DESHI DARU TANGO PUNCH-NV .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "85",
            "auto_batch": "BTC27-270525\/85",
            "mfg_month": "May-2025",
            "bl": "135",
            "vv": "42.8",
            "tot_bott": "1500",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "15",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "35"
        },
        {
            "code": "SCMCL0013677",
            "name": "THREE X-Sangali .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "12",
            "batch_no": "40",
            "auto_batch": "BTC32-140525\/40",
            "mfg_month": "May-2025",
            "bl": "270",
            "vv": "42.8",
            "tot_bott": "3000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "30",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "35"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "5400.00",
    "tamt": "5400.00"
}
[2025-10-20 15:47:20] GET data: {
    "mode": "F"
}
[2025-10-20 15:47:20] Company ID from session: 1
[2025-10-20 15:47:20] Database connection included
[2025-10-20 15:47:20] License functions included
[2025-10-20 15:47:20] License type: FL-II
[2025-10-20 15:47:20] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-20 15:47:20] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-20 15:47:20] Purchase mode: F
[2025-10-20 15:47:20] Next voucher number: 2
[2025-10-20 15:47:20] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-20 15:47:20] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-20 15:47:20] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-20 15:47:20] Suppliers fetched: {
    "count": 36
}
[2025-10-20 15:47:20] === FORM SUBMISSION STARTED ===
[2025-10-20 15:47:20] Form data extracted: {
    "date": "2025-05-31",
    "voc_no": "2",
    "auto_tp_no": "CL2296-310525\/777",
    "tp_no": "777",
    "tp_date": "2025-05-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "5400.00",
    "total_amt": "5400.00"
}
[2025-10-20 15:47:20] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-05-31",
        "RAJ",
        "CL2296-310525\/777",
        "2",
        "",
        "",
        "5400.00",
        "777",
        "2025-05-31",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-20 15:47:20] Purchase header inserted successfully: {
    "purchase_id": 10,
    "affected_rows": 1
}
[2025-10-20 15:47:20] Starting to process purchase items: {
    "item_count": 2
}
[2025-10-20 15:47:20] Processing item 0: {
    "item_code": "SCMCL0012761",
    "item_name": "DESHI DARU TANGO PUNCH-NV .",
    "cases": 15,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1800,
    "tot_bott": 1500,
    "bl": 135
}
[2025-10-20 15:47:20] Item 0 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMCL0012761"
}
[2025-10-20 15:47:20] Processing item 1: {
    "item_code": "SCMCL0013677",
    "item_name": "THREE X-Sangali .",
    "cases": 30,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3600,
    "tot_bott": 3000,
    "bl": 270
}
[2025-10-20 15:47:20] Item 1 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMCL0013677"
}
[2025-10-20 15:47:21] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-10-20 15:47:21] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-28 06:50:56] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 06:50:56] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 06:50:56] POST data: []
[2025-10-28 06:50:56] GET data: {
    "mode": "F"
}
[2025-10-28 06:50:56] Company ID from session: 1
[2025-10-28 06:50:56] Database connection included
[2025-10-28 06:50:56] License functions included
[2025-10-28 06:50:56] License type: FL-II
[2025-10-28 06:50:56] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 06:50:56] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 06:50:56] Purchase mode: F
[2025-10-28 06:50:56] Next voucher number: 2
[2025-10-28 06:50:57] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 06:50:57] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 06:50:57] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 06:50:57] Suppliers fetched: {
    "count": 36
}
[2025-10-28 06:50:57] Database connection closed
[2025-10-28 06:50:57] === PURCHASE SESSION ENDED ===
[2025-10-28 06:51:52] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 06:51:52] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 06:51:52] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-08-31",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMPL0010664",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "438",
            "auto_batch": "BTP16-060825\/438",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0010665",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "447",
            "auto_batch": "BTP16-080825\/447",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0036420",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "90 ML (Pet)-96",
            "bottles_per_case": "96",
            "batch_no": "381",
            "auto_batch": "BTP16-220725\/381",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "145"
        },
        {
            "code": "SCMPL0040014",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "421",
            "auto_batch": "BTP16-310725\/421",
            "mfg_month": "Aug-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0024580",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "200",
            "auto_batch": "BTP67-190825\/200",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "135"
        },
        {
            "code": "SCMPL0024581",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "202",
            "auto_batch": "BTP67-200825\/202",
            "mfg_month": "Aug-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0024582",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "141",
            "auto_batch": "BTP67-140725\/141",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "515"
        },
        {
            "code": "SCMPL0030963",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "177",
            "auto_batch": "BTP67-290725\/177",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "440"
        },
        {
            "code": "SCMPL0030964",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "031",
            "auto_batch": "BTP67-240425\/31",
            "mfg_month": "Apr-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "205"
        },
        {
            "code": "SCMPL0034626",
            "name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "213",
            "auto_batch": "BTP67-290923\/213",
            "mfg_month": "Oct-2023",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "120.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038457",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "413",
            "auto_batch": "BTP16-280725\/413",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038458",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "343",
            "auto_batch": "BTP16-120725\/343",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0038469",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038470",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0040016",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "368",
            "auto_batch": "BTP16-190725\/368",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0038510",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "469",
            "auto_batch": "BTP67-280225\/469",
            "mfg_month": "Mar-2025",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "100.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038512",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "096",
            "auto_batch": "BTP67-060625\/96",
            "mfg_month": "Jun-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "410"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "7180.00",
    "tamt": "7180.00"
}
[2025-10-28 06:51:52] GET data: {
    "mode": "F"
}
[2025-10-28 06:51:52] Company ID from session: 1
[2025-10-28 06:51:52] Database connection included
[2025-10-28 06:51:52] License functions included
[2025-10-28 06:51:52] License type: FL-II
[2025-10-28 06:51:52] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 06:51:52] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 06:51:52] Purchase mode: F
[2025-10-28 06:51:52] Next voucher number: 2
[2025-10-28 06:51:52] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 06:51:52] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 06:51:52] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 06:51:52] Suppliers fetched: {
    "count": 36
}
[2025-10-28 06:51:52] === FORM SUBMISSION STARTED ===
[2025-10-28 06:51:52] Form data extracted: {
    "date": "2025-08-31",
    "voc_no": "2",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "7180.00",
    "total_amt": "7180.00"
}
[2025-10-28 06:51:52] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-08-31",
        "AMAR",
        "FL1305-310825\/7649",
        "2",
        "",
        "",
        "7180.00",
        "7649",
        "2025-08-31",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-28 06:51:52] Purchase header inserted successfully: {
    "purchase_id": 11,
    "affected_rows": 1
}
[2025-10-28 06:51:52] Starting to process purchase items: {
    "item_count": 17
}
[2025-10-28 06:51:52] Processing item 0: {
    "item_code": "SCMPL0010664",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:51:52] Item 0 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0010664"
}
[2025-10-28 06:51:52] Processing item 1: {
    "item_code": "SCMPL0010665",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 06:51:52] Item 1 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0010665"
}
[2025-10-28 06:51:52] Processing item 2: {
    "item_code": "SCMPL0036420",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-10-28 06:51:52] Item 2 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0036420"
}
[2025-10-28 06:51:52] Processing item 3: {
    "item_code": "SCMPL0040014",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 200,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-10-28 06:51:52] Item 3 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0040014"
}
[2025-10-28 06:51:52] Processing item 4: {
    "item_code": "SCMPL0024580",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 06:51:52] Item 4 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0024580"
}
[2025-10-28 06:51:52] Processing item 5: {
    "item_code": "SCMPL0024581",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:51:52] Item 5 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0024581"
}
[2025-10-28 06:51:52] Processing item 6: {
    "item_code": "SCMPL0024582",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:51:52] Item 6 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0024582"
}
[2025-10-28 06:51:52] Processing item 7: {
    "item_code": "SCMPL0030963",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:51:52] Item 7 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0030963"
}
[2025-10-28 06:51:52] Processing item 8: {
    "item_code": "SCMPL0030964",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 06:51:52] Item 8 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0030964"
}
[2025-10-28 06:51:52] Processing item 9: {
    "item_code": "SCMPL0034626",
    "item_name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 720,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 06:51:52] Item 9 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0034626"
}
[2025-10-28 06:51:52] Processing item 10: {
    "item_code": "SCMPL0038457",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 06:51:52] Item 10 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0038457"
}
[2025-10-28 06:51:52] Processing item 11: {
    "item_code": "SCMPL0038458",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:51:52] Item 11 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0038458"
}
[2025-10-28 06:51:52] Processing item 12: {
    "item_code": "SCMPL0038469",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 06:51:52] Item 12 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0038469"
}
[2025-10-28 06:51:52] Processing item 13: {
    "item_code": "SCMPL0038470",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:51:52] Item 13 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0038470"
}
[2025-10-28 06:51:52] Processing item 14: {
    "item_code": "SCMPL0040016",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:51:52] Item 14 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0040016"
}
[2025-10-28 06:51:52] Processing item 15: {
    "item_code": "SCMPL0038510",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 600,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 06:51:52] Item 15 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0038510"
}
[2025-10-28 06:51:52] Processing item 16: {
    "item_code": "SCMPL0038512",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:51:52] Item 16 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMPL0038512"
}
[2025-10-28 06:51:52] Purchase items processing completed: {
    "successful_items": 17,
    "total_items": 17
}
[2025-10-28 06:51:52] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-28 06:54:16] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 06:54:16] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 06:54:16] POST data: []
[2025-10-28 06:54:16] GET data: {
    "mode": "F"
}
[2025-10-28 06:54:16] Company ID from session: 1
[2025-10-28 06:54:16] Database connection included
[2025-10-28 06:54:16] License functions included
[2025-10-28 06:54:16] License type: FL-II
[2025-10-28 06:54:16] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 06:54:16] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 06:54:16] Purchase mode: F
[2025-10-28 06:54:16] Next voucher number: 3
[2025-10-28 06:54:16] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 06:54:16] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 06:54:17] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 06:54:17] Suppliers fetched: {
    "count": 36
}
[2025-10-28 06:54:17] Database connection closed
[2025-10-28 06:54:17] === PURCHASE SESSION ENDED ===
[2025-10-28 06:59:41] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 06:59:41] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 06:59:41] POST data: []
[2025-10-28 06:59:41] GET data: []
[2025-10-28 06:59:41] Company ID from session: 1
[2025-10-28 06:59:41] Database connection included
[2025-10-28 06:59:41] License functions included
[2025-10-28 06:59:41] License type: FL-II
[2025-10-28 06:59:41] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 06:59:41] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 06:59:41] Purchase mode: F
[2025-10-28 06:59:41] Next voucher number: 1
[2025-10-28 06:59:41] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 06:59:41] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 06:59:41] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 06:59:41] Suppliers fetched: {
    "count": 36
}
[2025-10-28 06:59:41] Database connection closed
[2025-10-28 06:59:41] === PURCHASE SESSION ENDED ===
[2025-10-28 06:59:56] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 06:59:56] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 06:59:56] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-08-31",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMPL0010664",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "438",
            "auto_batch": "BTP16-060825\/438",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0010665",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "447",
            "auto_batch": "BTP16-080825\/447",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0036420",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "90 ML (Pet)-96",
            "bottles_per_case": "96",
            "batch_no": "381",
            "auto_batch": "BTP16-220725\/381",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "145"
        },
        {
            "code": "SCMPL0040014",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "421",
            "auto_batch": "BTP16-310725\/421",
            "mfg_month": "Aug-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0024580",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "200",
            "auto_batch": "BTP67-190825\/200",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "135"
        },
        {
            "code": "SCMPL0024581",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "202",
            "auto_batch": "BTP67-200825\/202",
            "mfg_month": "Aug-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0024582",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "141",
            "auto_batch": "BTP67-140725\/141",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "515"
        },
        {
            "code": "SCMPL0030963",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "177",
            "auto_batch": "BTP67-290725\/177",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "440"
        },
        {
            "code": "SCMPL0030964",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "031",
            "auto_batch": "BTP67-240425\/31",
            "mfg_month": "Apr-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "205"
        },
        {
            "code": "SCMPL0034626",
            "name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "213",
            "auto_batch": "BTP67-290923\/213",
            "mfg_month": "Oct-2023",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "120.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038457",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "413",
            "auto_batch": "BTP16-280725\/413",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038458",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "343",
            "auto_batch": "BTP16-120725\/343",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0038469",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038470",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0040016",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "368",
            "auto_batch": "BTP16-190725\/368",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0038510",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "469",
            "auto_batch": "BTP67-280225\/469",
            "mfg_month": "Mar-2025",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "100.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038512",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "096",
            "auto_batch": "BTP67-060625\/96",
            "mfg_month": "Jun-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "410"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "7180.00",
    "tamt": "7180.00"
}
[2025-10-28 06:59:56] GET data: []
[2025-10-28 06:59:56] Company ID from session: 1
[2025-10-28 06:59:56] Database connection included
[2025-10-28 06:59:56] License functions included
[2025-10-28 06:59:56] License type: FL-II
[2025-10-28 06:59:56] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 06:59:56] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 06:59:56] Purchase mode: F
[2025-10-28 06:59:56] Next voucher number: 1
[2025-10-28 06:59:56] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 06:59:56] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 06:59:56] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 06:59:56] Suppliers fetched: {
    "count": 36
}
[2025-10-28 06:59:56] === FORM SUBMISSION STARTED ===
[2025-10-28 06:59:56] Form data extracted: {
    "date": "2025-08-31",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "7180.00",
    "total_amt": "7180.00"
}
[2025-10-28 06:59:56] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-08-31",
        "AMAR",
        "FL1305-310825\/7649",
        "1",
        "",
        "",
        "7180.00",
        "7649",
        "2025-08-31",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-28 06:59:56] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-10-28 06:59:56] Starting to process purchase items: {
    "item_count": 17
}
[2025-10-28 06:59:56] Processing item 0: {
    "item_code": "SCMPL0010664",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:59:56] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010664"
}
[2025-10-28 06:59:56] Processing item 1: {
    "item_code": "SCMPL0010665",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 06:59:56] Item 1 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010665"
}
[2025-10-28 06:59:56] Processing item 2: {
    "item_code": "SCMPL0036420",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-10-28 06:59:56] Item 2 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0036420"
}
[2025-10-28 06:59:56] Processing item 3: {
    "item_code": "SCMPL0040014",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 200,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-10-28 06:59:56] Item 3 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0040014"
}
[2025-10-28 06:59:56] Processing item 4: {
    "item_code": "SCMPL0024580",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 06:59:56] Item 4 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024580"
}
[2025-10-28 06:59:56] Processing item 5: {
    "item_code": "SCMPL0024581",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:59:56] Item 5 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024581"
}
[2025-10-28 06:59:56] Processing item 6: {
    "item_code": "SCMPL0024582",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:59:56] Item 6 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024582"
}
[2025-10-28 06:59:57] Processing item 7: {
    "item_code": "SCMPL0030963",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:59:57] Item 7 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0030963"
}
[2025-10-28 06:59:57] Processing item 8: {
    "item_code": "SCMPL0030964",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 06:59:57] Item 8 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0030964"
}
[2025-10-28 06:59:57] Processing item 9: {
    "item_code": "SCMPL0034626",
    "item_name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 720,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 06:59:57] Item 9 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0034626"
}
[2025-10-28 06:59:57] Processing item 10: {
    "item_code": "SCMPL0038457",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 06:59:57] Item 10 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038457"
}
[2025-10-28 06:59:57] Processing item 11: {
    "item_code": "SCMPL0038458",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:59:57] Item 11 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038458"
}
[2025-10-28 06:59:57] Processing item 12: {
    "item_code": "SCMPL0038469",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 06:59:57] Item 12 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038469"
}
[2025-10-28 06:59:57] Processing item 13: {
    "item_code": "SCMPL0038470",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 06:59:57] Item 13 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038470"
}
[2025-10-28 06:59:57] Processing item 14: {
    "item_code": "SCMPL0040016",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:59:57] Item 14 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0040016"
}
[2025-10-28 06:59:57] Processing item 15: {
    "item_code": "SCMPL0038510",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 600,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 06:59:57] Item 15 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038510"
}
[2025-10-28 06:59:57] Processing item 16: {
    "item_code": "SCMPL0038512",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 06:59:57] Item 16 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038512"
}
[2025-10-28 06:59:57] Purchase items processing completed: {
    "successful_items": 17,
    "total_items": 17
}
[2025-10-28 06:59:57] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-28 07:00:09] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 07:00:09] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 07:00:09] POST data: []
[2025-10-28 07:00:09] GET data: {
    "mode": "F"
}
[2025-10-28 07:00:09] Company ID from session: 1
[2025-10-28 07:00:09] Database connection included
[2025-10-28 07:00:09] License functions included
[2025-10-28 07:00:09] License type: FL-II
[2025-10-28 07:00:09] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 07:00:09] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 07:00:09] Purchase mode: F
[2025-10-28 07:00:09] Next voucher number: 2
[2025-10-28 07:00:09] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 07:00:09] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 07:00:09] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 07:00:09] Suppliers fetched: {
    "count": 36
}
[2025-10-28 07:00:09] Database connection closed
[2025-10-28 07:00:09] === PURCHASE SESSION ENDED ===
[2025-10-28 07:01:35] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 07:01:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 07:01:35] POST data: []
[2025-10-28 07:01:35] GET data: []
[2025-10-28 07:01:35] Company ID from session: 1
[2025-10-28 07:01:35] Database connection included
[2025-10-28 07:01:35] License functions included
[2025-10-28 07:01:35] License type: FL-II
[2025-10-28 07:01:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 07:01:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 07:01:35] Purchase mode: F
[2025-10-28 07:01:35] Next voucher number: 2
[2025-10-28 07:01:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 07:01:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 07:01:36] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 07:01:36] Suppliers fetched: {
    "count": 36
}
[2025-10-28 07:01:36] Database connection closed
[2025-10-28 07:01:36] === PURCHASE SESSION ENDED ===
[2025-10-28 07:32:03] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 07:32:03] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 07:32:03] POST data: []
[2025-10-28 07:32:03] GET data: []
[2025-10-28 07:32:03] Company ID from session: 1
[2025-10-28 07:32:03] Database connection included
[2025-10-28 07:32:03] License functions included
[2025-10-28 07:32:03] License type: FL-II
[2025-10-28 07:32:03] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 07:32:03] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 07:32:03] Purchase mode: F
[2025-10-28 07:32:03] Next voucher number: 1
[2025-10-28 07:32:03] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 07:32:03] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 07:32:03] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 07:32:03] Suppliers fetched: {
    "count": 36
}
[2025-10-28 07:32:03] Database connection closed
[2025-10-28 07:32:03] === PURCHASE SESSION ENDED ===
[2025-10-28 07:34:32] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 07:34:32] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 07:34:32] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-28",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-10-28",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMPL0010664",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "438",
            "auto_batch": "BTP16-060825\/438",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0010665",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "447",
            "auto_batch": "BTP16-080825\/447",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0036420",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "90 ML (Pet)-96",
            "bottles_per_case": "96",
            "batch_no": "381",
            "auto_batch": "BTP16-220725\/381",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "145"
        },
        {
            "code": "SCMPL0040014",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "421",
            "auto_batch": "BTP16-310725\/421",
            "mfg_month": "Aug-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0024580",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "200",
            "auto_batch": "BTP67-190825\/200",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "135"
        },
        {
            "code": "SCMPL0024581",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "202",
            "auto_batch": "BTP67-200825\/202",
            "mfg_month": "Aug-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0024582",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "141",
            "auto_batch": "BTP67-140725\/141",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "515"
        },
        {
            "code": "SCMPL0030963",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "177",
            "auto_batch": "BTP67-290725\/177",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "440"
        },
        {
            "code": "SCMPL0030964",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "031",
            "auto_batch": "BTP67-240425\/31",
            "mfg_month": "Apr-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "205"
        },
        {
            "code": "SCMPL0034626",
            "name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "213",
            "auto_batch": "BTP67-290923\/213",
            "mfg_month": "Oct-2023",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "120.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038457",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "413",
            "auto_batch": "BTP16-280725\/413",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038458",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "343",
            "auto_batch": "BTP16-120725\/343",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0038469",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038470",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0040016",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "368",
            "auto_batch": "BTP16-190725\/368",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0038510",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "469",
            "auto_batch": "BTP67-280225\/469",
            "mfg_month": "Mar-2025",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "100.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038512",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "096",
            "auto_batch": "BTP67-060625\/96",
            "mfg_month": "Jun-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "410"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "7180.00",
    "tamt": "7180.00"
}
[2025-10-28 07:34:32] GET data: []
[2025-10-28 07:34:32] Company ID from session: 1
[2025-10-28 07:34:32] Database connection included
[2025-10-28 07:34:32] License functions included
[2025-10-28 07:34:32] License type: FL-II
[2025-10-28 07:34:32] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 07:34:32] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 07:34:32] Purchase mode: F
[2025-10-28 07:34:32] Next voucher number: 1
[2025-10-28 07:34:32] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 07:34:32] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 07:34:32] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 07:34:32] Suppliers fetched: {
    "count": 36
}
[2025-10-28 07:34:32] === FORM SUBMISSION STARTED ===
[2025-10-28 07:34:32] Form data extracted: {
    "date": "2025-10-28",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-10-28",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "7180.00",
    "total_amt": "7180.00"
}
[2025-10-28 07:34:32] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-28",
        "AMAR",
        "FL1305-310825\/7649",
        "1",
        "",
        "",
        "7180.00",
        "7649",
        "2025-10-28",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-28 07:34:32] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-10-28 07:34:32] Starting to process purchase items: {
    "item_count": 17
}
[2025-10-28 07:34:32] Processing item 0: {
    "item_code": "SCMPL0010664",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:34:32] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010664"
}
[2025-10-28 07:34:32] Processing item 1: {
    "item_code": "SCMPL0010665",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 07:34:32] Item 1 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010665"
}
[2025-10-28 07:34:32] Processing item 2: {
    "item_code": "SCMPL0036420",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-10-28 07:34:32] Item 2 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0036420"
}
[2025-10-28 07:34:32] Processing item 3: {
    "item_code": "SCMPL0040014",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 200,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-10-28 07:34:32] Item 3 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0040014"
}
[2025-10-28 07:34:33] Processing item 4: {
    "item_code": "SCMPL0024580",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 07:34:33] Item 4 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024580"
}
[2025-10-28 07:34:33] Processing item 5: {
    "item_code": "SCMPL0024581",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:34:33] Item 5 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024581"
}
[2025-10-28 07:34:33] Processing item 6: {
    "item_code": "SCMPL0024582",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:34:33] Item 6 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024582"
}
[2025-10-28 07:34:33] Processing item 7: {
    "item_code": "SCMPL0030963",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:34:33] Item 7 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0030963"
}
[2025-10-28 07:34:33] Processing item 8: {
    "item_code": "SCMPL0030964",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 07:34:33] Item 8 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0030964"
}
[2025-10-28 07:34:33] Processing item 9: {
    "item_code": "SCMPL0034626",
    "item_name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 720,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 07:34:33] Item 9 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0034626"
}
[2025-10-28 07:34:33] Processing item 10: {
    "item_code": "SCMPL0038457",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 07:34:33] Item 10 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038457"
}
[2025-10-28 07:34:33] Processing item 11: {
    "item_code": "SCMPL0038458",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:34:33] Item 11 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038458"
}
[2025-10-28 07:34:33] Processing item 12: {
    "item_code": "SCMPL0038469",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 07:34:33] Item 12 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038469"
}
[2025-10-28 07:34:33] Processing item 13: {
    "item_code": "SCMPL0038470",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:34:33] Item 13 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038470"
}
[2025-10-28 07:34:33] Processing item 14: {
    "item_code": "SCMPL0040016",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:34:33] Item 14 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0040016"
}
[2025-10-28 07:34:33] Processing item 15: {
    "item_code": "SCMPL0038510",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 600,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 07:34:33] Item 15 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038510"
}
[2025-10-28 07:34:33] Processing item 16: {
    "item_code": "SCMPL0038512",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:34:33] Item 16 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038512"
}
[2025-10-28 07:34:33] Purchase items processing completed: {
    "successful_items": 17,
    "total_items": 17
}
[2025-10-28 07:34:33] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-28 07:39:50] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 07:39:50] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 07:39:50] POST data: []
[2025-10-28 07:39:50] GET data: {
    "mode": "F"
}
[2025-10-28 07:39:50] Company ID from session: 1
[2025-10-28 07:39:50] Database connection included
[2025-10-28 07:39:50] License functions included
[2025-10-28 07:39:50] License type: FL-II
[2025-10-28 07:39:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 07:39:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 07:39:50] Purchase mode: F
[2025-10-28 07:39:50] Next voucher number: 1
[2025-10-28 07:39:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 07:39:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 07:39:50] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 07:39:50] Suppliers fetched: {
    "count": 36
}
[2025-10-28 07:39:50] Database connection closed
[2025-10-28 07:39:50] === PURCHASE SESSION ENDED ===
[2025-10-28 07:40:05] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 07:40:05] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-10_2025-10-26": true,
    "auto_transition_2025-10_2025-10-28": true
}
[2025-10-28 07:40:05] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-08-31",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMPL0010664",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "438",
            "auto_batch": "BTP16-060825\/438",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0010665",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "447",
            "auto_batch": "BTP16-080825\/447",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0036420",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "90 ML (Pet)-96",
            "bottles_per_case": "96",
            "batch_no": "381",
            "auto_batch": "BTP16-220725\/381",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "145"
        },
        {
            "code": "SCMPL0040014",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "421",
            "auto_batch": "BTP16-310725\/421",
            "mfg_month": "Aug-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0024580",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "200",
            "auto_batch": "BTP67-190825\/200",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "135"
        },
        {
            "code": "SCMPL0024581",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "202",
            "auto_batch": "BTP67-200825\/202",
            "mfg_month": "Aug-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0024582",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "141",
            "auto_batch": "BTP67-140725\/141",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "515"
        },
        {
            "code": "SCMPL0030963",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "177",
            "auto_batch": "BTP67-290725\/177",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "440"
        },
        {
            "code": "SCMPL0030964",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "031",
            "auto_batch": "BTP67-240425\/31",
            "mfg_month": "Apr-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "205"
        },
        {
            "code": "SCMPL0034626",
            "name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "213",
            "auto_batch": "BTP67-290923\/213",
            "mfg_month": "Oct-2023",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "120.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038457",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "413",
            "auto_batch": "BTP16-280725\/413",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038458",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "343",
            "auto_batch": "BTP16-120725\/343",
            "mfg_month": "Jul-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0038469",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1120"
        },
        {
            "code": "SCMPL0038470",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "417",
            "auto_batch": "BTP16-300725\/417",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "560"
        },
        {
            "code": "SCMPL0040016",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "368",
            "auto_batch": "BTP16-190725\/368",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0038510",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "469",
            "auto_batch": "BTP67-280225\/469",
            "mfg_month": "Mar-2025",
            "bl": "4.5",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "6",
            "case_rate": "100.000",
            "mrp": "1660"
        },
        {
            "code": "SCMPL0038512",
            "name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "096",
            "auto_batch": "BTP67-060625\/96",
            "mfg_month": "Jun-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "410"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "7180.00",
    "tamt": "7180.00"
}
[2025-10-28 07:40:05] GET data: {
    "mode": "F"
}
[2025-10-28 07:40:05] Company ID from session: 1
[2025-10-28 07:40:05] Database connection included
[2025-10-28 07:40:05] License functions included
[2025-10-28 07:40:05] License type: FL-II
[2025-10-28 07:40:05] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 07:40:05] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 07:40:05] Purchase mode: F
[2025-10-28 07:40:05] Next voucher number: 1
[2025-10-28 07:40:05] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 07:40:05] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 07:40:05] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 07:40:05] Suppliers fetched: {
    "count": 36
}
[2025-10-28 07:40:05] === FORM SUBMISSION STARTED ===
[2025-10-28 07:40:05] Form data extracted: {
    "date": "2025-08-31",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7649",
    "tp_no": "7649",
    "tp_date": "2025-08-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "7180.00",
    "total_amt": "7180.00"
}
[2025-10-28 07:40:05] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-08-31",
        "AMAR",
        "FL1305-310825\/7649",
        "1",
        "",
        "",
        "7180.00",
        "7649",
        "2025-08-31",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-28 07:40:05] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-10-28 07:40:05] Starting to process purchase items: {
    "item_count": 17
}
[2025-10-28 07:40:05] Processing item 0: {
    "item_code": "SCMPL0010664",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:40:05] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010664"
}
[2025-10-28 07:40:05] Processing item 1: {
    "item_code": "SCMPL0010665",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 07:40:05] Item 1 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010665"
}
[2025-10-28 07:40:05] Processing item 2: {
    "item_code": "SCMPL0036420",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-10-28 07:40:05] Item 2 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0036420"
}
[2025-10-28 07:40:05] Processing item 3: {
    "item_code": "SCMPL0040014",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 200,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-10-28 07:40:05] Item 3 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0040014"
}
[2025-10-28 07:40:05] Processing item 4: {
    "item_code": "SCMPL0024580",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 07:40:05] Item 4 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024580"
}
[2025-10-28 07:40:05] Processing item 5: {
    "item_code": "SCMPL0024581",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:40:05] Item 5 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024581"
}
[2025-10-28 07:40:05] Processing item 6: {
    "item_code": "SCMPL0024582",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:40:05] Item 6 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0024582"
}
[2025-10-28 07:40:05] Processing item 7: {
    "item_code": "SCMPL0030963",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:40:05] Item 7 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0030963"
}
[2025-10-28 07:40:05] Processing item 8: {
    "item_code": "SCMPL0030964",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 100,
    "bl": 9
}
[2025-10-28 07:40:05] Item 8 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0030964"
}
[2025-10-28 07:40:05] Processing item 9: {
    "item_code": "SCMPL0034626",
    "item_name": "BACARDI GINGER ULTRA DELUXE ORIGINAL GINGER RUM .",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 720,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 07:40:05] Item 9 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0034626"
}
[2025-10-28 07:40:05] Processing item 10: {
    "item_code": "SCMPL0038457",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 07:40:05] Item 10 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038457"
}
[2025-10-28 07:40:05] Processing item 11: {
    "item_code": "SCMPL0038458",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:40:05] Item 11 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038458"
}
[2025-10-28 07:40:05] Processing item 12: {
    "item_code": "SCMPL0038469",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 9
}
[2025-10-28 07:40:05] Item 12 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038469"
}
[2025-10-28 07:40:05] Processing item 13: {
    "item_code": "SCMPL0038470",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 24,
    "bl": 9
}
[2025-10-28 07:40:05] Item 13 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038470"
}
[2025-10-28 07:40:05] Processing item 14: {
    "item_code": "SCMPL0040016",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:40:05] Item 14 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0040016"
}
[2025-10-28 07:40:05] Processing item 15: {
    "item_code": "SCMPL0038510",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 0,
    "bottles": 6,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 600,
    "tot_bott": 6,
    "bl": 4.5
}
[2025-10-28 07:40:05] Item 15 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038510"
}
[2025-10-28 07:40:05] Processing item 16: {
    "item_code": "SCMPL0038512",
    "item_name": "BACARDI MANGO CHILLI ULTRA DELUXE ORIGINAL MANGO C",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-10-28 07:40:05] Item 16 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0038512"
}
[2025-10-28 07:40:05] Purchase items processing completed: {
    "successful_items": 17,
    "total_items": 17
}
[2025-10-28 07:40:05] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-28 12:50:47] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 12:50:47] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-28 12:50:47] POST data: []
[2025-10-28 12:50:47] GET data: []
[2025-10-28 12:50:47] Company ID from session: 1
[2025-10-28 12:50:48] Database connection included
[2025-10-28 12:50:48] License functions included
[2025-10-28 12:50:48] License type: FL-II
[2025-10-28 12:50:48] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 12:50:48] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 12:50:48] Purchase mode: F
[2025-10-28 12:50:48] Next voucher number: 1
[2025-10-28 12:50:48] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 12:50:48] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 12:50:48] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 12:50:48] Suppliers fetched: {
    "count": 36
}
[2025-10-28 12:50:48] Database connection closed
[2025-10-28 12:50:48] === PURCHASE SESSION ENDED ===
[2025-10-28 12:52:23] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 12:52:23] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-28 12:52:23] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-28",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-01",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "supplier_code": "ABHI",
    "items": [
        {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "43.20",
            "vv": "0",
            "tot_bott": "480",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        {
            "code": "SCMPL0026919",
            "name": "6 Bullet Permium Whisky .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "90.00",
            "vv": "0",
            "tot_bott": "240",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        {
            "code": "SCMKS0027100",
            "name": "6 Bullet Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "60.48",
            "vv": "0",
            "tot_bott": "672",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "7",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "2340.00",
    "tamt": "2340.00"
}
[2025-10-28 12:52:23] GET data: []
[2025-10-28 12:52:23] Company ID from session: 1
[2025-10-28 12:52:23] Database connection included
[2025-10-28 12:52:23] License functions included
[2025-10-28 12:52:23] License type: FL-II
[2025-10-28 12:52:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 12:52:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 12:52:23] Purchase mode: F
[2025-10-28 12:52:23] Next voucher number: 1
[2025-10-28 12:52:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 12:52:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 12:52:23] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 12:52:23] Suppliers fetched: {
    "count": 36
}
[2025-10-28 12:52:23] === FORM SUBMISSION STARTED ===
[2025-10-28 12:52:23] Form data extracted: {
    "date": "2025-10-28",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-01",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ABHI",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "basic_amt": "2340.00",
    "total_amt": "2340.00"
}
[2025-10-28 12:52:23] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-28",
        "ABHI",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "2340.00",
        "7654",
        "2025-10-01",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-28 12:52:23] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-10-28 12:52:23] Starting to process purchase items: {
    "item_count": 3
}
[2025-10-28 12:52:23] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 480,
    "bl": 43.2
}
[2025-10-28 12:52:23] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0019028"
}
[2025-10-28 12:52:23] Processing item 1: {
    "item_code": "SCMPL0026919",
    "item_name": "6 Bullet Permium Whisky .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 1000,
    "tot_bott": 240,
    "bl": 90
}
[2025-10-28 12:52:23] Item 1 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0026919"
}
[2025-10-28 12:52:23] Processing item 2: {
    "item_code": "SCMKS0027100",
    "item_name": "6 Bullet Whisky .",
    "cases": 7,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 840,
    "tot_bott": 672,
    "bl": 60.48
}
[2025-10-28 12:52:23] Item 2 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMKS0027100"
}
[2025-10-28 12:52:23] Purchase items processing completed: {
    "successful_items": 3,
    "total_items": 3
}
[2025-10-28 12:52:23] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-28 13:16:54] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 13:16:54] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-28 13:16:54] POST data: []
[2025-10-28 13:16:54] GET data: []
[2025-10-28 13:16:54] Company ID from session: 1
[2025-10-28 13:16:54] Database connection included
[2025-10-28 13:16:54] License functions included
[2025-10-28 13:16:54] License type: FL-II
[2025-10-28 13:16:54] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 13:16:54] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 13:16:54] Purchase mode: F
[2025-10-28 13:16:54] Next voucher number: 1
[2025-10-28 13:16:54] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 13:16:54] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 13:16:54] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 13:16:54] Suppliers fetched: {
    "count": 36
}
[2025-10-28 13:16:54] Database connection closed
[2025-10-28 13:16:54] === PURCHASE SESSION ENDED ===
[2025-10-28 13:18:09] === NEW PURCHASE SESSION STARTED ===
[2025-10-28 13:18:09] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-10-28 13:18:09] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-28",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-28",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "supplier_code": "ABHI",
    "items": [
        {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "43.20",
            "vv": "0",
            "tot_bott": "480",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        {
            "code": "SCMKS0031549",
            "name": "6 Bullet Whisky .",
            "size": "90 ML (Pet)-96",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "86.40",
            "vv": "0",
            "tot_bott": "960",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "8500.00",
    "tamt": "8500.00"
}
[2025-10-28 13:18:09] GET data: []
[2025-10-28 13:18:09] Company ID from session: 1
[2025-10-28 13:18:09] Database connection included
[2025-10-28 13:18:09] License functions included
[2025-10-28 13:18:09] License type: FL-II
[2025-10-28 13:18:09] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-10-28 13:18:09] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-10-28 13:18:09] Purchase mode: F
[2025-10-28 13:18:09] Next voucher number: 1
[2025-10-28 13:18:09] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-28 13:18:09] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-10-28 13:18:09] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-10-28 13:18:09] Suppliers fetched: {
    "count": 36
}
[2025-10-28 13:18:09] === FORM SUBMISSION STARTED ===
[2025-10-28 13:18:09] Form data extracted: {
    "date": "2025-10-28",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-28",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ABHI",
    "supplier_name": "ABHIJIT WINE INDUSTRIES",
    "basic_amt": "8500.00",
    "total_amt": "8500.00"
}
[2025-10-28 13:18:09] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-28",
        "ABHI",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "8500.00",
        "7654",
        "2025-10-28",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-10-28 13:18:09] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-10-28 13:18:09] Starting to process purchase items: {
    "item_count": 2
}
[2025-10-28 13:18:09] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 480,
    "bl": 43.2
}
[2025-10-28 13:18:09] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0019028"
}
[2025-10-28 13:18:09] Processing item 1: {
    "item_code": "SCMKS0031549",
    "item_name": "6 Bullet Whisky .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 8000,
    "tot_bott": 960,
    "bl": 86.4
}
[2025-10-28 13:18:09] Item 1 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMKS0031549"
}
[2025-10-28 13:18:09] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-10-28 13:18:09] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-10-30 10:40:29] === NEW PURCHASE SESSION STARTED ===
[2025-10-30 10:40:29] Session data: {
    "user_id": "3",
    "username": "deccan",
    "CompID": 3,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Deccan Wine Shop"
}
[2025-10-30 10:40:29] POST data: []
[2025-10-30 10:40:29] GET data: {
    "mode": "F"
}
[2025-10-30 10:40:29] Company ID from session: 3
[2025-10-30 10:40:29] Database connection included
[2025-10-30 10:40:29] License functions included
[2025-10-30 10:40:29] License type: CL-III
[2025-10-30 10:40:29] Available classes: [
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    }
]
[2025-10-30 10:40:29] Allowed class SGROUP values: [
    "L",
    "O",
    "O",
    "O",
    "O"
]
[2025-10-30 10:40:29] Purchase mode: F
[2025-10-30 10:40:29] Next voucher number: 1
[2025-10-30 10:40:29] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-30 10:40:29] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "L",
        "O",
        "O",
        "O",
        "O"
    ],
    "types": "sssss"
}
[2025-10-30 10:40:29] Items fetched from database: {
    "count": 150,
    "license_filter_applied": true
}
[2025-10-30 10:40:29] Suppliers fetched: {
    "count": 36
}
[2025-10-30 10:40:29] Database connection closed
[2025-10-30 10:40:29] === PURCHASE SESSION ENDED ===
[2025-10-30 10:41:23] === NEW PURCHASE SESSION STARTED ===
[2025-10-30 10:41:23] Session data: {
    "user_id": "3",
    "username": "deccan",
    "CompID": 3,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Deccan Wine Shop"
}
[2025-10-30 10:41:23] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-10-30",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-30",
    "inv_no": "",
    "inv_date": "2025-10-30",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMCL0013802",
            "name": "Chak De Badishep Maza .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "2.16",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "120.00",
    "tamt": "120.00"
}
[2025-10-30 10:41:23] GET data: {
    "mode": "F"
}
[2025-10-30 10:41:23] Company ID from session: 3
[2025-10-30 10:41:23] Database connection included
[2025-10-30 10:41:23] License functions included
[2025-10-30 10:41:23] License type: CL-III
[2025-10-30 10:41:23] Available classes: [
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    }
]
[2025-10-30 10:41:23] Allowed class SGROUP values: [
    "L",
    "O",
    "O",
    "O",
    "O"
]
[2025-10-30 10:41:23] Purchase mode: F
[2025-10-30 10:41:23] Next voucher number: 1
[2025-10-30 10:41:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-10-30 10:41:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "L",
        "O",
        "O",
        "O",
        "O"
    ],
    "types": "sssss"
}
[2025-10-30 10:41:23] Items fetched from database: {
    "count": 150,
    "license_filter_applied": true
}
[2025-10-30 10:41:23] Suppliers fetched: {
    "count": 36
}
[2025-10-30 10:41:23] === FORM SUBMISSION STARTED ===
[2025-10-30 10:41:23] Form data extracted: {
    "date": "2025-10-30",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-10-30",
    "inv_no": "",
    "inv_date": "2025-10-30",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "120.00",
    "total_amt": "120.00"
}
[2025-10-30 10:41:23] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-30",
        "AMAR",
        "FL1305-310825\/7654",
        "1",
        "",
        "2025-10-30",
        "120.00",
        "7654",
        "2025-10-30",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        3
    ]
}
[2025-10-30 10:41:23] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-10-30 10:41:23] Starting to process purchase items: {
    "item_count": 1
}
[2025-10-30 10:41:23] Processing item 0: {
    "item_code": "SCMCL0013802",
    "item_name": "Chak De Badishep Maza .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 2.16
}
[2025-10-30 10:41:23] Item 0 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMCL0013802"
}
[2025-10-30 10:41:23] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-10-30 10:41:23] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-11-04 13:40:24] === NEW PURCHASE SESSION STARTED ===
[2025-11-04 13:40:24] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-11-04 13:40:24] POST data: []
[2025-11-04 13:40:24] GET data: []
[2025-11-04 13:40:24] Company ID from session: 1
[2025-11-04 13:40:25] Database connection included
[2025-11-04 13:40:25] License functions included
[2025-11-04 13:40:25] License type: FL-II
[2025-11-04 13:40:25] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-11-04 13:40:25] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-11-04 13:40:25] Purchase mode: F
[2025-11-04 13:40:25] Next voucher number: 2
[2025-11-04 13:40:25] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-11-04 13:40:25] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-11-04 13:40:25] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-11-04 13:40:25] Suppliers fetched: {
    "count": 36
}
[2025-11-04 13:40:25] Database connection closed
[2025-11-04 13:40:25] === PURCHASE SESSION ENDED ===
[2025-11-08 12:48:35] === NEW PURCHASE SESSION STARTED ===
[2025-11-08 12:48:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-11_2025-11-08": true
}
[2025-11-08 12:48:35] POST data: []
[2025-11-08 12:48:35] GET data: {
    "mode": "F"
}
[2025-11-08 12:48:35] Company ID from session: 1
[2025-11-08 12:48:35] Database connection included
[2025-11-08 12:48:35] License functions included
[2025-11-08 12:48:35] License type: FL-II
[2025-11-08 12:48:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-11-08 12:48:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-11-08 12:48:35] Purchase mode: F
[2025-11-08 12:48:35] Next voucher number: 2
[2025-11-08 12:48:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-11-08 12:48:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-11-08 12:48:35] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-11-08 12:48:35] Suppliers fetched: {
    "count": 36
}
[2025-11-08 12:48:35] Database connection closed
[2025-11-08 12:48:35] === PURCHASE SESSION ENDED ===
[2025-11-08 12:49:25] === NEW PURCHASE SESSION STARTED ===
[2025-11-08 12:49:25] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-11_2025-11-08": true
}
[2025-11-08 12:49:25] POST data: []
[2025-11-08 12:49:25] GET data: {
    "mode": "F"
}
[2025-11-08 12:49:25] Company ID from session: 1
[2025-11-08 12:49:25] Database connection included
[2025-11-08 12:49:25] License functions included
[2025-11-08 12:49:25] License type: FL-II
[2025-11-08 12:49:25] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-11-08 12:49:25] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-11-08 12:49:25] Purchase mode: F
[2025-11-08 12:49:25] Next voucher number: 2
[2025-11-08 12:49:25] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-11-08 12:49:25] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-11-08 12:49:25] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-11-08 12:49:25] Suppliers fetched: {
    "count": 36
}
[2025-11-08 12:49:25] Database connection closed
[2025-11-08 12:49:25] === PURCHASE SESSION ENDED ===
[2025-11-08 12:49:55] === NEW PURCHASE SESSION STARTED ===
[2025-11-08 12:49:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-11_2025-11-08": true
}
[2025-11-08 12:49:55] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-10-31",
    "auto_tp_no": "FL1305-311025\/11160",
    "tp_no": "11160",
    "tp_date": "2025-10-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMBR0018131",
            "name": "Budweiser Premium King of Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "821",
            "auto_batch": "BTBL6-220925\/823",
            "mfg_month": "Sep-2025",
            "bl": "36",
            "vv": "4",
            "tot_bott": "72",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "190"
        },
        {
            "code": "SCMBR0018132",
            "name": "Budweiser Premium King of Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "772",
            "auto_batch": "BTBL6-120925\/774",
            "mfg_month": "Sep-2025",
            "bl": "39",
            "vv": "5",
            "tot_bott": "60",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "245"
        },
        {
            "code": "SCMPL0024580",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "208",
            "auto_batch": "BTP67-220825\/208",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "135"
        },
        {
            "code": "SCMPL0024583",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "223",
            "auto_batch": "BTP67-090925\/223",
            "mfg_month": "Sep-2025",
            "bl": "18",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1025"
        },
        {
            "code": "SCMPL0024582",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "231",
            "auto_batch": "BTP67-110925\/231",
            "mfg_month": "Sep-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "515"
        },
        {
            "code": "SCMPL0024581",
            "name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "255",
            "auto_batch": "BTP67-260925\/255",
            "mfg_month": "Sep-2025",
            "bl": "51.84",
            "vv": "25",
            "tot_bott": "288",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "6",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0040016",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "615",
            "auto_batch": "BTP16-051025\/615",
            "mfg_month": "Oct-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0028276",
            "name": "8 PM Special Whisky .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "603",
            "auto_batch": "BTP16-011025\/603",
            "mfg_month": "Oct-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "205"
        },
        {
            "code": "SCMPL0040015",
            "name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "614",
            "auto_batch": "BTP16-051025\/614",
            "mfg_month": "Oct-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "270"
        },
        {
            "code": "SCMBR0027089",
            "name": "Budweiser Magnum Super Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "775",
            "auto_batch": "BTBL6-130925\/777",
            "mfg_month": "Sep-2025",
            "bl": "117",
            "vv": "8",
            "tot_bott": "180",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "15",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0040014",
            "name": "MAGIC MOMENTS PURE GRAIN VODKA .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "650",
            "auto_batch": "BTP16-141025\/650",
            "mfg_month": "Oct-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "270"
        },
        {
            "code": "SCMPL0030963",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "242",
            "auto_batch": "BTP67-180925\/242",
            "mfg_month": "Sep-2025",
            "bl": "19.44",
            "vv": "25",
            "tot_bott": "108",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "12",
            "case_rate": "80.000",
            "mrp": "440"
        },
        {
            "code": "SCMPL0036599",
            "name": "OAKSMITH INTERNATIONAL BLENDED WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "072",
            "auto_batch": "BTP69-250825\/72",
            "mfg_month": "Aug-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "330"
        },
        {
            "code": "SCMPL0030964",
            "name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "181",
            "auto_batch": "BTP67-310725\/181",
            "mfg_month": "Aug-2025",
            "bl": "2.25",
            "vv": "25",
            "tot_bott": "25",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "25",
            "case_rate": "800.000",
            "mrp": "225"
        },
        {
            "code": "SCMPL0041341",
            "name": "AFTER DARK BLUE RARE GRAIN WHISKY .",
            "size": "90 ML (Pet)-96",
            "bottles_per_case": "96",
            "batch_no": "569",
            "auto_batch": "BTP16-190925\/569",
            "mfg_month": "Sep-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "192",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "115"
        },
        {
            "code": "SCMPL0041340",
            "name": "AFTER DARK BLUE RARE GRAIN WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "618",
            "auto_batch": "BTP16-051025\/618",
            "mfg_month": "Oct-2025",
            "bl": "86.4",
            "vv": "25",
            "tot_bott": "480",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "220"
        },
        {
            "code": "SCMPL0041338",
            "name": "AFTER DARK BLUE RARE GRAIN WHISKY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "493",
            "auto_batch": "BTP16-250825\/493",
            "mfg_month": "Aug-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "880"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "24220.00",
    "tamt": "24220.00"
}
[2025-11-08 12:49:55] GET data: {
    "mode": "F"
}
[2025-11-08 12:49:55] Company ID from session: 1
[2025-11-08 12:49:55] Database connection included
[2025-11-08 12:49:55] License functions included
[2025-11-08 12:49:55] License type: FL-II
[2025-11-08 12:49:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-11-08 12:49:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-11-08 12:49:55] Purchase mode: F
[2025-11-08 12:49:55] Next voucher number: 2
[2025-11-08 12:49:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-11-08 12:49:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-11-08 12:49:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-11-08 12:49:55] Suppliers fetched: {
    "count": 36
}
[2025-11-08 12:49:55] === FORM SUBMISSION STARTED ===
[2025-11-08 12:49:55] Form data extracted: {
    "date": "2025-10-31",
    "voc_no": "2",
    "auto_tp_no": "FL1305-311025\/11160",
    "tp_no": "11160",
    "tp_date": "2025-10-31",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "24220.00",
    "total_amt": "24220.00"
}
[2025-11-08 12:49:55] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-10-31",
        "AMAR",
        "FL1305-311025\/11160",
        "2",
        "",
        "",
        "24220.00",
        "11160",
        "2025-10-31",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-11-08 12:49:55] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-11-08 12:49:55] Starting to process purchase items: {
    "item_count": 17
}
[2025-11-08 12:49:55] Processing item 0: {
    "item_code": "SCMBR0018131",
    "item_name": "Budweiser Premium King of Beer .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 72,
    "bl": 36
}
[2025-11-08 12:49:55] Item 0 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMBR0018131"
}
[2025-11-08 12:49:55] Processing item 1: {
    "item_code": "SCMBR0018132",
    "item_name": "Budweiser Premium King of Beer .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 4000,
    "tot_bott": 60,
    "bl": 39
}
[2025-11-08 12:49:55] Item 1 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMBR0018132"
}
[2025-11-08 12:49:55] Processing item 2: {
    "item_code": "SCMPL0024580",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 100,
    "bl": 9
}
[2025-11-08 12:49:55] Item 2 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0024580"
}
[2025-11-08 12:49:55] Processing item 3: {
    "item_code": "SCMPL0024583",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 160,
    "tot_bott": 24,
    "bl": 18
}
[2025-11-08 12:49:55] Item 3 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0024583"
}
[2025-11-08 12:49:55] Processing item 4: {
    "item_code": "SCMPL0024582",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 24,
    "bl": 9
}
[2025-11-08 12:49:55] Item 4 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0024582"
}
[2025-11-08 12:49:55] Processing item 5: {
    "item_code": "SCMPL0024581",
    "item_name": "Black by Bacardi Ultra Deluxe Original Premium Cra",
    "cases": 6,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 720,
    "tot_bott": 288,
    "bl": 51.84
}
[2025-11-08 12:49:55] Item 5 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0024581"
}
[2025-11-08 12:49:55] Processing item 6: {
    "item_code": "SCMPL0040016",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA ORAN",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 200,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-11-08 12:49:55] Item 6 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0040016"
}
[2025-11-08 12:49:55] Processing item 7: {
    "item_code": "SCMPL0028276",
    "item_name": "8 PM Special Whisky .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 1600,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-11-08 12:49:55] Item 7 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0028276"
}
[2025-11-08 12:49:55] Processing item 8: {
    "item_code": "SCMPL0040015",
    "item_name": "M2 MAGIC MOMENTS REMIX SMOOTH FLAVOURED VODKA GREE",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 160,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-11-08 12:49:55] Item 8 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0040015"
}
[2025-11-08 12:49:55] Processing item 9: {
    "item_code": "SCMBR0027089",
    "item_name": "Budweiser Magnum Super Premium Beer .",
    "cases": 15,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 12000,
    "tot_bott": 180,
    "bl": 117
}
[2025-11-08 12:49:55] Item 9 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMBR0027089"
}
[2025-11-08 12:49:55] Processing item 10: {
    "item_code": "SCMPL0040014",
    "item_name": "MAGIC MOMENTS PURE GRAIN VODKA .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 200,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-11-08 12:49:55] Item 10 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0040014"
}
[2025-11-08 12:49:55] Processing item 11: {
    "item_code": "SCMPL0030963",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 2,
    "bottles": 12,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 1120,
    "tot_bott": 108,
    "bl": 19.44
}
[2025-11-08 12:49:55] Item 11 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0030963"
}
[2025-11-08 12:49:55] Processing item 12: {
    "item_code": "SCMPL0036599",
    "item_name": "OAKSMITH INTERNATIONAL BLENDED WHISKY .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-11-08 12:49:55] Item 12 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0036599"
}
[2025-11-08 12:49:55] Processing item 13: {
    "item_code": "SCMPL0030964",
    "item_name": "Bacardi Limon Ultra Deluxe Original citrus Rum .",
    "cases": 0,
    "bottles": 25,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 200,
    "tot_bott": 25,
    "bl": 2.25
}
[2025-11-08 12:49:55] Item 13 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0030964"
}
[2025-11-08 12:49:55] Processing item 14: {
    "item_code": "SCMPL0041341",
    "item_name": "AFTER DARK BLUE RARE GRAIN WHISKY .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 1600,
    "tot_bott": 192,
    "bl": 17.28
}
[2025-11-08 12:49:55] Item 14 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0041341"
}
[2025-11-08 12:49:55] Processing item 15: {
    "item_code": "SCMPL0041340",
    "item_name": "AFTER DARK BLUE RARE GRAIN WHISKY .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 800,
    "tot_bott": 480,
    "bl": 86.4
}
[2025-11-08 12:49:55] Item 15 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0041340"
}
[2025-11-08 12:49:55] Processing item 16: {
    "item_code": "SCMPL0041338",
    "item_name": "AFTER DARK BLUE RARE GRAIN WHISKY .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-11-08 12:49:55] Item 16 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0041338"
}
[2025-11-08 12:49:55] Purchase items processing completed: {
    "successful_items": 17,
    "total_items": 17
}
[2025-11-08 12:49:55] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-11-10 04:19:30] === NEW PURCHASE SESSION STARTED ===
[2025-11-10 04:19:30] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-11_2025-11-10": true
}
[2025-11-10 04:19:30] POST data: []
[2025-11-10 04:19:30] GET data: {
    "mode": "F"
}
[2025-11-10 04:19:30] Company ID from session: 1
[2025-11-10 04:19:30] Database connection included
[2025-11-10 04:19:30] License functions included
[2025-11-10 04:19:30] License type: FL-II
[2025-11-10 04:19:30] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-11-10 04:19:30] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-11-10 04:19:30] Purchase mode: F
[2025-11-10 04:19:30] Next voucher number: 3
[2025-11-10 04:19:30] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-11-10 04:19:30] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssssss"
}
[2025-11-10 04:19:30] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-11-10 04:19:30] Suppliers fetched: {
    "count": 36
}
[2025-11-10 04:19:30] Database connection closed
[2025-11-10 04:19:30] === PURCHASE SESSION ENDED ===
[2025-12-06 14:15:26] === NEW PURCHASE SESSION STARTED ===
[2025-12-06 14:15:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-12_2025-12-06": true
}
[2025-12-06 14:15:26] POST data: []
[2025-12-06 14:15:26] GET data: {
    "mode": "F"
}
[2025-12-06 14:15:26] Company ID from session: 1
[2025-12-06 14:15:26] Database connection included
[2025-12-06 14:15:26] License functions included
[2025-12-06 14:15:26] License type: FL-II
[2025-12-06 14:15:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-06 14:15:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-06 14:15:26] Purchase mode: F
[2025-12-06 14:15:26] Next voucher number: 3
[2025-12-06 14:15:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-06 14:15:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-06 14:15:26] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-06 14:15:26] Suppliers fetched: {
    "count": 36
}
[2025-12-06 14:15:26] Database connection closed
[2025-12-06 14:15:26] === PURCHASE SESSION ENDED ===
[2025-12-06 14:18:03] === NEW PURCHASE SESSION STARTED ===
[2025-12-06 14:18:03] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-12_2025-12-06": true
}
[2025-12-06 14:18:03] POST data: []
[2025-12-06 14:18:03] GET data: {
    "mode": "F"
}
[2025-12-06 14:18:03] Company ID from session: 1
[2025-12-06 14:18:03] Database connection included
[2025-12-06 14:18:03] License functions included
[2025-12-06 14:18:03] License type: FL-II
[2025-12-06 14:18:03] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-06 14:18:03] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-06 14:18:03] Purchase mode: F
[2025-12-06 14:18:03] Next voucher number: 3
[2025-12-06 14:18:03] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-06 14:18:03] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-06 14:18:03] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-06 14:18:03] Suppliers fetched: {
    "count": 36
}
[2025-12-06 14:18:03] Database connection closed
[2025-12-06 14:18:03] === PURCHASE SESSION ENDED ===
[2025-12-06 14:18:14] === NEW PURCHASE SESSION STARTED ===
[2025-12-06 14:18:14] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-12_2025-12-06": true
}
[2025-12-06 14:18:14] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-06 14:18:14] GET data: {
    "mode": "F"
}
[2025-12-06 14:18:14] Company ID from session: 1
[2025-12-06 14:18:14] Database connection included
[2025-12-06 14:18:14] License functions included
[2025-12-06 14:18:14] License type: FL-II
[2025-12-06 14:18:14] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-06 14:18:14] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-06 14:18:14] Purchase mode: F
[2025-12-06 14:18:14] Next voucher number: 3
[2025-12-06 14:18:14] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-06 14:18:14] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-06 14:18:14] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-06 14:18:14] Suppliers fetched: {
    "count": 36
}
[2025-12-06 14:18:14] === FORM SUBMISSION STARTED ===
[2025-12-06 14:18:14] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "3",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-06 14:18:14] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "",
        "FL1249-191125\/4540",
        "3",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-06 14:18:14] Purchase header inserted successfully: {
    "purchase_id": 3,
    "affected_rows": 1
}
[2025-12-06 14:18:14] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-06 14:18:14] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-06 14:18:14] Item 0 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLS0019502"
}
[2025-12-06 14:18:15] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-06 14:18:15] Item 1 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLS0019504"
}
[2025-12-06 14:18:15] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-06 14:18:15] Item 2 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLW0019523"
}
[2025-12-06 14:18:15] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-06 14:18:15] Item 3 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLW0019523"
}
[2025-12-06 14:18:16] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-06 14:18:16] Item 4 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLW0019524"
}
[2025-12-06 14:18:16] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-06 14:18:16] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-06 15:08:31] === NEW PURCHASE SESSION STARTED ===
[2025-12-06 15:08:31] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "auto_transition_2025-12_2025-12-06": true,
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1
}
[2025-12-06 15:08:31] POST data: []
[2025-12-06 15:08:31] GET data: {
    "mode": "F"
}
[2025-12-06 15:08:31] Company ID from session: 1
[2025-12-06 15:08:31] Database connection included
[2025-12-06 15:08:31] License functions included
[2025-12-06 15:08:31] License type: FL-II
[2025-12-06 15:08:31] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-06 15:08:31] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-06 15:08:31] Purchase mode: F
[2025-12-06 15:08:31] Next voucher number: 4
[2025-12-06 15:08:31] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-06 15:08:31] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-06 15:08:31] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-06 15:08:31] Suppliers fetched: {
    "count": 36
}
[2025-12-06 15:08:31] Database connection closed
[2025-12-06 15:08:31] === PURCHASE SESSION ENDED ===
[2025-12-06 15:42:45] === NEW PURCHASE SESSION STARTED ===
[2025-12-06 15:42:45] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-06 15:42:45] POST data: []
[2025-12-06 15:42:45] GET data: {
    "mode": "F"
}
[2025-12-06 15:42:45] Company ID from session: 1
[2025-12-06 15:42:45] Database connection included
[2025-12-06 15:42:45] License functions included
[2025-12-06 15:42:45] License type: FL-II
[2025-12-06 15:42:45] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-06 15:42:45] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-06 15:42:45] Purchase mode: F
[2025-12-06 15:42:45] Next voucher number: 4
[2025-12-06 15:42:45] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-06 15:42:45] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-06 15:42:45] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-06 15:42:45] Suppliers fetched: {
    "count": 36
}
[2025-12-06 15:42:45] Database connection closed
[2025-12-06 15:42:45] === PURCHASE SESSION ENDED ===
[2025-12-07 06:22:07] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 06:22:07] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 06:22:07] POST data: []
[2025-12-07 06:22:07] GET data: {
    "mode": "F"
}
[2025-12-07 06:22:07] Company ID from session: 1
[2025-12-07 06:22:07] Database connection included
[2025-12-07 06:22:07] License functions included
[2025-12-07 06:22:07] License type: FL-II
[2025-12-07 06:22:07] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 06:22:07] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 06:22:07] Purchase mode: F
[2025-12-07 06:22:07] Next voucher number: 4
[2025-12-07 06:22:07] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 06:22:07] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 06:22:07] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 06:22:07] Suppliers fetched: {
    "count": 36
}
[2025-12-07 06:22:07] Database connection closed
[2025-12-07 06:22:07] === PURCHASE SESSION ENDED ===
[2025-12-07 07:05:10] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:05:10] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:05:10] POST data: []
[2025-12-07 07:05:10] GET data: {
    "mode": "F"
}
[2025-12-07 07:05:10] Company ID from session: 1
[2025-12-07 07:05:11] Database connection included
[2025-12-07 07:05:11] License functions included
[2025-12-07 07:05:11] License type: FL-II
[2025-12-07 07:05:11] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:05:11] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:05:11] Purchase mode: F
[2025-12-07 07:05:11] Next voucher number: 1
[2025-12-07 07:05:11] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:05:11] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:05:11] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:05:11] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:05:11] Database connection closed
[2025-12-07 07:05:11] === PURCHASE SESSION ENDED ===
[2025-12-07 07:05:40] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:05:40] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:05:40] POST data: []
[2025-12-07 07:05:40] GET data: {
    "mode": "F"
}
[2025-12-07 07:05:40] Company ID from session: 1
[2025-12-07 07:05:40] Database connection included
[2025-12-07 07:05:40] License functions included
[2025-12-07 07:05:40] License type: FL-II
[2025-12-07 07:05:40] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:05:40] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:05:40] Purchase mode: F
[2025-12-07 07:05:40] Next voucher number: 1
[2025-12-07 07:05:40] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:05:40] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:05:40] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:05:40] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:05:40] Database connection closed
[2025-12-07 07:05:40] === PURCHASE SESSION ENDED ===
[2025-12-07 07:06:06] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:06:06] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:06:06] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-17",
    "auto_tp_no": "FL1249-171125\/4483",
    "tp_no": "4508",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMPL0010075",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "1784",
            "auto_batch": "BTP28-011025\/1784",
            "mfg_month": "Oct-2025",
            "bl": "45",
            "vv": "25",
            "tot_bott": "500",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "140"
        },
        {
            "code": "SCMPL0010076",
            "name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "1342",
            "auto_batch": "BTP28-080825\/1341",
            "mfg_month": "Aug-2025",
            "bl": "45",
            "vv": "25",
            "tot_bott": "500",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "120"
        },
        {
            "code": "SCMPL0010087",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2149",
            "auto_batch": "BTP28-081125\/2149",
            "mfg_month": "Nov-2025",
            "bl": "172.8",
            "vv": "25",
            "tot_bott": "960",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "20",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0010111",
            "name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "2019",
            "auto_batch": "BTP28-261025\/2019",
            "mfg_month": "Oct-2025",
            "bl": "18",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "440"
        },
        {
            "code": "SCMPL0010095",
            "name": "Seagram\\'s Blenders Pride Reserve Collection Whisk",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2075",
            "auto_batch": "BTP28-031125\/2075",
            "mfg_month": "Nov-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "420"
        },
        {
            "code": "SCMPL0010701",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "1035",
            "auto_batch": "BTP28-080725\/1035",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "190"
        },
        {
            "code": "SCMPL0035191",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "2000 ML Pet (6)",
            "bottles_per_case": "6",
            "batch_no": "1638",
            "auto_batch": "BTP28-170925\/1638",
            "mfg_month": "Sep-2025",
            "bl": "24",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2800"
        },
        {
            "code": "SCMPL0031624",
            "name": "Seagram\\'s Royal Stag Barrel Select Whisky .",
            "size": "2000 ML Pet (6)",
            "bottles_per_case": "6",
            "batch_no": "1588",
            "auto_batch": "BTP28-100925\/1588",
            "mfg_month": "Sep-2025",
            "bl": "12",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "3200"
        },
        {
            "code": "SCMPL0010704",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "0396",
            "auto_batch": "BTP28-110525\/396",
            "mfg_month": "May-2025",
            "bl": "18",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1450"
        },
        {
            "code": "SCMPL0010702",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2139",
            "auto_batch": "BTP28-071125\/2139",
            "mfg_month": "Nov-2025",
            "bl": "25.92",
            "vv": "25",
            "tot_bott": "144",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "380"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "21120.00",
    "tamt": "21120.00"
}
[2025-12-07 07:06:06] GET data: {
    "mode": "F"
}
[2025-12-07 07:06:06] Company ID from session: 1
[2025-12-07 07:06:06] Database connection included
[2025-12-07 07:06:06] License functions included
[2025-12-07 07:06:06] License type: FL-II
[2025-12-07 07:06:06] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:06:06] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:06:06] Purchase mode: F
[2025-12-07 07:06:06] Next voucher number: 1
[2025-12-07 07:06:06] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:06:06] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:06:06] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:06:06] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:06:06] === FORM SUBMISSION STARTED ===
[2025-12-07 07:06:06] Form data extracted: {
    "date": "2025-11-17",
    "voc_no": "1",
    "auto_tp_no": "FL1249-171125\/4483",
    "tp_no": "4508",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "basic_amt": "21120.00",
    "total_amt": "21120.00"
}
[2025-12-07 07:06:06] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-17",
        "",
        "FL1249-171125\/4483",
        "1",
        "",
        "",
        "21120.00",
        "4508",
        "2025-11-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-07 07:06:06] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-07 07:06:06] Starting to process purchase items: {
    "item_count": 10
}
[2025-12-07 07:06:06] Processing item 0: {
    "item_code": "SCMPL0010075",
    "item_name": "Seagram\\'s Royal Stag Deluxe Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 500,
    "bl": 45
}
[2025-12-07 07:06:06] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010075"
}
[2025-12-07 07:06:06] Processing item 1: {
    "item_code": "SCMPL0010076",
    "item_name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 400,
    "tot_bott": 500,
    "bl": 45
}
[2025-12-07 07:06:06] Item 1 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010076"
}
[2025-12-07 07:06:07] Processing item 2: {
    "item_code": "SCMPL0010087",
    "item_name": "Seagram\\'s Royal Stag Deluxe Whisky .",
    "cases": 20,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 16000,
    "tot_bott": 960,
    "bl": 172.8
}
[2025-12-07 07:06:07] Item 2 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010087"
}
[2025-12-07 07:06:07] Processing item 3: {
    "item_code": "SCMPL0010111",
    "item_name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 48,
    "bl": 18
}
[2025-12-07 07:06:07] Item 3 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010111"
}
[2025-12-07 07:06:07] Processing item 4: {
    "item_code": "SCMPL0010095",
    "item_name": "Seagram\\'s Blenders Pride Reserve Collection Whisk",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-12-07 07:06:07] Item 4 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010095"
}
[2025-12-07 07:06:08] Processing item 5: {
    "item_code": "SCMPL0010701",
    "item_name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-12-07 07:06:08] Item 5 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010701"
}
[2025-12-07 07:06:08] Processing item 6: {
    "item_code": "SCMPL0035191",
    "item_name": "Seagram\\'s Royal Stag Deluxe Whisky .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 12,
    "bl": 24
}
[2025-12-07 07:06:08] Item 6 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0035191"
}
[2025-12-07 07:06:09] Processing item 7: {
    "item_code": "SCMPL0031624",
    "item_name": "Seagram\\'s Royal Stag Barrel Select Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 6,
    "bl": 12
}
[2025-12-07 07:06:09] Item 7 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0031624"
}
[2025-12-07 07:06:09] Processing item 8: {
    "item_code": "SCMPL0010704",
    "item_name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 1600,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-07 07:06:09] Item 8 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010704"
}
[2025-12-07 07:06:10] Processing item 9: {
    "item_code": "SCMPL0010702",
    "item_name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 300,
    "tot_bott": 144,
    "bl": 25.92
}
[2025-12-07 07:06:10] Item 9 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0010702"
}
[2025-12-07 07:06:10] Purchase items processing completed: {
    "successful_items": 10,
    "total_items": 10
}
[2025-12-07 07:06:10] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-07 07:09:32] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:09:32] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:09:32] POST data: []
[2025-12-07 07:09:32] GET data: {
    "mode": "F"
}
[2025-12-07 07:09:32] Company ID from session: 1
[2025-12-07 07:09:32] Database connection included
[2025-12-07 07:09:32] License functions included
[2025-12-07 07:09:32] License type: FL-II
[2025-12-07 07:09:32] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:09:32] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:09:32] Purchase mode: F
[2025-12-07 07:09:32] Next voucher number: 2
[2025-12-07 07:09:32] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:09:32] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:09:32] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:09:32] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:09:32] Database connection closed
[2025-12-07 07:09:32] === PURCHASE SESSION ENDED ===
[2025-12-07 07:10:17] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:10:17] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:10:17] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-07 07:10:17] GET data: {
    "mode": "F"
}
[2025-12-07 07:10:17] Company ID from session: 1
[2025-12-07 07:10:17] Database connection included
[2025-12-07 07:10:17] License functions included
[2025-12-07 07:10:17] License type: FL-II
[2025-12-07 07:10:17] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:10:17] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:10:17] Purchase mode: F
[2025-12-07 07:10:17] Next voucher number: 2
[2025-12-07 07:10:17] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:10:17] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:10:17] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:10:17] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:10:17] === FORM SUBMISSION STARTED ===
[2025-12-07 07:10:17] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "2",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-07 07:10:17] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "",
        "FL1249-191125\/4540",
        "2",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-07 07:10:17] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-07 07:10:17] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-07 07:10:17] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-07 07:10:17] Item 0 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMLS0019502"
}
[2025-12-07 07:10:17] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-07 07:10:17] Item 1 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMLS0019504"
}
[2025-12-07 07:10:18] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-07 07:10:18] Item 2 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMLW0019523"
}
[2025-12-07 07:10:18] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-07 07:10:18] Item 3 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMLW0019523"
}
[2025-12-07 07:10:18] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-07 07:10:18] Item 4 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMLW0019524"
}
[2025-12-07 07:10:19] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-07 07:10:19] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-07 07:10:51] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:10:51] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:10:51] POST data: []
[2025-12-07 07:10:51] GET data: {
    "mode": "F"
}
[2025-12-07 07:10:51] Company ID from session: 1
[2025-12-07 07:10:51] Database connection included
[2025-12-07 07:10:51] License functions included
[2025-12-07 07:10:51] License type: FL-II
[2025-12-07 07:10:51] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:10:51] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:10:51] Purchase mode: F
[2025-12-07 07:10:51] Next voucher number: 3
[2025-12-07 07:10:51] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:10:51] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:10:51] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:10:51] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:10:51] Database connection closed
[2025-12-07 07:10:51] === PURCHASE SESSION ENDED ===
[2025-12-07 07:11:21] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:11:21] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:11:21] POST data: []
[2025-12-07 07:11:21] GET data: {
    "mode": "F"
}
[2025-12-07 07:11:21] Company ID from session: 1
[2025-12-07 07:11:21] Database connection included
[2025-12-07 07:11:21] License functions included
[2025-12-07 07:11:21] License type: FL-II
[2025-12-07 07:11:21] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:11:21] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:11:21] Purchase mode: F
[2025-12-07 07:11:21] Next voucher number: 3
[2025-12-07 07:11:21] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:11:21] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:11:21] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:11:21] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:11:21] Database connection closed
[2025-12-07 07:11:21] === PURCHASE SESSION ENDED ===
[2025-12-07 07:14:55] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:14:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:14:55] POST data: []
[2025-12-07 07:14:55] GET data: {
    "mode": "F"
}
[2025-12-07 07:14:55] Company ID from session: 1
[2025-12-07 07:14:55] Database connection included
[2025-12-07 07:14:55] License functions included
[2025-12-07 07:14:55] License type: FL-II
[2025-12-07 07:14:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:14:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:14:55] Purchase mode: F
[2025-12-07 07:14:55] Next voucher number: 3
[2025-12-07 07:14:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:14:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:14:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:14:55] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:14:55] Database connection closed
[2025-12-07 07:14:55] === PURCHASE SESSION ENDED ===
[2025-12-07 07:15:13] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:15:13] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:15:13] POST data: []
[2025-12-07 07:15:13] GET data: {
    "mode": "F"
}
[2025-12-07 07:15:13] Company ID from session: 1
[2025-12-07 07:15:13] Database connection included
[2025-12-07 07:15:13] License functions included
[2025-12-07 07:15:13] License type: FL-II
[2025-12-07 07:15:13] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:15:13] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:15:13] Purchase mode: F
[2025-12-07 07:15:13] Next voucher number: 3
[2025-12-07 07:15:13] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:15:13] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:15:14] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:15:14] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:15:14] Database connection closed
[2025-12-07 07:15:14] === PURCHASE SESSION ENDED ===
[2025-12-07 07:15:22] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:15:22] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:15:22] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-11-19",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "PRITHVIRAJ TRADERS-10",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "246",
            "auto_batch": "BTBL2-071125\/649",
            "mfg_month": "Nov-2025",
            "bl": "195",
            "vv": "8",
            "tot_bott": "300",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "25",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0018627",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "534",
            "auto_batch": "BTBL7-011125\/534",
            "mfg_month": "Nov-2025",
            "bl": "60",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "3500.00",
    "tamt": "3500.00"
}
[2025-12-07 07:15:22] GET data: {
    "mode": "F"
}
[2025-12-07 07:15:22] Company ID from session: 1
[2025-12-07 07:15:22] Database connection included
[2025-12-07 07:15:22] License functions included
[2025-12-07 07:15:22] License type: FL-II
[2025-12-07 07:15:22] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:15:22] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:15:22] Purchase mode: F
[2025-12-07 07:15:22] Next voucher number: 3
[2025-12-07 07:15:22] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:15:22] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:15:22] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:15:22] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:15:22] === FORM SUBMISSION STARTED ===
[2025-12-07 07:15:22] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "3",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "PRITHVIRAJ TRADERS-10",
    "basic_amt": "3500.00",
    "total_amt": "3500.00"
}
[2025-12-07 07:15:22] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "",
        "FL119851-191125\/5139",
        "3",
        "",
        "",
        "3500.00",
        "5139",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-07 07:15:22] Purchase header inserted successfully: {
    "purchase_id": 3,
    "affected_rows": 1
}
[2025-12-07 07:15:22] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-07 07:15:22] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 25,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3000,
    "tot_bott": 300,
    "bl": 195
}
[2025-12-07 07:15:22] Item 0 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMBR0009846"
}
[2025-12-07 07:15:23] Processing item 1: {
    "item_code": "SCMBR0018627",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 120,
    "bl": 60
}
[2025-12-07 07:15:23] Item 1 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMBR0018627"
}
[2025-12-07 07:15:23] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-07 07:15:23] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-07 07:19:31] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:19:31] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:19:31] POST data: []
[2025-12-07 07:19:31] GET data: {
    "mode": "F"
}
[2025-12-07 07:19:31] Company ID from session: 1
[2025-12-07 07:19:31] Database connection included
[2025-12-07 07:19:31] License functions included
[2025-12-07 07:19:31] License type: FL-II
[2025-12-07 07:19:31] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:19:31] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:19:31] Purchase mode: F
[2025-12-07 07:19:31] Next voucher number: 4
[2025-12-07 07:19:31] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:19:31] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-07 07:19:31] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-07 07:19:31] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:19:31] Database connection closed
[2025-12-07 07:19:31] === PURCHASE SESSION ENDED ===
[2025-12-07 07:20:01] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:20:01] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:20:01] POST data: []
[2025-12-07 07:20:01] GET data: []
[2025-12-07 07:20:01] Company ID from session: 1
[2025-12-07 07:20:01] Database connection included
[2025-12-07 07:20:01] License functions included
[2025-12-07 07:20:01] License type: FL-II
[2025-12-07 07:20:01] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:20:01] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:20:01] Purchase mode: F
[2025-12-07 07:20:01] Next voucher number: 4
[2025-12-07 07:20:01] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:20:01] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.LIQ_FLAG = ? AND im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "F",
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssssssssss"
}
[2025-12-07 07:20:01] Items fetched from database: {
    "count": 3607,
    "license_filter_applied": true
}
[2025-12-07 07:20:01] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:20:02] Database connection closed
[2025-12-07 07:20:02] === PURCHASE SESSION ENDED ===
[2025-12-07 07:22:19] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:22:19] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:22:19] POST data: []
[2025-12-07 07:22:19] GET data: []
[2025-12-07 07:22:19] Company ID from session: 1
[2025-12-07 07:22:19] Database connection included
[2025-12-07 07:22:19] License functions included
[2025-12-07 07:22:19] License type: FL-II
[2025-12-07 07:22:19] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:22:19] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:22:19] Purchase mode: F
[2025-12-07 07:22:19] Next voucher number: 4
[2025-12-07 07:22:19] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:22:19] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.LIQ_FLAG = ? AND im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "F",
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssssssssss"
}
[2025-12-07 07:22:19] Items fetched from database: {
    "count": 3607,
    "license_filter_applied": true
}
[2025-12-07 07:22:19] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:22:19] Database connection closed
[2025-12-07 07:22:19] === PURCHASE SESSION ENDED ===
[2025-12-07 07:22:35] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:22:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:22:35] POST data: {
    "mode": "F",
    "voc_no": "4",
    "date": "2025-11-18",
    "auto_tp_no": "FL167-181125\/17082",
    "tp_no": "17081",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "SAMBARAGI TRADERS",
    "supplier_code": "SAMB",
    "items": [
        {
            "code": "SCMPL0029935",
            "name": "Signature Premier Grain Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "015",
            "auto_batch": "BTP4-070225\/1251",
            "mfg_month": "Feb-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMPL0036330",
            "name": "Signature Rare Aged Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "028",
            "auto_batch": "BTP4-010925\/506",
            "mfg_month": "Oct-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "190"
        },
        {
            "code": "SCMPL0040202",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "323",
            "auto_batch": "BTP4-011125\/639",
            "mfg_month": "Nov-2025",
            "bl": "35.1",
            "vv": "25",
            "tot_bott": "195",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "4",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "220"
        },
        {
            "code": "SCMPL0040202",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "326",
            "auto_batch": "BTP4-041125\/651",
            "mfg_month": "Nov-2025",
            "bl": "180.9",
            "vv": "25",
            "tot_bott": "1005",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "20",
            "bottles": "45",
            "case_rate": "120.000",
            "mrp": "220"
        },
        {
            "code": "SCMPL0040198",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "2000 ML Pet (6)",
            "bottles_per_case": "6",
            "batch_no": "297",
            "auto_batch": "BTP4-131025\/587",
            "mfg_month": "Oct-2025",
            "bl": "36",
            "vv": "25",
            "tot_bott": "18",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "2400"
        },
        {
            "code": "SCMPL0040203",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "100",
            "batch_no": "722",
            "auto_batch": "BTP29-151025\/722",
            "mfg_month": "Oct-2025",
            "bl": "90",
            "vv": "25",
            "tot_bott": "1000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "120"
        },
        {
            "code": "SCMPL0040204",
            "name": "McDowell\\'s No.1 Luxury Blended Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "685",
            "auto_batch": "BTP29-041025\/685",
            "mfg_month": "Oct-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "940"
        },
        {
            "code": "SCMPL0040206",
            "name": "McDowell\\'s No.1 Luxury Blended Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "589",
            "auto_batch": "BTP29-280825\/589",
            "mfg_month": "Sep-2025",
            "bl": "25.92",
            "vv": "25",
            "tot_bott": "144",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "230"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "12400.00",
    "tamt": "12400.00"
}
[2025-12-07 07:22:35] GET data: []
[2025-12-07 07:22:35] Company ID from session: 1
[2025-12-07 07:22:35] Database connection included
[2025-12-07 07:22:35] License functions included
[2025-12-07 07:22:35] License type: FL-II
[2025-12-07 07:22:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:22:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:22:35] Purchase mode: F
[2025-12-07 07:22:35] Next voucher number: 4
[2025-12-07 07:22:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:22:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.LIQ_FLAG = ? AND im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "F",
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssssssssss"
}
[2025-12-07 07:22:36] Items fetched from database: {
    "count": 3607,
    "license_filter_applied": true
}
[2025-12-07 07:22:36] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:22:36] === FORM SUBMISSION STARTED ===
[2025-12-07 07:22:36] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "4",
    "auto_tp_no": "FL167-181125\/17082",
    "tp_no": "17081",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "SAMB",
    "supplier_name": "SAMBARAGI TRADERS",
    "basic_amt": "12400.00",
    "total_amt": "12400.00"
}
[2025-12-07 07:22:36] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-18",
        "SAMB",
        "FL167-181125\/17082",
        "4",
        "",
        "",
        "12400.00",
        "17081",
        "2025-11-18",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "F",
        1
    ]
}
[2025-12-07 07:22:36] Purchase header inserted successfully: {
    "purchase_id": 4,
    "affected_rows": 1
}
[2025-12-07 07:22:36] Starting to process purchase items: {
    "item_count": 8
}
[2025-12-07 07:22:36] Processing item 0: {
    "item_code": "SCMPL0029935",
    "item_name": "Signature Premier Grain Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-07 07:22:36] Item 0 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0029935"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0029935",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0029935",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0029935"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        12,
        "2025-11",
        "SCMPL0029935"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0029935",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0029935",
        "2025-11-18",
        12,
        12
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Processing item 1: {
    "item_code": "SCMPL0036330",
    "item_name": "Signature Rare Aged Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 100,
    "bl": 9
}
[2025-12-07 07:22:36] Item 1 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0036330"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0036330",
    "total_bottles": 100,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0036330",
    "total_bottles": 100,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0036330"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        100,
        "2025-11",
        "SCMPL0036330"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0036330",
    "total_bottles": 100,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0036330",
        "2025-11-18",
        100,
        100
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Processing item 2: {
    "item_code": "SCMPL0040202",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 4,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 840,
    "tot_bott": 195,
    "bl": 35.1
}
[2025-12-07 07:22:36] Item 2 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0040202"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0040202",
    "total_bottles": 195,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0040202",
    "total_bottles": 195,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0040202"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        195,
        "2025-11",
        "SCMPL0040202"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0040202",
    "total_bottles": 195,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0040202",
        "2025-11-18",
        195,
        195
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Processing item 3: {
    "item_code": "SCMPL0040202",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 20,
    "bottles": 45,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 7800,
    "tot_bott": 1005,
    "bl": 180.9
}
[2025-12-07 07:22:36] Item 3 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0040202"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0040202",
    "total_bottles": 1005,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0040202",
    "total_bottles": 1005,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0040202"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        1005,
        "2025-11",
        "SCMPL0040202"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0040202",
    "total_bottles": 1005,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0040202",
        "2025-11-18",
        1005,
        1005
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Processing item 4: {
    "item_code": "SCMPL0040198",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 2400,
    "tot_bott": 18,
    "bl": 36
}
[2025-12-07 07:22:36] Item 4 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0040198"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0040198",
    "total_bottles": 18,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0040198",
    "total_bottles": 18,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0040198"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        18,
        "2025-11",
        "SCMPL0040198"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0040198",
    "total_bottles": 18,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0040198",
        "2025-11-18",
        18,
        18
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Processing item 5: {
    "item_code": "SCMPL0040203",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 800,
    "tot_bott": 1000,
    "bl": 90
}
[2025-12-07 07:22:36] Item 5 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0040203"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0040203",
    "total_bottles": 1000,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0040203",
    "total_bottles": 1000,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0040203"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        1000,
        "2025-11",
        "SCMPL0040203"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0040203",
    "total_bottles": 1000,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0040203",
        "2025-11-18",
        1000,
        1000
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Processing item 6: {
    "item_code": "SCMPL0040204",
    "item_name": "McDowell\\'s No.1 Luxury Blended Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-07 07:22:36] Item 6 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0040204"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0040204",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0040204",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0040204"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        12,
        "2025-11",
        "SCMPL0040204"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0040204",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0040204",
        "2025-11-18",
        12,
        12
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Processing item 7: {
    "item_code": "SCMPL0040206",
    "item_name": "McDowell\\'s No.1 Luxury Blended Whisky .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 240,
    "tot_bott": 144,
    "bl": 25.92
}
[2025-12-07 07:22:36] Item 7 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMPL0040206"
}
[2025-12-07 07:22:36] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMPL0040206",
    "total_bottles": 144,
    "purchase_date": "2025-11-18",
    "company_id": 1
}
[2025-12-07 07:22:36] Date analysis: {
    "day_of_month": "18",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:22:36] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:22:36] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:22:36] Archive status: 1
[2025-12-07 07:22:36] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMPL0040206",
    "total_bottles": 144,
    "purchase_date": "2025-11-18",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_18_PURCHASE"
}
[2025-12-07 07:22:36] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMPL0040206"
}
[2025-12-07 07:22:36] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_18_PURCHASE = DAY_18_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        144,
        "2025-11",
        "SCMPL0040206"
    ]
}
[2025-12-07 07:22:36] Updating item stock: {
    "item_code": "SCMPL0040206",
    "total_bottles": 144,
    "purchase_date": "2025-11-18",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:22:36] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMPL0040206",
        "2025-11-18",
        144,
        144
    ]
}
[2025-12-07 07:22:36] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:22:36] Purchase items processing completed: {
    "successful_items": 8,
    "total_items": 8
}
[2025-12-07 07:22:36] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-07 07:23:23] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:23:23] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:23:23] POST data: []
[2025-12-07 07:23:23] GET data: []
[2025-12-07 07:23:23] Company ID from session: 1
[2025-12-07 07:23:23] Database connection included
[2025-12-07 07:23:23] License functions included
[2025-12-07 07:23:23] License type: FL-II
[2025-12-07 07:23:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:23:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:23:23] Purchase mode: F
[2025-12-07 07:23:23] Next voucher number: 5
[2025-12-07 07:23:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:23:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.LIQ_FLAG = ? AND im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "F",
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssssssssss"
}
[2025-12-07 07:23:23] Items fetched from database: {
    "count": 3607,
    "license_filter_applied": true
}
[2025-12-07 07:23:23] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:23:23] Database connection closed
[2025-12-07 07:23:23] === PURCHASE SESSION ENDED ===
[2025-12-07 07:23:46] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:23:46] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:23:46] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-07 07:23:46] GET data: []
[2025-12-07 07:23:46] Company ID from session: 1
[2025-12-07 07:23:46] Database connection included
[2025-12-07 07:23:46] License functions included
[2025-12-07 07:23:46] License type: FL-II
[2025-12-07 07:23:46] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:23:46] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:23:46] Purchase mode: F
[2025-12-07 07:23:46] Next voucher number: 5
[2025-12-07 07:23:46] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:23:46] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.LIQ_FLAG = ? AND im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "F",
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssssssssss"
}
[2025-12-07 07:23:46] Items fetched from database: {
    "count": 3607,
    "license_filter_applied": true
}
[2025-12-07 07:23:46] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:23:46] === FORM SUBMISSION STARTED ===
[2025-12-07 07:23:46] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "5",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-07 07:23:46] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "",
        "FL1249-191125\/4540",
        "5",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "F",
        1
    ]
}
[2025-12-07 07:23:46] Purchase header inserted successfully: {
    "purchase_id": 5,
    "affected_rows": 1
}
[2025-12-07 07:23:46] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-07 07:23:46] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-07 07:23:46] Item 0 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMLS0019502"
}
[2025-12-07 07:23:46] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMLS0019502",
    "total_bottles": 120,
    "purchase_date": "2025-11-19",
    "company_id": 1
}
[2025-12-07 07:23:46] Date analysis: {
    "day_of_month": "19",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:23:46] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:23:46] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:23:46] Archive status: 1
[2025-12-07 07:23:46] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMLS0019502",
    "total_bottles": 120,
    "purchase_date": "2025-11-19",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_19_PURCHASE"
}
[2025-12-07 07:23:46] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMLS0019502"
}
[2025-12-07 07:23:46] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_19_PURCHASE = DAY_19_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        120,
        "2025-11",
        "SCMLS0019502"
    ]
}
[2025-12-07 07:23:46] Updating item stock: {
    "item_code": "SCMLS0019502",
    "total_bottles": 120,
    "purchase_date": "2025-11-19",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:23:46] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMLS0019502",
        "2025-11-19",
        120,
        120
    ]
}
[2025-12-07 07:23:46] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:23:46] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-07 07:23:46] Item 1 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMLS0019504"
}
[2025-12-07 07:23:46] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMLS0019504",
    "total_bottles": 24,
    "purchase_date": "2025-11-19",
    "company_id": 1
}
[2025-12-07 07:23:46] Date analysis: {
    "day_of_month": "19",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:23:46] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:23:46] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:23:46] Archive status: 1
[2025-12-07 07:23:46] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMLS0019504",
    "total_bottles": 24,
    "purchase_date": "2025-11-19",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_19_PURCHASE"
}
[2025-12-07 07:23:46] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMLS0019504"
}
[2025-12-07 07:23:46] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_19_PURCHASE = DAY_19_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        24,
        "2025-11",
        "SCMLS0019504"
    ]
}
[2025-12-07 07:23:46] Updating item stock: {
    "item_code": "SCMLS0019504",
    "total_bottles": 24,
    "purchase_date": "2025-11-19",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:23:46] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMLS0019504",
        "2025-11-19",
        24,
        24
    ]
}
[2025-12-07 07:23:46] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:23:46] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-07 07:23:46] Item 2 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMLW0019523"
}
[2025-12-07 07:23:46] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMLW0019523",
    "total_bottles": 9,
    "purchase_date": "2025-11-19",
    "company_id": 1
}
[2025-12-07 07:23:46] Date analysis: {
    "day_of_month": "19",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:23:46] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:23:46] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:23:46] Archive status: 1
[2025-12-07 07:23:46] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMLW0019523",
    "total_bottles": 9,
    "purchase_date": "2025-11-19",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_19_PURCHASE"
}
[2025-12-07 07:23:46] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMLW0019523"
}
[2025-12-07 07:23:46] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_19_PURCHASE = DAY_19_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        9,
        "2025-11",
        "SCMLW0019523"
    ]
}
[2025-12-07 07:23:46] Updating item stock: {
    "item_code": "SCMLW0019523",
    "total_bottles": 9,
    "purchase_date": "2025-11-19",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:23:46] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMLW0019523",
        "2025-11-19",
        9,
        9
    ]
}
[2025-12-07 07:23:46] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:23:46] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-07 07:23:46] Item 3 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMLW0019523"
}
[2025-12-07 07:23:46] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMLW0019523",
    "total_bottles": 3,
    "purchase_date": "2025-11-19",
    "company_id": 1
}
[2025-12-07 07:23:46] Date analysis: {
    "day_of_month": "19",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:23:46] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:23:46] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:23:46] Archive status: 1
[2025-12-07 07:23:46] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMLW0019523",
    "total_bottles": 3,
    "purchase_date": "2025-11-19",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_19_PURCHASE"
}
[2025-12-07 07:23:46] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMLW0019523"
}
[2025-12-07 07:23:46] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_19_PURCHASE = DAY_19_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        3,
        "2025-11",
        "SCMLW0019523"
    ]
}
[2025-12-07 07:23:46] Updating item stock: {
    "item_code": "SCMLW0019523",
    "total_bottles": 3,
    "purchase_date": "2025-11-19",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:23:46] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMLW0019523",
        "2025-11-19",
        3,
        3
    ]
}
[2025-12-07 07:23:46] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:23:46] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-07 07:23:46] Item 4 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMLW0019524"
}
[2025-12-07 07:23:46] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMLW0019524",
    "total_bottles": 12,
    "purchase_date": "2025-11-19",
    "company_id": 1
}
[2025-12-07 07:23:46] Date analysis: {
    "day_of_month": "19",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:23:46] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:23:46] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:23:46] Archive status: 1
[2025-12-07 07:23:46] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMLW0019524",
    "total_bottles": 12,
    "purchase_date": "2025-11-19",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_19_PURCHASE"
}
[2025-12-07 07:23:46] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMLW0019524"
}
[2025-12-07 07:23:46] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_19_PURCHASE = DAY_19_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        12,
        "2025-11",
        "SCMLW0019524"
    ]
}
[2025-12-07 07:23:46] Updating item stock: {
    "item_code": "SCMLW0019524",
    "total_bottles": 12,
    "purchase_date": "2025-11-19",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:23:46] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMLW0019524",
        "2025-11-19",
        12,
        12
    ]
}
[2025-12-07 07:23:46] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:23:46] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-07 07:23:46] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-07 07:24:42] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:24:42] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:24:42] POST data: []
[2025-12-07 07:24:42] GET data: []
[2025-12-07 07:24:42] Company ID from session: 1
[2025-12-07 07:24:42] Database connection included
[2025-12-07 07:24:42] License functions included
[2025-12-07 07:24:42] License type: FL-II
[2025-12-07 07:24:42] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:24:42] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:24:42] Purchase mode: F
[2025-12-07 07:24:42] Next voucher number: 6
[2025-12-07 07:24:42] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:24:42] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.LIQ_FLAG = ? AND im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "F",
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssssssssss"
}
[2025-12-07 07:24:42] Items fetched from database: {
    "count": 3607,
    "license_filter_applied": true
}
[2025-12-07 07:24:42] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:24:42] Database connection closed
[2025-12-07 07:24:42] === PURCHASE SESSION ENDED ===
[2025-12-07 07:24:54] === NEW PURCHASE SESSION STARTED ===
[2025-12-07 07:24:54] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-07 07:24:54] POST data: {
    "mode": "F",
    "voc_no": "6",
    "date": "2025-11-19",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "PRITHVIRAJ TRADERS-10",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "246",
            "auto_batch": "BTBL2-071125\/649",
            "mfg_month": "Nov-2025",
            "bl": "195",
            "vv": "8",
            "tot_bott": "300",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "25",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0018627",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "534",
            "auto_batch": "BTBL7-011125\/534",
            "mfg_month": "Nov-2025",
            "bl": "60",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "3500.00",
    "tamt": "3500.00"
}
[2025-12-07 07:24:54] GET data: []
[2025-12-07 07:24:54] Company ID from session: 1
[2025-12-07 07:24:54] Database connection included
[2025-12-07 07:24:54] License functions included
[2025-12-07 07:24:54] License type: FL-II
[2025-12-07 07:24:54] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-07 07:24:54] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-07 07:24:54] Purchase mode: F
[2025-12-07 07:24:54] Next voucher number: 6
[2025-12-07 07:24:54] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-07 07:24:54] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.LIQ_FLAG = ? AND im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "F",
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssssssssss"
}
[2025-12-07 07:24:54] Items fetched from database: {
    "count": 3607,
    "license_filter_applied": true
}
[2025-12-07 07:24:54] Suppliers fetched: {
    "count": 36
}
[2025-12-07 07:24:54] === FORM SUBMISSION STARTED ===
[2025-12-07 07:24:54] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "6",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "PRITHVIRAJ TRADERS-10",
    "basic_amt": "3500.00",
    "total_amt": "3500.00"
}
[2025-12-07 07:24:54] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "",
        "FL119851-191125\/5139",
        "6",
        "",
        "",
        "3500.00",
        "5139",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "F",
        1
    ]
}
[2025-12-07 07:24:54] Purchase header inserted successfully: {
    "purchase_id": 6,
    "affected_rows": 1
}
[2025-12-07 07:24:54] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-07 07:24:54] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 25,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3000,
    "tot_bott": 300,
    "bl": 195
}
[2025-12-07 07:24:54] Item 0 inserted successfully: {
    "purchase_id": 6,
    "item_code": "SCMBR0009846"
}
[2025-12-07 07:24:54] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMBR0009846",
    "total_bottles": 300,
    "purchase_date": "2025-11-19",
    "company_id": 1
}
[2025-12-07 07:24:54] Date analysis: {
    "day_of_month": "19",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:24:54] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:24:54] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:24:54] Archive status: 1
[2025-12-07 07:24:54] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMBR0009846",
    "total_bottles": 300,
    "purchase_date": "2025-11-19",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_19_PURCHASE"
}
[2025-12-07 07:24:54] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMBR0009846"
}
[2025-12-07 07:24:54] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_19_PURCHASE = DAY_19_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        300,
        "2025-11",
        "SCMBR0009846"
    ]
}
[2025-12-07 07:24:54] Updating item stock: {
    "item_code": "SCMBR0009846",
    "total_bottles": 300,
    "purchase_date": "2025-11-19",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:24:54] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMBR0009846",
        "2025-11-19",
        300,
        300
    ]
}
[2025-12-07 07:24:54] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:24:54] Processing item 1: {
    "item_code": "SCMBR0018627",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 120,
    "bl": 60
}
[2025-12-07 07:24:54] Item 1 inserted successfully: {
    "purchase_id": 6,
    "item_code": "SCMBR0018627"
}
[2025-12-07 07:24:54] === STOCK UPDATE STARTED ===: {
    "item_code": "SCMBR0018627",
    "total_bottles": 120,
    "purchase_date": "2025-11-19",
    "company_id": 1
}
[2025-12-07 07:24:54] Date analysis: {
    "day_of_month": "19",
    "month": "11",
    "year": "2025",
    "month_year": "2025-11"
}
[2025-12-07 07:24:54] Checking if month is archived: {
    "company_id": 1,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_1_11_25"
}
[2025-12-07 07:24:54] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_1_11_25'"
}
[2025-12-07 07:24:54] Archive status: 1
[2025-12-07 07:24:54] Updating archived month stock: {
    "company_id": 1,
    "item_code": "SCMBR0018627",
    "total_bottles": 120,
    "purchase_date": "2025-11-19",
    "archive_table": "tbldailystock_1_11_25",
    "purchase_column": "DAY_19_PURCHASE"
}
[2025-12-07 07:24:54] Archive record check: {
    "exists": true,
    "month_year": "2025-11",
    "item_code": "SCMBR0018627"
}
[2025-12-07 07:24:54] Archive record updated: {
    "success": true,
    "query": "UPDATE tbldailystock_1_11_25 \n                        SET DAY_19_PURCHASE = DAY_19_PURCHASE + ? \n                        WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "parameters": [
        120,
        "2025-11",
        "SCMBR0018627"
    ]
}
[2025-12-07 07:24:54] Updating item stock: {
    "item_code": "SCMBR0018627",
    "total_bottles": 120,
    "purchase_date": "2025-11-19",
    "company_id": 1,
    "stock_column": "CURRENT_STOCK1"
}
[2025-12-07 07:24:54] Item stock update result: {
    "success": true,
    "query": "INSERT INTO tblitem_stock (ITEM_CODE, FIN_YEAR, CURRENT_STOCK1) \n                             VALUES (?, YEAR(?), ?) \n                             ON DUPLICATE KEY UPDATE CURRENT_STOCK1 = CURRENT_STOCK1 + ?",
    "parameters": [
        "SCMBR0018627",
        "2025-11-19",
        120,
        120
    ]
}
[2025-12-07 07:24:54] === STOCK UPDATE COMPLETED ===
[2025-12-07 07:24:54] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-07 07:24:54] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-08 06:28:19] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:28:19] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:28:19] POST data: []
[2025-12-08 06:28:19] GET data: {
    "mode": "F"
}
[2025-12-08 06:28:19] Company ID from session: 1
[2025-12-08 06:28:19] Database connection included
[2025-12-08 06:28:19] License functions included
[2025-12-08 06:28:19] License type: FL-II
[2025-12-08 06:28:19] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:28:19] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:28:19] Purchase mode: F
[2025-12-08 06:28:19] Next voucher number: 6
[2025-12-08 06:28:19] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:28:19] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:28:19] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:28:19] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:28:19] Database connection closed
[2025-12-08 06:28:19] === PURCHASE SESSION ENDED ===
[2025-12-08 06:33:39] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:33:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:33:39] POST data: {
    "mode": "F",
    "voc_no": "6",
    "date": "2025-12-01",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-08 06:33:39] GET data: {
    "mode": "F"
}
[2025-12-08 06:33:39] Company ID from session: 1
[2025-12-08 06:33:39] Database connection included
[2025-12-08 06:33:39] License functions included
[2025-12-08 06:33:39] License type: FL-II
[2025-12-08 06:33:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:33:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:33:39] Purchase mode: F
[2025-12-08 06:33:39] Next voucher number: 6
[2025-12-08 06:33:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:33:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:33:39] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:33:39] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:33:39] === FORM SUBMISSION STARTED ===
[2025-12-08 06:33:39] Form data extracted: {
    "date": "2025-12-01",
    "voc_no": "6",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "EMPIRE SPIRIT INDIA-07",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-08 06:33:39] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-01",
        "",
        "FL1249-191125\/4540",
        "6",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-08 06:33:39] Purchase header inserted successfully: {
    "purchase_id": 7,
    "affected_rows": 1
}
[2025-12-08 06:33:39] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-08 06:33:39] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-08 06:33:39] Item 0 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMLS0019502"
}
[2025-12-08 06:33:40] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-08 06:33:40] Item 1 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMLS0019504"
}
[2025-12-08 06:33:40] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-08 06:33:40] Item 2 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMLW0019523"
}
[2025-12-08 06:33:40] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-08 06:33:40] Item 3 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMLW0019523"
}
[2025-12-08 06:33:40] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-08 06:33:40] Item 4 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMLW0019524"
}
[2025-12-08 06:33:41] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-08 06:33:41] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-08 06:35:11] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:35:11] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:35:11] POST data: []
[2025-12-08 06:35:11] GET data: {
    "mode": "F"
}
[2025-12-08 06:35:11] Company ID from session: 1
[2025-12-08 06:35:11] Database connection included
[2025-12-08 06:35:11] License functions included
[2025-12-08 06:35:11] License type: FL-II
[2025-12-08 06:35:11] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:35:11] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:35:11] Purchase mode: F
[2025-12-08 06:35:11] Next voucher number: 7
[2025-12-08 06:35:11] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:35:11] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:35:11] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:35:11] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:35:11] Database connection closed
[2025-12-08 06:35:11] === PURCHASE SESSION ENDED ===
[2025-12-08 06:45:21] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:45:21] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:45:21] POST data: []
[2025-12-08 06:45:21] GET data: {
    "mode": "F"
}
[2025-12-08 06:45:21] Company ID from session: 1
[2025-12-08 06:45:21] Database connection included
[2025-12-08 06:45:21] License functions included
[2025-12-08 06:45:21] License type: FL-II
[2025-12-08 06:45:21] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:45:21] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:45:21] Purchase mode: F
[2025-12-08 06:45:21] Next voucher number: 5
[2025-12-08 06:45:21] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:45:21] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:45:21] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:45:21] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:45:22] Database connection closed
[2025-12-08 06:45:22] === PURCHASE SESSION ENDED ===
[2025-12-08 06:45:33] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:45:33] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:45:33] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-08 06:45:33] GET data: {
    "mode": "F"
}
[2025-12-08 06:45:33] Company ID from session: 1
[2025-12-08 06:45:33] Database connection included
[2025-12-08 06:45:33] License functions included
[2025-12-08 06:45:33] License type: FL-II
[2025-12-08 06:45:33] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:45:33] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:45:33] Purchase mode: F
[2025-12-08 06:45:33] Next voucher number: 5
[2025-12-08 06:45:33] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:45:33] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:45:33] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:45:33] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:45:33] === FORM SUBMISSION STARTED ===
[2025-12-08 06:45:33] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "5",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-08 06:45:33] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "EM2",
        "FL1249-191125\/4540",
        "5",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-08 06:45:33] Purchase header inserted successfully: {
    "purchase_id": 10,
    "affected_rows": 1
}
[2025-12-08 06:45:33] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-08 06:45:33] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-08 06:45:33] Item 0 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMLS0019502"
}
[2025-12-08 06:45:33] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-08 06:45:33] Item 1 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMLS0019504"
}
[2025-12-08 06:45:34] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-08 06:45:34] Item 2 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMLW0019523"
}
[2025-12-08 06:45:34] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-08 06:45:34] Item 3 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMLW0019523"
}
[2025-12-08 06:45:34] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-08 06:45:34] Item 4 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMLW0019524"
}
[2025-12-08 06:45:35] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-08 06:45:35] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-08 06:46:50] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:46:50] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:46:50] POST data: []
[2025-12-08 06:46:50] GET data: {
    "mode": "F"
}
[2025-12-08 06:46:50] Company ID from session: 1
[2025-12-08 06:46:50] Database connection included
[2025-12-08 06:46:50] License functions included
[2025-12-08 06:46:50] License type: FL-II
[2025-12-08 06:46:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:46:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:46:50] Purchase mode: F
[2025-12-08 06:46:50] Next voucher number: 1
[2025-12-08 06:46:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:46:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:46:50] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:46:50] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:46:50] Database connection closed
[2025-12-08 06:46:50] === PURCHASE SESSION ENDED ===
[2025-12-08 06:47:36] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:47:36] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:47:36] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-08 06:47:36] GET data: {
    "mode": "F"
}
[2025-12-08 06:47:36] Company ID from session: 1
[2025-12-08 06:47:36] Database connection included
[2025-12-08 06:47:36] License functions included
[2025-12-08 06:47:36] License type: FL-II
[2025-12-08 06:47:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:47:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:47:36] Purchase mode: F
[2025-12-08 06:47:36] Next voucher number: 1
[2025-12-08 06:47:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:47:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:47:36] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:47:36] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:47:36] === FORM SUBMISSION STARTED ===
[2025-12-08 06:47:36] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "1",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-08 06:47:36] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "EM2",
        "FL1249-191125\/4540",
        "1",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-08 06:47:36] Purchase header inserted successfully: {
    "purchase_id": 11,
    "affected_rows": 1
}
[2025-12-08 06:47:36] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-08 06:47:36] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-08 06:47:36] Item 0 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLS0019502"
}
[2025-12-08 06:47:37] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-08 06:47:37] Item 1 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLS0019504"
}
[2025-12-08 06:47:37] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-08 06:47:37] Item 2 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLW0019523"
}
[2025-12-08 06:47:38] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-08 06:47:38] Item 3 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLW0019523"
}
[2025-12-08 06:47:38] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-08 06:47:38] Item 4 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLW0019524"
}
[2025-12-08 06:47:38] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-08 06:47:38] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-08 06:55:06] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:55:06] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:55:06] POST data: []
[2025-12-08 06:55:06] GET data: {
    "mode": "F"
}
[2025-12-08 06:55:06] Company ID from session: 1
[2025-12-08 06:55:06] Database connection included
[2025-12-08 06:55:06] License functions included
[2025-12-08 06:55:06] License type: FL-II
[2025-12-08 06:55:06] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:55:06] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:55:06] Purchase mode: F
[2025-12-08 06:55:06] Next voucher number: 2
[2025-12-08 06:55:06] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:55:06] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:55:06] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:55:06] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:55:06] Database connection closed
[2025-12-08 06:55:06] === PURCHASE SESSION ENDED ===
[2025-12-08 06:57:31] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:57:31] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:57:31] POST data: []
[2025-12-08 06:57:31] GET data: {
    "mode": "F"
}
[2025-12-08 06:57:31] Company ID from session: 1
[2025-12-08 06:57:31] Database connection included
[2025-12-08 06:57:31] License functions included
[2025-12-08 06:57:31] License type: FL-II
[2025-12-08 06:57:31] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:57:31] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:57:31] Purchase mode: F
[2025-12-08 06:57:31] Next voucher number: 2
[2025-12-08 06:57:31] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:57:31] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:57:31] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:57:31] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:57:31] Database connection closed
[2025-12-08 06:57:31] === PURCHASE SESSION ENDED ===
[2025-12-08 06:59:38] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:59:38] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:59:38] POST data: []
[2025-12-08 06:59:38] GET data: {
    "mode": "F"
}
[2025-12-08 06:59:38] Company ID from session: 1
[2025-12-08 06:59:38] Database connection included
[2025-12-08 06:59:38] License functions included
[2025-12-08 06:59:38] License type: FL-II
[2025-12-08 06:59:38] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:59:38] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:59:38] Purchase mode: F
[2025-12-08 06:59:38] Next voucher number: 2
[2025-12-08 06:59:38] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:59:38] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:59:38] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:59:38] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:59:38] Database connection closed
[2025-12-08 06:59:38] === PURCHASE SESSION ENDED ===
[2025-12-08 06:59:54] === NEW PURCHASE SESSION STARTED ===
[2025-12-08 06:59:54] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-08 06:59:54] POST data: []
[2025-12-08 06:59:54] GET data: {
    "mode": "F"
}
[2025-12-08 06:59:54] Company ID from session: 1
[2025-12-08 06:59:54] Database connection included
[2025-12-08 06:59:54] License functions included
[2025-12-08 06:59:54] License type: FL-II
[2025-12-08 06:59:54] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-08 06:59:54] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-08 06:59:54] Purchase mode: F
[2025-12-08 06:59:54] Next voucher number: 2
[2025-12-08 06:59:54] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-08 06:59:54] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-08 06:59:54] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-08 06:59:54] Suppliers fetched: {
    "count": 36
}
[2025-12-08 06:59:54] Database connection closed
[2025-12-08 06:59:54] === PURCHASE SESSION ENDED ===
[2025-12-09 13:45:39] === NEW PURCHASE SESSION STARTED ===
[2025-12-09 13:45:39] === NEW PURCHASE SESSION STARTED ===
[2025-12-09 13:45:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1,
    "last_scanned_item": "8902967215218",
    "last_scan_time": 1765282644
}
[2025-12-09 13:45:39] POST data: []
[2025-12-09 13:45:39] GET data: {
    "mode": "F"
}
[2025-12-09 13:45:39] Company ID from session: 1
[2025-12-09 13:45:39] Database connection included
[2025-12-09 13:45:39] License functions included
[2025-12-09 13:45:39] License type: FL-II
[2025-12-09 13:45:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-09 13:45:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-09 13:45:39] Purchase mode: F
[2025-12-09 13:45:39] Next voucher number: 2
[2025-12-09 13:45:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-09 13:45:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-09 13:45:39] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-09 13:45:39] Suppliers fetched: {
    "count": 36
}
[2025-12-09 13:45:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1,
    "last_scanned_item": "8902967215218",
    "last_scan_time": 1765282644
}
[2025-12-09 13:45:39] POST data: []
[2025-12-09 13:45:39] GET data: {
    "mode": "F"
}
[2025-12-09 13:45:39] Company ID from session: 1
[2025-12-09 13:45:39] Database connection included
[2025-12-09 13:45:39] License functions included
[2025-12-09 13:45:39] License type: FL-II
[2025-12-09 13:45:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-09 13:45:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-09 13:45:39] Purchase mode: F
[2025-12-09 13:45:39] Next voucher number: 2
[2025-12-09 13:45:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-09 13:45:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-09 13:45:40] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-09 13:45:40] Suppliers fetched: {
    "count": 36
}
[2025-12-09 13:45:40] Database connection closed
[2025-12-09 13:45:40] === PURCHASE SESSION ENDED ===
[2025-12-09 13:47:26] === NEW PURCHASE SESSION STARTED ===
[2025-12-09 13:47:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1,
    "last_scanned_item": "8902967215218",
    "last_scan_time": 1765282644
}
[2025-12-09 13:47:26] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-12-09",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-09",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": {
        "0": {
            "code": "SCMBR0041385",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "330 ML(12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        },
        "2": {
            "code": "SCMBR0031824",
            "name": "Bira 91 Superfresh Natural White Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "12",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    },
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1320.00",
    "tamt": "1320.00"
}
[2025-12-09 13:47:26] GET data: {
    "mode": "F"
}
[2025-12-09 13:47:26] Company ID from session: 1
[2025-12-09 13:47:26] Database connection included
[2025-12-09 13:47:26] License functions included
[2025-12-09 13:47:26] License type: FL-II
[2025-12-09 13:47:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-09 13:47:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-09 13:47:26] Purchase mode: F
[2025-12-09 13:47:26] Next voucher number: 2
[2025-12-09 13:47:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-09 13:47:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-09 13:47:26] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-09 13:47:26] Suppliers fetched: {
    "count": 36
}
[2025-12-09 13:47:26] === FORM SUBMISSION STARTED ===
[2025-12-09 13:47:26] Form data extracted: {
    "date": "2025-12-09",
    "voc_no": "2",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-09",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "1320.00",
    "total_amt": "1320.00"
}
[2025-12-09 13:47:26] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-09",
        "AMAR",
        "FL1305-310825\/7654",
        "2",
        "",
        "",
        "1320.00",
        "7654",
        "2025-12-09",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-09 13:47:26] Purchase header inserted successfully: {
    "purchase_id": 12,
    "affected_rows": 1
}
[2025-12-09 13:47:26] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-09 13:47:26] Processing item 0: {
    "item_code": "SCMBR0041385",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-09 13:47:26] Item 0 inserted successfully: {
    "purchase_id": 12,
    "item_code": "SCMBR0041385"
}
[2025-12-09 13:47:26] Processing item 2: {
    "item_code": "SCMBR0031824",
    "item_name": "Bira 91 Superfresh Natural White Beer .",
    "cases": 12,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 1200,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-09 13:47:26] Item 2 inserted successfully: {
    "purchase_id": 12,
    "item_code": "SCMBR0031824"
}
[2025-12-09 13:47:26] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-09 13:47:26] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 12:12:49] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:12:49] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:12:49] POST data: []
[2025-12-10 12:12:49] GET data: {
    "mode": "F"
}
[2025-12-10 12:12:49] Company ID from session: 1
[2025-12-10 12:12:49] Database connection included
[2025-12-10 12:12:49] License functions included
[2025-12-10 12:12:49] License type: FL-II
[2025-12-10 12:12:49] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:12:49] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:12:49] Purchase mode: F
[2025-12-10 12:12:49] Next voucher number: 2
[2025-12-10 12:12:49] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:12:49] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:12:49] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:12:49] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:12:49] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:12:49] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:12:49] POST data: []
[2025-12-10 12:12:49] GET data: {
    "mode": "F"
}
[2025-12-10 12:12:49] Company ID from session: 1
[2025-12-10 12:12:49] Database connection included
[2025-12-10 12:12:49] License functions included
[2025-12-10 12:12:49] License type: FL-II
[2025-12-10 12:12:49] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:12:49] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:12:49] Purchase mode: F
[2025-12-10 12:12:49] Next voucher number: 2
[2025-12-10 12:12:49] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:12:49] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:12:49] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:12:49] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:12:49] Database connection closed
[2025-12-10 12:12:49] === PURCHASE SESSION ENDED ===
[2025-12-10 12:14:21] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:14:21] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:14:21] POST data: []
[2025-12-10 12:14:21] GET data: {
    "mode": "F"
}
[2025-12-10 12:14:21] Company ID from session: 1
[2025-12-10 12:14:21] Database connection included
[2025-12-10 12:14:21] License functions included
[2025-12-10 12:14:21] License type: FL-II
[2025-12-10 12:14:21] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:14:21] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:14:21] Purchase mode: F
[2025-12-10 12:14:22] Next voucher number: 2
[2025-12-10 12:14:22] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:14:22] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:14:22] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:14:22] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:14:22] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:14:22] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:14:22] POST data: []
[2025-12-10 12:14:22] GET data: {
    "mode": "F"
}
[2025-12-10 12:14:22] Company ID from session: 1
[2025-12-10 12:14:22] Database connection included
[2025-12-10 12:14:22] License functions included
[2025-12-10 12:14:22] License type: FL-II
[2025-12-10 12:14:22] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:14:22] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:14:22] Purchase mode: F
[2025-12-10 12:14:22] Next voucher number: 2
[2025-12-10 12:14:22] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:14:22] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:14:22] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:14:22] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:14:22] Database connection closed
[2025-12-10 12:14:22] === PURCHASE SESSION ENDED ===
[2025-12-10 12:15:40] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:15:40] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:15:40] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-12-10",
    "auto_tp_no": "FL1249-220725\/1994",
    "tp_no": "1994",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMBR0041385",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "330 ML(12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        },
        {
            "code": "SCMBR0031824",
            "name": "Bira 91 Superfresh Natural White Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "12",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1320.00",
    "tamt": "1320.00"
}
[2025-12-10 12:15:40] GET data: {
    "mode": "F"
}
[2025-12-10 12:15:40] Company ID from session: 1
[2025-12-10 12:15:40] Database connection included
[2025-12-10 12:15:40] License functions included
[2025-12-10 12:15:40] License type: FL-II
[2025-12-10 12:15:40] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:15:40] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:15:40] Purchase mode: F
[2025-12-10 12:15:40] Next voucher number: 2
[2025-12-10 12:15:40] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:15:40] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:15:40] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:15:40] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:15:40] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:15:40] === FORM SUBMISSION STARTED ===
[2025-12-10 12:15:40] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "2",
    "auto_tp_no": "FL1249-220725\/1994",
    "tp_no": "1994",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "1320.00",
    "total_amt": "1320.00"
}
[2025-12-10 12:15:40] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "EM2",
        "FL1249-220725\/1994",
        "2",
        "",
        "",
        "1320.00",
        "1994",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 12:15:40] Purchase header inserted successfully: {
    "purchase_id": 13,
    "affected_rows": 1
}
[2025-12-10 12:15:40] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-10 12:15:40] Processing item 0: {
    "item_code": "SCMBR0041385",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 12:15:40] Item 0 inserted successfully: {
    "purchase_id": 13,
    "item_code": "SCMBR0041385"
}
[2025-12-10 12:15:40] Processing item 1: {
    "item_code": "SCMBR0031824",
    "item_name": "Bira 91 Superfresh Natural White Beer .",
    "cases": 12,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 1200,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 12:15:41] Item 1 inserted successfully: {
    "purchase_id": 13,
    "item_code": "SCMBR0031824"
}
[2025-12-10 12:15:41] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-10 12:15:41] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 12:15:41] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:15:41] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-12-10",
    "auto_tp_no": "FL1249-220725\/1994",
    "tp_no": "1994",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMBR0041385",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "330 ML(12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        },
        {
            "code": "SCMBR0031824",
            "name": "Bira 91 Superfresh Natural White Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "12",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1320.00",
    "tamt": "1320.00"
}
[2025-12-10 12:15:41] GET data: {
    "mode": "F"
}
[2025-12-10 12:15:41] Company ID from session: 1
[2025-12-10 12:15:41] Database connection included
[2025-12-10 12:15:41] License functions included
[2025-12-10 12:15:41] License type: FL-II
[2025-12-10 12:15:41] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:15:41] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:15:41] Purchase mode: F
[2025-12-10 12:15:41] Next voucher number: 3
[2025-12-10 12:15:41] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:15:41] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:15:41] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:15:41] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:15:41] === FORM SUBMISSION STARTED ===
[2025-12-10 12:15:41] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "2",
    "auto_tp_no": "FL1249-220725\/1994",
    "tp_no": "1994",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "1320.00",
    "total_amt": "1320.00"
}
[2025-12-10 12:15:41] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "EM2",
        "FL1249-220725\/1994",
        "2",
        "",
        "",
        "1320.00",
        "1994",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 12:15:41] Purchase header inserted successfully: {
    "purchase_id": 14,
    "affected_rows": 1
}
[2025-12-10 12:15:41] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-10 12:15:41] Processing item 0: {
    "item_code": "SCMBR0041385",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 12:15:41] Item 0 inserted successfully: {
    "purchase_id": 14,
    "item_code": "SCMBR0041385"
}
[2025-12-10 12:15:41] Processing item 1: {
    "item_code": "SCMBR0031824",
    "item_name": "Bira 91 Superfresh Natural White Beer .",
    "cases": 12,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 1200,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 12:15:41] Item 1 inserted successfully: {
    "purchase_id": 14,
    "item_code": "SCMBR0031824"
}
[2025-12-10 12:15:41] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-10 12:15:41] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 12:16:32] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:16:32] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:16:32] POST data: []
[2025-12-10 12:16:32] GET data: {
    "mode": "F"
}
[2025-12-10 12:16:32] Company ID from session: 1
[2025-12-10 12:16:32] Database connection included
[2025-12-10 12:16:32] License functions included
[2025-12-10 12:16:32] License type: FL-II
[2025-12-10 12:16:32] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:16:32] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:16:32] Purchase mode: F
[2025-12-10 12:16:32] Next voucher number: 3
[2025-12-10 12:16:32] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:16:32] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:16:32] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:16:32] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:16:32] Database connection closed
[2025-12-10 12:16:32] === PURCHASE SESSION ENDED ===
[2025-12-10 12:17:08] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:17:08] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:17:08] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-12-10",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "VISHAL TRADERS",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMKB0031393",
            "name": "Budweiser Magnum Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "6.50",
            "vv": "0",
            "tot_bott": "10",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-10 12:17:08] GET data: {
    "mode": "F"
}
[2025-12-10 12:17:08] Company ID from session: 1
[2025-12-10 12:17:09] Database connection included
[2025-12-10 12:17:09] License functions included
[2025-12-10 12:17:09] License type: FL-II
[2025-12-10 12:17:09] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:17:09] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:17:09] Purchase mode: F
[2025-12-10 12:17:09] Next voucher number: 3
[2025-12-10 12:17:09] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:17:09] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:17:09] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:17:09] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:17:09] === FORM SUBMISSION STARTED ===
[2025-12-10 12:17:09] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "3",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "VISHAL TRADERS",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-10 12:17:09] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "",
        "FL1305-310825\/7654",
        "3",
        "",
        "",
        "800.00",
        "7654",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 12:17:09] Purchase header inserted successfully: {
    "purchase_id": 15,
    "affected_rows": 1
}
[2025-12-10 12:17:09] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-10 12:17:09] Processing item 0: {
    "item_code": "SCMKB0031393",
    "item_name": "Budweiser Magnum Premium Beer .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 800,
    "tot_bott": 10,
    "bl": 6.5
}
[2025-12-10 12:17:09] Item 0 inserted successfully: {
    "purchase_id": 15,
    "item_code": "SCMKB0031393"
}
[2025-12-10 12:17:09] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-12-10 12:17:09] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 12:18:01] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:18:01] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:18:01] POST data: []
[2025-12-10 12:18:01] GET data: {
    "mode": "F"
}
[2025-12-10 12:18:01] Company ID from session: 1
[2025-12-10 12:18:01] Database connection included
[2025-12-10 12:18:01] License functions included
[2025-12-10 12:18:01] License type: FL-II
[2025-12-10 12:18:01] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:18:01] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:18:01] Purchase mode: F
[2025-12-10 12:18:01] Next voucher number: 4
[2025-12-10 12:18:01] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:18:01] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:18:01] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:18:01] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:18:01] Database connection closed
[2025-12-10 12:18:01] === PURCHASE SESSION ENDED ===
[2025-12-10 12:18:47] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:18:47] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-10 12:18:47] POST data: {
    "mode": "F",
    "voc_no": "4",
    "date": "2025-12-10",
    "auto_tp_no": "FL167-140725\/6036",
    "tp_no": "6036",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "SAMBARAGI TRADERS",
    "supplier_code": "SAMB",
    "items": [
        {
            "code": "SCMBR0018142",
            "name": "Budweiser Magnum Premium Strong Beers .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "6.50",
            "vv": "0",
            "tot_bott": "10",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1200.00",
    "tamt": "1200.00"
}
[2025-12-10 12:18:47] GET data: {
    "mode": "F"
}
[2025-12-10 12:18:47] Company ID from session: 1
[2025-12-10 12:18:47] Database connection included
[2025-12-10 12:18:47] License functions included
[2025-12-10 12:18:47] License type: FL-II
[2025-12-10 12:18:47] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:18:47] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:18:47] Purchase mode: F
[2025-12-10 12:18:47] Next voucher number: 4
[2025-12-10 12:18:47] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:18:47] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:18:47] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:18:47] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:18:47] === FORM SUBMISSION STARTED ===
[2025-12-10 12:18:47] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "4",
    "auto_tp_no": "FL167-140725\/6036",
    "tp_no": "6036",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "SAMB",
    "supplier_name": "SAMBARAGI TRADERS",
    "basic_amt": "1200.00",
    "total_amt": "1200.00"
}
[2025-12-10 12:18:47] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "SAMB",
        "FL167-140725\/6036",
        "4",
        "",
        "",
        "1200.00",
        "6036",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 12:18:47] Purchase header inserted successfully: {
    "purchase_id": 16,
    "affected_rows": 1
}
[2025-12-10 12:18:47] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-10 12:18:47] Processing item 0: {
    "item_code": "SCMBR0018142",
    "item_name": "Budweiser Magnum Premium Strong Beers .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1200,
    "tot_bott": 10,
    "bl": 6.5
}
[2025-12-10 12:18:47] Item 0 inserted successfully: {
    "purchase_id": 16,
    "item_code": "SCMBR0018142"
}
[2025-12-10 12:18:47] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-12-10 12:18:47] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 12:47:25] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:47:25] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [
        {
            "id": "693957fb8656f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958023162c",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580264df2",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958083e53f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580888eb3",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        }
    ],
    "sale_count": 5,
    "current_focus_index": -1,
    "last_added_item": "McDowell\\'s No 1 Platinum Luxury Whisky ."
}
[2025-12-10 12:47:25] POST data: []
[2025-12-10 12:47:25] GET data: {
    "mode": "F"
}
[2025-12-10 12:47:25] Company ID from session: 1
[2025-12-10 12:47:25] Database connection included
[2025-12-10 12:47:25] License functions included
[2025-12-10 12:47:25] License type: FL-II
[2025-12-10 12:47:25] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:47:25] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:47:25] Purchase mode: F
[2025-12-10 12:47:25] Next voucher number: 1
[2025-12-10 12:47:25] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:47:25] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:47:25] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:47:25] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:47:25] Database connection closed
[2025-12-10 12:47:25] === PURCHASE SESSION ENDED ===
[2025-12-10 12:48:50] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 12:48:50] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [
        {
            "id": "693957fb8656f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958023162c",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580264df2",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958083e53f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580888eb3",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        }
    ],
    "sale_count": 5,
    "current_focus_index": -1,
    "last_added_item": "McDowell\\'s No 1 Platinum Luxury Whisky ."
}
[2025-12-10 12:48:50] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-12-10",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": {
        "0": {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "8.64",
            "vv": "0",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        "1": {
            "code": "SCMBR0041385",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "330 ML(12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        },
        "3": {
            "code": "SCMBR0027987",
            "name": "Bira 91 Gold Wheat Strong Beer .",
            "size": "500 ML (12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "6.00",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        "4": {
            "code": "SCMWN0020397",
            "name": "Amora Red Wine .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0",
            "vv": "0",
            "tot_bott": "0",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    },
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "320.00",
    "tamt": "320.00"
}
[2025-12-10 12:48:50] GET data: {
    "mode": "F"
}
[2025-12-10 12:48:50] Company ID from session: 1
[2025-12-10 12:48:50] Database connection included
[2025-12-10 12:48:50] License functions included
[2025-12-10 12:48:50] License type: FL-II
[2025-12-10 12:48:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 12:48:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 12:48:50] Purchase mode: F
[2025-12-10 12:48:50] Next voucher number: 1
[2025-12-10 12:48:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 12:48:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 12:48:50] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 12:48:50] Suppliers fetched: {
    "count": 36
}
[2025-12-10 12:48:50] === FORM SUBMISSION STARTED ===
[2025-12-10 12:48:50] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "320.00",
    "total_amt": "320.00"
}
[2025-12-10 12:48:50] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "AMAR",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "320.00",
        "7654",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 12:48:50] Purchase header inserted successfully: {
    "purchase_id": 17,
    "affected_rows": 1
}
[2025-12-10 12:48:50] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-10 12:48:50] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-12-10 12:48:50] Item 0 inserted successfully: {
    "purchase_id": 17,
    "item_code": "SCMPL0019028"
}
[2025-12-10 12:48:50] Processing item 1: {
    "item_code": "SCMBR0041385",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 12:48:50] Item 1 inserted successfully: {
    "purchase_id": 17,
    "item_code": "SCMBR0041385"
}
[2025-12-10 12:48:50] Processing item 3: {
    "item_code": "SCMBR0027987",
    "item_name": "Bira 91 Gold Wheat Strong Beer .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 12,
    "bl": 6
}
[2025-12-10 12:48:50] Item 3 inserted successfully: {
    "purchase_id": 17,
    "item_code": "SCMBR0027987"
}
[2025-12-10 12:48:50] Processing item 4: {
    "item_code": "SCMWN0020397",
    "item_name": "Amora Red Wine .",
    "cases": 0,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 0,
    "tot_bott": 0,
    "bl": 0
}
[2025-12-10 12:48:50] Item 4 inserted successfully: {
    "purchase_id": 17,
    "item_code": "SCMWN0020397"
}
[2025-12-10 12:48:50] Purchase items processing completed: {
    "successful_items": 4,
    "total_items": 4
}
[2025-12-10 12:48:50] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 13:04:35] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 13:04:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [
        {
            "id": "693957fb8656f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958023162c",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580264df2",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958083e53f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580888eb3",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        }
    ],
    "sale_count": 5,
    "current_focus_index": -1,
    "last_added_item": "McDowell\\'s No 1 Platinum Luxury Whisky ."
}
[2025-12-10 13:04:35] POST data: []
[2025-12-10 13:04:35] GET data: {
    "mode": "F"
}
[2025-12-10 13:04:35] Company ID from session: 1
[2025-12-10 13:04:35] Database connection included
[2025-12-10 13:04:35] License functions included
[2025-12-10 13:04:35] License type: FL-II
[2025-12-10 13:04:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 13:04:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 13:04:35] Purchase mode: F
[2025-12-10 13:04:35] Next voucher number: 2
[2025-12-10 13:04:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 13:04:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 13:04:35] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 13:04:35] Suppliers fetched: {
    "count": 36
}
[2025-12-10 13:04:35] Database connection closed
[2025-12-10 13:04:35] === PURCHASE SESSION ENDED ===
[2025-12-10 13:05:12] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 13:05:12] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [
        {
            "id": "693957fb8656f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958023162c",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580264df2",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958083e53f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580888eb3",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        }
    ],
    "sale_count": 5,
    "current_focus_index": -1,
    "last_added_item": "McDowell\\'s No 1 Platinum Luxury Whisky ."
}
[2025-12-10 13:05:12] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-12-10",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMBR0027986",
            "name": "Bira 91 Gold Wheat Strong Beer .",
            "size": "330 ML(12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-10 13:05:12] GET data: {
    "mode": "F"
}
[2025-12-10 13:05:12] Company ID from session: 1
[2025-12-10 13:05:12] Database connection included
[2025-12-10 13:05:12] License functions included
[2025-12-10 13:05:12] License type: FL-II
[2025-12-10 13:05:12] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 13:05:12] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 13:05:12] Purchase mode: F
[2025-12-10 13:05:12] Next voucher number: 2
[2025-12-10 13:05:12] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 13:05:12] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 13:05:12] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 13:05:12] Suppliers fetched: {
    "count": 36
}
[2025-12-10 13:05:12] === FORM SUBMISSION STARTED ===
[2025-12-10 13:05:12] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "2",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-10 13:05:12] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "EM2",
        "FL1305-310825\/7654",
        "2",
        "",
        "",
        "800.00",
        "7654",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 13:05:12] Purchase header inserted successfully: {
    "purchase_id": 18,
    "affected_rows": 1
}
[2025-12-10 13:05:12] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-10 13:05:12] Processing item 0: {
    "item_code": "SCMBR0027986",
    "item_name": "Bira 91 Gold Wheat Strong Beer .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 13:05:12] Item 0 inserted successfully: {
    "purchase_id": 18,
    "item_code": "SCMBR0027986"
}
[2025-12-10 13:05:12] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-12-10 13:05:12] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 13:06:27] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 13:06:27] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [
        {
            "id": "693957fb8656f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958023162c",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580264df2",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958083e53f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580888eb3",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        }
    ],
    "sale_count": 5,
    "current_focus_index": -1,
    "last_added_item": "McDowell\\'s No 1 Platinum Luxury Whisky ."
}
[2025-12-10 13:06:27] POST data: []
[2025-12-10 13:06:27] GET data: {
    "mode": "F"
}
[2025-12-10 13:06:27] Company ID from session: 1
[2025-12-10 13:06:27] Database connection included
[2025-12-10 13:06:27] License functions included
[2025-12-10 13:06:27] License type: FL-II
[2025-12-10 13:06:27] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 13:06:27] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 13:06:27] Purchase mode: F
[2025-12-10 13:06:27] Next voucher number: 1
[2025-12-10 13:06:27] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 13:06:27] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 13:06:27] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 13:06:27] Suppliers fetched: {
    "count": 36
}
[2025-12-10 13:06:27] Database connection closed
[2025-12-10 13:06:27] === PURCHASE SESSION ENDED ===
[2025-12-10 13:07:52] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 13:07:52] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [
        {
            "id": "693957fb8656f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958023162c",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580264df2",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "693958083e53f",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        },
        {
            "id": "6939580888eb3",
            "code": "SCMPL0010507",
            "name": "McDowell\\'s No 1 Platinum Luxury Whisky .",
            "size": "90 ML-(96)",
            "price": 130,
            "quantity": 1,
            "current_stock": 5
        }
    ],
    "sale_count": 5,
    "current_focus_index": -1,
    "last_added_item": "McDowell\\'s No 1 Platinum Luxury Whisky ."
}
[2025-12-10 13:07:52] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-12-10",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": {
        "0": {
            "code": "SCMBR0032869",
            "name": "Carlsberg Robbie Fowler Elephant Strong Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.50",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        "2": {
            "code": "SCMKB0018317",
            "name": "Budweiser Premium King of Beer(s) .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.65",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "1",
            "case_rate": "100.000",
            "mrp": "0"
        }
    },
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "200.00",
    "tamt": "200.00"
}
[2025-12-10 13:07:52] GET data: {
    "mode": "F"
}
[2025-12-10 13:07:52] Company ID from session: 1
[2025-12-10 13:07:52] Database connection included
[2025-12-10 13:07:52] License functions included
[2025-12-10 13:07:52] License type: FL-II
[2025-12-10 13:07:52] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 13:07:52] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 13:07:52] Purchase mode: F
[2025-12-10 13:07:52] Next voucher number: 1
[2025-12-10 13:07:52] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 13:07:52] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 13:07:52] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 13:07:52] Suppliers fetched: {
    "count": 36
}
[2025-12-10 13:07:52] === FORM SUBMISSION STARTED ===
[2025-12-10 13:07:52] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "200.00",
    "total_amt": "200.00"
}
[2025-12-10 13:07:52] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "EM2",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "200.00",
        "7654",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 13:07:52] Purchase header inserted successfully: {
    "purchase_id": 19,
    "affected_rows": 1
}
[2025-12-10 13:07:52] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-10 13:07:52] Processing item 0: {
    "item_code": "SCMBR0032869",
    "item_name": "Carlsberg Robbie Fowler Elephant Strong Beer .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 1,
    "bl": 0.5
}
[2025-12-10 13:07:52] Item 0 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0032869"
}
[2025-12-10 13:07:52] Processing item 2: {
    "item_code": "SCMKB0018317",
    "item_name": "Budweiser Premium King of Beer(s) .",
    "cases": 0,
    "bottles": 1,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 1,
    "bl": 0.65
}
[2025-12-10 13:07:52] Item 2 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMKB0018317"
}
[2025-12-10 13:07:52] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-10 13:07:52] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-10 13:57:23] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 13:57:23] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1
}
[2025-12-10 13:57:23] POST data: []
[2025-12-10 13:57:23] GET data: {
    "mode": "F"
}
[2025-12-10 13:57:23] Company ID from session: 1
[2025-12-10 13:57:23] Database connection included
[2025-12-10 13:57:23] License functions included
[2025-12-10 13:57:23] License type: FL-II
[2025-12-10 13:57:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 13:57:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 13:57:23] Purchase mode: F
[2025-12-10 13:57:23] Next voucher number: 1
[2025-12-10 13:57:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 13:57:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 13:57:23] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 13:57:23] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 13:57:23] Suppliers fetched: {
    "count": 36
}
[2025-12-10 13:57:23] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1
}
[2025-12-10 13:57:23] POST data: []
[2025-12-10 13:57:23] GET data: {
    "mode": "F"
}
[2025-12-10 13:57:23] Company ID from session: 1
[2025-12-10 13:57:23] Database connection included
[2025-12-10 13:57:23] License functions included
[2025-12-10 13:57:23] License type: FL-II
[2025-12-10 13:57:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 13:57:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 13:57:23] Purchase mode: F
[2025-12-10 13:57:23] Next voucher number: 1
[2025-12-10 13:57:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 13:57:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 13:57:23] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 13:57:23] Suppliers fetched: {
    "count": 36
}
[2025-12-10 13:57:23] Database connection closed
[2025-12-10 13:57:23] === PURCHASE SESSION ENDED ===
[2025-12-10 13:59:33] === NEW PURCHASE SESSION STARTED ===
[2025-12-10 13:59:33] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop",
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1
}
[2025-12-10 13:59:33] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-12-10",
    "auto_tp_no": "FL167-140725\/6036",
    "tp_no": "6036",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": {
        "0": {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "8.64",
            "vv": "0",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        "1": {
            "code": "SCMWN0026411",
            "name": "Dia White Wine Sparkler .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "12",
            "case_rate": "80.000",
            "mrp": "0"
        },
        "3": {
            "code": "SCMBR0041385",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "330 ML(12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        },
        "5": {
            "code": "SCMBR0031826",
            "name": "Bira 91 Superfresh Natural White Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "7.80",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "12",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "0"
        }
    },
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "10780.00",
    "tamt": "10780.00"
}
[2025-12-10 13:59:33] GET data: {
    "mode": "F"
}
[2025-12-10 13:59:33] Company ID from session: 1
[2025-12-10 13:59:33] Database connection included
[2025-12-10 13:59:33] License functions included
[2025-12-10 13:59:33] License type: FL-II
[2025-12-10 13:59:33] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-10 13:59:33] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-10 13:59:33] Purchase mode: F
[2025-12-10 13:59:33] Next voucher number: 1
[2025-12-10 13:59:33] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-10 13:59:33] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-10 13:59:33] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-10 13:59:33] Suppliers fetched: {
    "count": 36
}
[2025-12-10 13:59:33] === FORM SUBMISSION STARTED ===
[2025-12-10 13:59:33] Form data extracted: {
    "date": "2025-12-10",
    "voc_no": "1",
    "auto_tp_no": "FL167-140725\/6036",
    "tp_no": "6036",
    "tp_date": "2025-12-10",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "10780.00",
    "total_amt": "10780.00"
}
[2025-12-10 13:59:33] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-10",
        "AMAR",
        "FL167-140725\/6036",
        "1",
        "",
        "",
        "10780.00",
        "6036",
        "2025-12-10",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-10 13:59:33] Purchase header inserted successfully: {
    "purchase_id": 20,
    "affected_rows": 1
}
[2025-12-10 13:59:33] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-10 13:59:33] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-12-10 13:59:33] Item 0 inserted successfully: {
    "purchase_id": 20,
    "item_code": "SCMPL0019028"
}
[2025-12-10 13:59:33] Processing item 1: {
    "item_code": "SCMWN0026411",
    "item_name": "Dia White Wine Sparkler .",
    "cases": 0,
    "bottles": 12,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 960,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 13:59:33] Item 1 inserted successfully: {
    "purchase_id": 20,
    "item_code": "SCMWN0026411"
}
[2025-12-10 13:59:33] Processing item 3: {
    "item_code": "SCMBR0041385",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-10 13:59:33] Item 3 inserted successfully: {
    "purchase_id": 20,
    "item_code": "SCMBR0041385"
}
[2025-12-10 13:59:33] Processing item 5: {
    "item_code": "SCMBR0031826",
    "item_name": "Bira 91 Superfresh Natural White Beer .",
    "cases": 12,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 9600,
    "tot_bott": 12,
    "bl": 7.8
}
[2025-12-10 13:59:33] Item 5 inserted successfully: {
    "purchase_id": 20,
    "item_code": "SCMBR0031826"
}
[2025-12-10 13:59:33] Purchase items processing completed: {
    "successful_items": 4,
    "total_items": 4
}
[2025-12-10 13:59:33] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-12 14:46:32] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 14:46:32] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 14:46:32] POST data: []
[2025-12-12 14:46:32] GET data: {
    "mode": "F"
}
[2025-12-12 14:46:32] Company ID from session: 1
[2025-12-12 14:46:32] Database connection included
[2025-12-12 14:46:32] License functions included
[2025-12-12 14:46:32] License type: FL-II
[2025-12-12 14:46:32] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 14:46:32] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 14:46:32] Purchase mode: F
[2025-12-12 14:46:32] Next voucher number: 2
[2025-12-12 14:46:32] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 14:46:32] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 14:46:32] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 14:46:32] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 14:46:32] Suppliers fetched: {
    "count": 36
}
[2025-12-12 14:46:32] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 14:46:32] POST data: []
[2025-12-12 14:46:32] GET data: {
    "mode": "F"
}
[2025-12-12 14:46:32] Company ID from session: 1
[2025-12-12 14:46:32] Database connection included
[2025-12-12 14:46:32] License functions included
[2025-12-12 14:46:32] License type: FL-II
[2025-12-12 14:46:32] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 14:46:32] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 14:46:32] Purchase mode: F
[2025-12-12 14:46:32] Next voucher number: 2
[2025-12-12 14:46:32] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 14:46:32] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 14:46:32] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 14:46:32] Suppliers fetched: {
    "count": 36
}
[2025-12-12 14:46:33] Database connection closed
[2025-12-12 14:46:33] === PURCHASE SESSION ENDED ===
[2025-12-12 14:47:35] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 14:47:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 14:47:35] POST data: []
[2025-12-12 14:47:35] GET data: {
    "mode": "F"
}
[2025-12-12 14:47:35] Company ID from session: 1
[2025-12-12 14:47:35] Database connection included
[2025-12-12 14:47:35] License functions included
[2025-12-12 14:47:35] License type: FL-II
[2025-12-12 14:47:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 14:47:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 14:47:35] Purchase mode: F
[2025-12-12 14:47:35] Next voucher number: 2
[2025-12-12 14:47:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 14:47:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 14:47:35] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 14:47:35] Suppliers fetched: {
    "count": 36
}
[2025-12-12 14:47:35] Database connection closed
[2025-12-12 14:47:35] === PURCHASE SESSION ENDED ===
[2025-12-12 14:47:55] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 14:47:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 14:47:55] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-12 14:47:55] GET data: {
    "mode": "F"
}
[2025-12-12 14:47:55] Company ID from session: 1
[2025-12-12 14:47:55] Database connection included
[2025-12-12 14:47:55] License functions included
[2025-12-12 14:47:55] License type: FL-II
[2025-12-12 14:47:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 14:47:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 14:47:55] Purchase mode: F
[2025-12-12 14:47:55] Next voucher number: 2
[2025-12-12 14:47:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 14:47:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 14:47:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 14:47:55] Suppliers fetched: {
    "count": 36
}
[2025-12-12 14:47:55] === FORM SUBMISSION STARTED ===
[2025-12-12 14:47:55] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "2",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-12 14:47:55] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "EM2",
        "FL1249-191125\/4540",
        "2",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-12 14:47:55] Purchase header inserted successfully: {
    "purchase_id": 21,
    "affected_rows": 1
}
[2025-12-12 14:47:55] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-12 14:47:55] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-12 14:47:55] Item 0 inserted successfully: {
    "purchase_id": 21,
    "item_code": "SCMLS0019502"
}
[2025-12-12 14:47:55] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-12 14:47:55] Item 1 inserted successfully: {
    "purchase_id": 21,
    "item_code": "SCMLS0019504"
}
[2025-12-12 14:47:56] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-12 14:47:56] Item 2 inserted successfully: {
    "purchase_id": 21,
    "item_code": "SCMLW0019523"
}
[2025-12-12 14:47:56] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-12 14:47:56] Item 3 inserted successfully: {
    "purchase_id": 21,
    "item_code": "SCMLW0019523"
}
[2025-12-12 14:47:56] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-12 14:47:56] Item 4 inserted successfully: {
    "purchase_id": 21,
    "item_code": "SCMLW0019524"
}
[2025-12-12 14:47:57] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-12 14:47:57] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-12 15:22:40] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:22:40] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:22:40] POST data: []
[2025-12-12 15:22:40] GET data: {
    "mode": "F"
}
[2025-12-12 15:22:40] Company ID from session: 1
[2025-12-12 15:22:40] Database connection included
[2025-12-12 15:22:40] License functions included
[2025-12-12 15:22:40] License type: FL-II
[2025-12-12 15:22:40] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:22:40] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:22:40] Purchase mode: F
[2025-12-12 15:22:40] Next voucher number: 1
[2025-12-12 15:22:40] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:22:40] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:22:40] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:22:40] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:22:40] Database connection closed
[2025-12-12 15:22:40] === PURCHASE SESSION ENDED ===
[2025-12-12 15:23:31] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:23:31] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:23:31] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-17",
    "auto_tp_no": "FL177-171125\/9983",
    "tp_no": "9983",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ROCKY TRADERS",
    "supplier_code": "ROCK",
    "items": [
        {
            "code": "SCMPL0041325",
            "name": "Old Monk Very Old Vatted XXX Rum .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "348",
            "auto_batch": "BTP31-081025\/348",
            "mfg_month": "Oct-2025",
            "bl": "69.12",
            "vv": "25",
            "tot_bott": "768",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "8",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "110"
        },
        {
            "code": "SCMPL0041327",
            "name": "Old Monk Very Old Vatted XXX Rum .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "388",
            "auto_batch": "BTP31-251025\/388",
            "mfg_month": "Oct-2025",
            "bl": "27",
            "vv": "25",
            "tot_bott": "72",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "440"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "6700.00",
    "tamt": "6700.00"
}
[2025-12-12 15:23:31] GET data: {
    "mode": "F"
}
[2025-12-12 15:23:31] Company ID from session: 1
[2025-12-12 15:23:31] Database connection included
[2025-12-12 15:23:31] License functions included
[2025-12-12 15:23:31] License type: FL-II
[2025-12-12 15:23:31] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:23:31] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:23:31] Purchase mode: F
[2025-12-12 15:23:31] Next voucher number: 1
[2025-12-12 15:23:31] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:23:31] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:23:31] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:23:31] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:23:31] === FORM SUBMISSION STARTED ===
[2025-12-12 15:23:31] Form data extracted: {
    "date": "2025-11-17",
    "voc_no": "1",
    "auto_tp_no": "FL177-171125\/9983",
    "tp_no": "9983",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ROCK",
    "supplier_name": "ROCKY TRADERS",
    "basic_amt": "6700.00",
    "total_amt": "6700.00"
}
[2025-12-12 15:23:31] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-17",
        "ROCK",
        "FL177-171125\/9983",
        "1",
        "",
        "",
        "6700.00",
        "9983",
        "2025-11-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-12 15:23:31] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-12 15:23:31] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-12 15:23:31] Processing item 0: {
    "item_code": "SCMPL0041325",
    "item_name": "Old Monk Very Old Vatted XXX Rum .",
    "cases": 8,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 6400,
    "tot_bott": 768,
    "bl": 69.12
}
[2025-12-12 15:23:31] Item 0 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0041325"
}
[2025-12-12 15:23:32] Processing item 1: {
    "item_code": "SCMPL0041327",
    "item_name": "Old Monk Very Old Vatted XXX Rum .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 300,
    "tot_bott": 72,
    "bl": 27
}
[2025-12-12 15:23:32] Item 1 inserted successfully: {
    "purchase_id": 1,
    "item_code": "SCMPL0041327"
}
[2025-12-12 15:23:32] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-12 15:23:32] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-12 15:24:44] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:24:44] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:24:44] POST data: []
[2025-12-12 15:24:44] GET data: {
    "mode": "F"
}
[2025-12-12 15:24:44] Company ID from session: 1
[2025-12-12 15:24:44] Database connection included
[2025-12-12 15:24:44] License functions included
[2025-12-12 15:24:44] License type: FL-II
[2025-12-12 15:24:44] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:24:44] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:24:44] Purchase mode: F
[2025-12-12 15:24:44] Next voucher number: 2
[2025-12-12 15:24:44] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:24:44] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:24:44] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:24:44] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:24:44] Database connection closed
[2025-12-12 15:24:44] === PURCHASE SESSION ENDED ===
[2025-12-12 15:24:52] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:24:52] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:24:52] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-17",
    "auto_tp_no": "FL1249-171125\/4483",
    "tp_no": "4508",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010075",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "1784",
            "auto_batch": "BTP28-011025\/1784",
            "mfg_month": "Oct-2025",
            "bl": "45",
            "vv": "25",
            "tot_bott": "500",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "140"
        },
        {
            "code": "SCMPL0010076",
            "name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "1342",
            "auto_batch": "BTP28-080825\/1341",
            "mfg_month": "Aug-2025",
            "bl": "45",
            "vv": "25",
            "tot_bott": "500",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "120"
        },
        {
            "code": "SCMPL0010087",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2149",
            "auto_batch": "BTP28-081125\/2149",
            "mfg_month": "Nov-2025",
            "bl": "172.8",
            "vv": "25",
            "tot_bott": "960",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "20",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0010095",
            "name": "Seagram\\'s Blenders Pride Reserve Collection Whisk",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2075",
            "auto_batch": "BTP28-031125\/2075",
            "mfg_month": "Nov-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "420"
        },
        {
            "code": "SCMPL0010111",
            "name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "2019",
            "auto_batch": "BTP28-261025\/2019",
            "mfg_month": "Oct-2025",
            "bl": "18",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "440"
        },
        {
            "code": "SCMPL0010701",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "1035",
            "auto_batch": "BTP28-080725\/1035",
            "mfg_month": "Jul-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "190"
        },
        {
            "code": "SCMPL0010702",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2139",
            "auto_batch": "BTP28-071125\/2139",
            "mfg_month": "Nov-2025",
            "bl": "25.92",
            "vv": "25",
            "tot_bott": "144",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "380"
        },
        {
            "code": "SCMPL0010704",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "0396",
            "auto_batch": "BTP28-110525\/396",
            "mfg_month": "May-2025",
            "bl": "18",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "1450"
        },
        {
            "code": "SCMPL0031624",
            "name": "Seagram\\'s Royal Stag Barrel Select Whisky .",
            "size": "2000 ML Pet (6)",
            "bottles_per_case": "6",
            "batch_no": "1588",
            "auto_batch": "BTP28-100925\/1588",
            "mfg_month": "Sep-2025",
            "bl": "12",
            "vv": "25",
            "tot_bott": "6",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "3200"
        },
        {
            "code": "SCMPL0035191",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "2000 ML Pet (6)",
            "bottles_per_case": "6",
            "batch_no": "1638",
            "auto_batch": "BTP28-170925\/1638",
            "mfg_month": "Sep-2025",
            "bl": "24",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2800"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "21120.00",
    "tamt": "21120.00"
}
[2025-12-12 15:24:52] GET data: {
    "mode": "F"
}
[2025-12-12 15:24:52] Company ID from session: 1
[2025-12-12 15:24:52] Database connection included
[2025-12-12 15:24:52] License functions included
[2025-12-12 15:24:52] License type: FL-II
[2025-12-12 15:24:52] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:24:52] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:24:52] Purchase mode: F
[2025-12-12 15:24:52] Next voucher number: 2
[2025-12-12 15:24:52] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:24:52] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:24:52] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:24:52] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:24:52] === FORM SUBMISSION STARTED ===
[2025-12-12 15:24:52] Form data extracted: {
    "date": "2025-11-17",
    "voc_no": "2",
    "auto_tp_no": "FL1249-171125\/4483",
    "tp_no": "4508",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "21120.00",
    "total_amt": "21120.00"
}
[2025-12-12 15:24:52] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-17",
        "EM2",
        "FL1249-171125\/4483",
        "2",
        "",
        "",
        "21120.00",
        "4508",
        "2025-11-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-12 15:24:52] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-12 15:24:52] Starting to process purchase items: {
    "item_count": 10
}
[2025-12-12 15:24:52] Processing item 0: {
    "item_code": "SCMPL0010075",
    "item_name": "Seagram\\'s Royal Stag Deluxe Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 500,
    "bl": 45
}
[2025-12-12 15:24:52] Item 0 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010075"
}
[2025-12-12 15:24:52] Processing item 1: {
    "item_code": "SCMPL0010076",
    "item_name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 400,
    "tot_bott": 500,
    "bl": 45
}
[2025-12-12 15:24:52] Item 1 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010076"
}
[2025-12-12 15:24:53] Processing item 2: {
    "item_code": "SCMPL0010087",
    "item_name": "Seagram\\'s Royal Stag Deluxe Whisky .",
    "cases": 20,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 16000,
    "tot_bott": 960,
    "bl": 172.8
}
[2025-12-12 15:24:53] Item 2 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010087"
}
[2025-12-12 15:24:53] Processing item 3: {
    "item_code": "SCMPL0010095",
    "item_name": "Seagram\\'s Blenders Pride Reserve Collection Whisk",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 96,
    "bl": 17.28
}
[2025-12-12 15:24:53] Item 3 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010095"
}
[2025-12-12 15:24:53] Processing item 4: {
    "item_code": "SCMPL0010111",
    "item_name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 48,
    "bl": 18
}
[2025-12-12 15:24:53] Item 4 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010111"
}
[2025-12-12 15:24:53] Processing item 5: {
    "item_code": "SCMPL0010701",
    "item_name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-12-12 15:24:53] Item 5 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010701"
}
[2025-12-12 15:24:53] Processing item 6: {
    "item_code": "SCMPL0010702",
    "item_name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 300,
    "tot_bott": 144,
    "bl": 25.92
}
[2025-12-12 15:24:53] Item 6 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010702"
}
[2025-12-12 15:24:54] Processing item 7: {
    "item_code": "SCMPL0010704",
    "item_name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 1600,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-12 15:24:54] Item 7 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0010704"
}
[2025-12-12 15:24:54] Processing item 8: {
    "item_code": "SCMPL0031624",
    "item_name": "Seagram\\'s Royal Stag Barrel Select Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 6,
    "bl": 12
}
[2025-12-12 15:24:54] Item 8 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0031624"
}
[2025-12-12 15:24:54] Processing item 9: {
    "item_code": "SCMPL0035191",
    "item_name": "Seagram\\'s Royal Stag Deluxe Whisky .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 12,
    "bl": 24
}
[2025-12-12 15:24:54] Item 9 inserted successfully: {
    "purchase_id": 2,
    "item_code": "SCMPL0035191"
}
[2025-12-12 15:24:54] Purchase items processing completed: {
    "successful_items": 10,
    "total_items": 10
}
[2025-12-12 15:24:54] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-12 15:26:05] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:26:05] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:26:05] POST data: []
[2025-12-12 15:26:05] GET data: {
    "mode": "F"
}
[2025-12-12 15:26:05] Company ID from session: 1
[2025-12-12 15:26:06] Database connection included
[2025-12-12 15:26:06] License functions included
[2025-12-12 15:26:06] License type: FL-II
[2025-12-12 15:26:06] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:26:06] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:26:06] Purchase mode: F
[2025-12-12 15:26:06] Next voucher number: 3
[2025-12-12 15:26:06] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:26:06] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:26:06] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:26:06] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:26:06] Database connection closed
[2025-12-12 15:26:06] === PURCHASE SESSION ENDED ===
[2025-12-12 15:26:17] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:26:17] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:26:17] POST data: []
[2025-12-12 15:26:17] GET data: {
    "mode": "F"
}
[2025-12-12 15:26:17] Company ID from session: 1
[2025-12-12 15:26:17] Database connection included
[2025-12-12 15:26:17] License functions included
[2025-12-12 15:26:17] License type: FL-II
[2025-12-12 15:26:17] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:26:17] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:26:17] Purchase mode: F
[2025-12-12 15:26:17] Next voucher number: 3
[2025-12-12 15:26:17] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:26:17] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:26:17] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:26:17] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:26:17] Database connection closed
[2025-12-12 15:26:17] === PURCHASE SESSION ENDED ===
[2025-12-12 15:26:36] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:26:36] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:26:36] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-12 15:26:36] GET data: {
    "mode": "F"
}
[2025-12-12 15:26:36] Company ID from session: 1
[2025-12-12 15:26:36] Database connection included
[2025-12-12 15:26:36] License functions included
[2025-12-12 15:26:36] License type: FL-II
[2025-12-12 15:26:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:26:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:26:36] Purchase mode: F
[2025-12-12 15:26:36] Next voucher number: 3
[2025-12-12 15:26:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:26:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:26:36] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:26:36] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:26:36] === FORM SUBMISSION STARTED ===
[2025-12-12 15:26:36] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "3",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-12 15:26:36] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "EM2",
        "FL1249-191125\/4540",
        "3",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-12 15:26:36] Purchase header inserted successfully: {
    "purchase_id": 3,
    "affected_rows": 1
}
[2025-12-12 15:26:36] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-12 15:26:36] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-12 15:26:36] Item 0 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLS0019502"
}
[2025-12-12 15:26:36] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-12 15:26:36] Item 1 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLS0019504"
}
[2025-12-12 15:26:37] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-12 15:26:37] Item 2 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLW0019523"
}
[2025-12-12 15:26:37] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-12 15:26:37] Item 3 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLW0019523"
}
[2025-12-12 15:26:37] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-12 15:26:37] Item 4 inserted successfully: {
    "purchase_id": 3,
    "item_code": "SCMLW0019524"
}
[2025-12-12 15:26:37] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-12 15:26:37] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-12 15:27:26] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:27:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:27:26] POST data: []
[2025-12-12 15:27:26] GET data: {
    "mode": "F"
}
[2025-12-12 15:27:26] Company ID from session: 1
[2025-12-12 15:27:26] Database connection included
[2025-12-12 15:27:26] License functions included
[2025-12-12 15:27:26] License type: FL-II
[2025-12-12 15:27:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:27:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:27:26] Purchase mode: F
[2025-12-12 15:27:26] Next voucher number: 3
[2025-12-12 15:27:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:27:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:27:26] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:27:26] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:27:26] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:27:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:27:26] POST data: []
[2025-12-12 15:27:26] GET data: {
    "mode": "F"
}
[2025-12-12 15:27:26] Company ID from session: 1
[2025-12-12 15:27:26] Database connection included
[2025-12-12 15:27:26] License functions included
[2025-12-12 15:27:26] License type: FL-II
[2025-12-12 15:27:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:27:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:27:26] Purchase mode: F
[2025-12-12 15:27:26] Next voucher number: 3
[2025-12-12 15:27:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:27:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:27:26] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:27:26] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:27:26] Database connection closed
[2025-12-12 15:27:26] === PURCHASE SESSION ENDED ===
[2025-12-12 15:27:36] === NEW PURCHASE SESSION STARTED ===
[2025-12-12 15:27:36] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-12 15:27:36] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-11-19",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "246",
            "auto_batch": "BTBL2-071125\/649",
            "mfg_month": "Nov-2025",
            "bl": "195",
            "vv": "8",
            "tot_bott": "300",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "25",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0018627",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "534",
            "auto_batch": "BTBL7-011125\/534",
            "mfg_month": "Nov-2025",
            "bl": "60",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "3500.00",
    "tamt": "3500.00"
}
[2025-12-12 15:27:36] GET data: {
    "mode": "F"
}
[2025-12-12 15:27:36] Company ID from session: 1
[2025-12-12 15:27:36] Database connection included
[2025-12-12 15:27:36] License functions included
[2025-12-12 15:27:36] License type: FL-II
[2025-12-12 15:27:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-12 15:27:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-12 15:27:36] Purchase mode: F
[2025-12-12 15:27:36] Next voucher number: 3
[2025-12-12 15:27:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-12 15:27:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-12 15:27:36] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-12 15:27:36] Suppliers fetched: {
    "count": 36
}
[2025-12-12 15:27:36] === FORM SUBMISSION STARTED ===
[2025-12-12 15:27:36] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "3",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "3500.00",
    "total_amt": "3500.00"
}
[2025-12-12 15:27:36] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "RAJ",
        "FL119851-191125\/5139",
        "3",
        "",
        "",
        "3500.00",
        "5139",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-12 15:27:36] Purchase header inserted successfully: {
    "purchase_id": 4,
    "affected_rows": 1
}
[2025-12-12 15:27:36] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-12 15:27:36] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 25,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3000,
    "tot_bott": 300,
    "bl": 195
}
[2025-12-12 15:27:36] Item 0 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMBR0009846"
}
[2025-12-12 15:27:36] Processing item 1: {
    "item_code": "SCMBR0018627",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 120,
    "bl": 60
}
[2025-12-12 15:27:36] Item 1 inserted successfully: {
    "purchase_id": 4,
    "item_code": "SCMBR0018627"
}
[2025-12-12 15:27:36] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-12 15:27:36] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:16:53] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:16:53] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:16:53] POST data: []
[2025-12-13 06:16:53] GET data: {
    "mode": "F"
}
[2025-12-13 06:16:53] Company ID from session: 1
[2025-12-13 06:16:53] Database connection included
[2025-12-13 06:16:53] License functions included
[2025-12-13 06:16:53] License type: FL-II
[2025-12-13 06:16:53] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:16:53] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:16:53] Purchase mode: F
[2025-12-13 06:16:53] Next voucher number: 1
[2025-12-13 06:16:54] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:16:54] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:16:54] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:16:54] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:16:54] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:16:54] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:16:54] POST data: []
[2025-12-13 06:16:54] GET data: {
    "mode": "F"
}
[2025-12-13 06:16:54] Company ID from session: 1
[2025-12-13 06:16:54] Database connection included
[2025-12-13 06:16:54] License functions included
[2025-12-13 06:16:54] License type: FL-II
[2025-12-13 06:16:54] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:16:54] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:16:54] Purchase mode: F
[2025-12-13 06:16:54] Next voucher number: 1
[2025-12-13 06:16:54] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:16:54] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:16:54] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:16:54] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:16:54] Database connection closed
[2025-12-13 06:16:54] === PURCHASE SESSION ENDED ===
[2025-12-13 06:18:14] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:18:14] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:18:14] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-12-13",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ASIAN TRADERS",
    "supplier_code": "ASIA",
    "items": [
        {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "8.64",
            "vv": "0",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        {
            "code": "SCMWN0020397",
            "name": "Amora Red Wine .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "9.00",
            "vv": "0",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        {
            "code": "SCMBR0031824",
            "name": "Bira 91 Superfresh Natural White Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "12",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        {
            "code": "SCMBR0039553",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "9.10",
            "vv": "0",
            "tot_bott": "14",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "14",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "2520.00",
    "tamt": "2520.00"
}
[2025-12-13 06:18:14] GET data: {
    "mode": "F"
}
[2025-12-13 06:18:14] Company ID from session: 1
[2025-12-13 06:18:14] Database connection included
[2025-12-13 06:18:14] License functions included
[2025-12-13 06:18:14] License type: FL-II
[2025-12-13 06:18:14] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:18:14] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:18:14] Purchase mode: F
[2025-12-13 06:18:14] Next voucher number: 1
[2025-12-13 06:18:14] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:18:14] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:18:14] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:18:14] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:18:14] === FORM SUBMISSION STARTED ===
[2025-12-13 06:18:14] Form data extracted: {
    "date": "2025-12-13",
    "voc_no": "1",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ASIA",
    "supplier_name": "ASIAN TRADERS",
    "basic_amt": "2520.00",
    "total_amt": "2520.00"
}
[2025-12-13 06:18:14] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-13",
        "ASIA",
        "FL1305-310825\/7654",
        "1",
        "",
        "",
        "2520.00",
        "7654",
        "2025-12-13",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:18:14] Purchase header inserted successfully: {
    "purchase_id": 5,
    "affected_rows": 1
}
[2025-12-13 06:18:14] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-13 06:18:14] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-12-13 06:18:14] Item 0 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMPL0019028"
}
[2025-12-13 06:18:14] Processing item 1: {
    "item_code": "SCMWN0020397",
    "item_name": "Amora Red Wine .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 9
}
[2025-12-13 06:18:14] Item 1 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMWN0020397"
}
[2025-12-13 06:18:14] Processing item 2: {
    "item_code": "SCMBR0031824",
    "item_name": "Bira 91 Superfresh Natural White Beer .",
    "cases": 12,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 1200,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-13 06:18:14] Item 2 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMBR0031824"
}
[2025-12-13 06:18:14] Processing item 3: {
    "item_code": "SCMBR0039553",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 14,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 1120,
    "tot_bott": 14,
    "bl": 9.1
}
[2025-12-13 06:18:14] Item 3 inserted successfully: {
    "purchase_id": 5,
    "item_code": "SCMBR0039553"
}
[2025-12-13 06:18:14] Purchase items processing completed: {
    "successful_items": 4,
    "total_items": 4
}
[2025-12-13 06:18:14] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:19:38] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:19:38] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:19:38] POST data: []
[2025-12-13 06:19:38] GET data: {
    "mode": "F"
}
[2025-12-13 06:19:38] Company ID from session: 1
[2025-12-13 06:19:38] Database connection included
[2025-12-13 06:19:38] License functions included
[2025-12-13 06:19:38] License type: FL-II
[2025-12-13 06:19:38] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:19:38] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:19:38] Purchase mode: F
[2025-12-13 06:19:38] Next voucher number: 1
[2025-12-13 06:19:38] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:19:38] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:19:38] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:19:39] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:19:39] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:19:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:19:39] POST data: []
[2025-12-13 06:19:39] GET data: {
    "mode": "F"
}
[2025-12-13 06:19:39] Company ID from session: 1
[2025-12-13 06:19:39] Database connection included
[2025-12-13 06:19:39] License functions included
[2025-12-13 06:19:39] License type: FL-II
[2025-12-13 06:19:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:19:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:19:39] Purchase mode: F
[2025-12-13 06:19:39] Next voucher number: 1
[2025-12-13 06:19:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:19:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:19:39] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:19:39] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:19:39] Database connection closed
[2025-12-13 06:19:39] === PURCHASE SESSION ENDED ===
[2025-12-13 06:19:50] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:19:50] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:19:50] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-19",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "246",
            "auto_batch": "BTBL2-071125\/649",
            "mfg_month": "Nov-2025",
            "bl": "195",
            "vv": "8",
            "tot_bott": "300",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "25",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0018627",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "534",
            "auto_batch": "BTBL7-011125\/534",
            "mfg_month": "Nov-2025",
            "bl": "60",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "3500.00",
    "tamt": "3500.00"
}
[2025-12-13 06:19:50] GET data: {
    "mode": "F"
}
[2025-12-13 06:19:50] Company ID from session: 1
[2025-12-13 06:19:50] Database connection included
[2025-12-13 06:19:50] License functions included
[2025-12-13 06:19:50] License type: FL-II
[2025-12-13 06:19:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:19:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:19:50] Purchase mode: F
[2025-12-13 06:19:50] Next voucher number: 1
[2025-12-13 06:19:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:19:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:19:50] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:19:50] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:19:50] === FORM SUBMISSION STARTED ===
[2025-12-13 06:19:50] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "1",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "3500.00",
    "total_amt": "3500.00"
}
[2025-12-13 06:19:50] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "RAJ",
        "FL119851-191125\/5139",
        "1",
        "",
        "",
        "3500.00",
        "5139",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:19:50] Purchase header inserted successfully: {
    "purchase_id": 6,
    "affected_rows": 1
}
[2025-12-13 06:19:50] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-13 06:19:50] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 25,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3000,
    "tot_bott": 300,
    "bl": 195
}
[2025-12-13 06:19:50] Item 0 inserted successfully: {
    "purchase_id": 6,
    "item_code": "SCMBR0009846"
}
[2025-12-13 06:19:50] Processing item 1: {
    "item_code": "SCMBR0018627",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 120,
    "bl": 60
}
[2025-12-13 06:19:50] Item 1 inserted successfully: {
    "purchase_id": 6,
    "item_code": "SCMBR0018627"
}
[2025-12-13 06:19:51] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-13 06:19:51] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:21:53] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:21:53] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:21:53] POST data: []
[2025-12-13 06:21:53] GET data: {
    "mode": "F"
}
[2025-12-13 06:21:53] Company ID from session: 1
[2025-12-13 06:21:53] Database connection included
[2025-12-13 06:21:53] License functions included
[2025-12-13 06:21:53] License type: FL-II
[2025-12-13 06:21:53] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:21:53] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:21:53] Purchase mode: F
[2025-12-13 06:21:53] Next voucher number: 2
[2025-12-13 06:21:53] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:21:53] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:21:53] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:21:53] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:21:53] Database connection closed
[2025-12-13 06:21:53] === PURCHASE SESSION ENDED ===
[2025-12-13 06:22:37] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:22:37] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:22:37] POST data: []
[2025-12-13 06:22:37] GET data: {
    "mode": "F"
}
[2025-12-13 06:22:37] Company ID from session: 1
[2025-12-13 06:22:37] Database connection included
[2025-12-13 06:22:37] License functions included
[2025-12-13 06:22:37] License type: FL-II
[2025-12-13 06:22:37] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:22:37] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:22:37] Purchase mode: F
[2025-12-13 06:22:37] Next voucher number: 2
[2025-12-13 06:22:37] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:22:37] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:22:37] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:22:37] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:22:37] Database connection closed
[2025-12-13 06:22:37] === PURCHASE SESSION ENDED ===
[2025-12-13 06:22:57] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:22:57] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:22:57] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-18",
    "auto_tp_no": "FL167-181125\/17082",
    "tp_no": "17081",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "SAMBARAGI TRADERS",
    "supplier_code": "SAMB",
    "items": [
        {
            "code": "SCMPL0029935",
            "name": "Signature Premier Grain Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "015",
            "auto_batch": "BTP4-070225\/1251",
            "mfg_month": "Feb-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMPL0036330",
            "name": "Signature Rare Aged Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "028",
            "auto_batch": "BTP4-010925\/506",
            "mfg_month": "Oct-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "190"
        },
        {
            "code": "SCMPL0040198",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "2000 ML Pet (6)",
            "bottles_per_case": "6",
            "batch_no": "297",
            "auto_batch": "BTP4-131025\/587",
            "mfg_month": "Oct-2025",
            "bl": "36",
            "vv": "25",
            "tot_bott": "18",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "2400"
        },
        {
            "code": "SCMPL0040202",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "323",
            "auto_batch": "BTP4-011125\/639",
            "mfg_month": "Nov-2025",
            "bl": "35.1",
            "vv": "25",
            "tot_bott": "195",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "4",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "220"
        },
        {
            "code": "SCMPL0040202",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "326",
            "auto_batch": "BTP4-041125\/651",
            "mfg_month": "Nov-2025",
            "bl": "180.9",
            "vv": "25",
            "tot_bott": "1005",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "20",
            "bottles": "45",
            "case_rate": "120.000",
            "mrp": "220"
        },
        {
            "code": "SCMPL0040203",
            "name": "McDowell\\'s No.1 Original Blended Whisky .",
            "size": "90 ML (Pet)-100",
            "bottles_per_case": "100",
            "batch_no": "722",
            "auto_batch": "BTP29-151025\/722",
            "mfg_month": "Oct-2025",
            "bl": "90",
            "vv": "25",
            "tot_bott": "1000",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "120"
        },
        {
            "code": "SCMPL0040204",
            "name": "McDowell\\'s No.1 Luxury Blended Whisky .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "685",
            "auto_batch": "BTP29-041025\/685",
            "mfg_month": "Oct-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "940"
        },
        {
            "code": "SCMPL0040206",
            "name": "McDowell\\'s No.1 Luxury Blended Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "589",
            "auto_batch": "BTP29-280825\/589",
            "mfg_month": "Sep-2025",
            "bl": "25.92",
            "vv": "25",
            "tot_bott": "144",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "230"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "12400.00",
    "tamt": "12400.00"
}
[2025-12-13 06:22:57] GET data: {
    "mode": "F"
}
[2025-12-13 06:22:57] Company ID from session: 1
[2025-12-13 06:22:57] Database connection included
[2025-12-13 06:22:57] License functions included
[2025-12-13 06:22:57] License type: FL-II
[2025-12-13 06:22:57] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:22:57] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:22:57] Purchase mode: F
[2025-12-13 06:22:57] Next voucher number: 2
[2025-12-13 06:22:57] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:22:57] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:22:57] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:22:57] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:22:57] === FORM SUBMISSION STARTED ===
[2025-12-13 06:22:57] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "2",
    "auto_tp_no": "FL167-181125\/17082",
    "tp_no": "17081",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "SAMB",
    "supplier_name": "SAMBARAGI TRADERS",
    "basic_amt": "12400.00",
    "total_amt": "12400.00"
}
[2025-12-13 06:22:57] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-18",
        "SAMB",
        "FL167-181125\/17082",
        "2",
        "",
        "",
        "12400.00",
        "17081",
        "2025-11-18",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:22:57] Purchase header inserted successfully: {
    "purchase_id": 7,
    "affected_rows": 1
}
[2025-12-13 06:22:57] Starting to process purchase items: {
    "item_count": 8
}
[2025-12-13 06:22:57] Processing item 0: {
    "item_code": "SCMPL0029935",
    "item_name": "Signature Premier Grain Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-13 06:22:57] Item 0 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0029935"
}
[2025-12-13 06:22:57] Processing item 1: {
    "item_code": "SCMPL0036330",
    "item_name": "Signature Rare Aged Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 100,
    "bl": 9
}
[2025-12-13 06:22:57] Item 1 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0036330"
}
[2025-12-13 06:22:58] Processing item 2: {
    "item_code": "SCMPL0040198",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 2400,
    "tot_bott": 18,
    "bl": 36
}
[2025-12-13 06:22:58] Item 2 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0040198"
}
[2025-12-13 06:22:58] Processing item 3: {
    "item_code": "SCMPL0040202",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 4,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 840,
    "tot_bott": 195,
    "bl": 35.1
}
[2025-12-13 06:22:58] Item 3 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0040202"
}
[2025-12-13 06:22:58] Processing item 4: {
    "item_code": "SCMPL0040202",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 20,
    "bottles": 45,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 7800,
    "tot_bott": 1005,
    "bl": 180.9
}
[2025-12-13 06:22:58] Item 4 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0040202"
}
[2025-12-13 06:22:59] Processing item 5: {
    "item_code": "SCMPL0040203",
    "item_name": "McDowell\\'s No.1 Original Blended Whisky .",
    "cases": 10,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 800,
    "tot_bott": 1000,
    "bl": 90
}
[2025-12-13 06:22:59] Item 5 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0040203"
}
[2025-12-13 06:22:59] Processing item 6: {
    "item_code": "SCMPL0040204",
    "item_name": "McDowell\\'s No.1 Luxury Blended Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-13 06:22:59] Item 6 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0040204"
}
[2025-12-13 06:23:00] Processing item 7: {
    "item_code": "SCMPL0040206",
    "item_name": "McDowell\\'s No.1 Luxury Blended Whisky .",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 240,
    "tot_bott": 144,
    "bl": 25.92
}
[2025-12-13 06:23:00] Item 7 inserted successfully: {
    "purchase_id": 7,
    "item_code": "SCMPL0040206"
}
[2025-12-13 06:23:00] Purchase items processing completed: {
    "successful_items": 8,
    "total_items": 8
}
[2025-12-13 06:23:00] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:24:25] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:24:25] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:24:25] POST data: []
[2025-12-13 06:24:25] GET data: {
    "mode": "F"
}
[2025-12-13 06:24:25] Company ID from session: 1
[2025-12-13 06:24:25] Database connection included
[2025-12-13 06:24:26] License functions included
[2025-12-13 06:24:26] License type: FL-II
[2025-12-13 06:24:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:24:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:24:26] Purchase mode: F
[2025-12-13 06:24:26] Next voucher number: 1
[2025-12-13 06:24:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:24:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:24:26] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:24:26] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:24:26] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:24:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:24:26] POST data: []
[2025-12-13 06:24:26] GET data: {
    "mode": "F"
}
[2025-12-13 06:24:26] Company ID from session: 1
[2025-12-13 06:24:26] Database connection included
[2025-12-13 06:24:26] License functions included
[2025-12-13 06:24:26] License type: FL-II
[2025-12-13 06:24:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:24:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:24:26] Purchase mode: F
[2025-12-13 06:24:26] Next voucher number: 1
[2025-12-13 06:24:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:24:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:24:26] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:24:26] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:24:26] Database connection closed
[2025-12-13 06:24:26] === PURCHASE SESSION ENDED ===
[2025-12-13 06:24:38] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:24:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:24:39] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-17",
    "auto_tp_no": "FL170-171125\/23972",
    "tp_no": "23972",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMPL0010445",
            "name": "Directors Special Black Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "369",
            "auto_batch": "BTP17-090825\/369",
            "mfg_month": "Aug-2025",
            "bl": "43.2",
            "vv": "25",
            "tot_bott": "240",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMPL0010480",
            "name": "McDowell\\'s No.1 Celebration XXX Matured Rum .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "169",
            "auto_batch": "BTP59-301025\/169",
            "mfg_month": "Nov-2025",
            "bl": "43.2",
            "vv": "25",
            "tot_bott": "240",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "205"
        },
        {
            "code": "SCMPL0040788",
            "name": "Directors Special Black Deluxe Whisky .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "740",
            "auto_batch": "BTP29-241025\/740",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "210"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1900.00",
    "tamt": "1900.00"
}
[2025-12-13 06:24:39] GET data: {
    "mode": "F"
}
[2025-12-13 06:24:39] Company ID from session: 1
[2025-12-13 06:24:39] Database connection included
[2025-12-13 06:24:39] License functions included
[2025-12-13 06:24:39] License type: FL-II
[2025-12-13 06:24:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:24:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:24:39] Purchase mode: F
[2025-12-13 06:24:39] Next voucher number: 1
[2025-12-13 06:24:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:24:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:24:39] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:24:39] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:24:39] === FORM SUBMISSION STARTED ===
[2025-12-13 06:24:39] Form data extracted: {
    "date": "2025-11-17",
    "voc_no": "1",
    "auto_tp_no": "FL170-171125\/23972",
    "tp_no": "23972",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "1900.00",
    "total_amt": "1900.00"
}
[2025-12-13 06:24:39] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-17",
        "HARE",
        "FL170-171125\/23972",
        "1",
        "",
        "",
        "1900.00",
        "23972",
        "2025-11-17",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:24:39] Purchase header inserted successfully: {
    "purchase_id": 8,
    "affected_rows": 1
}
[2025-12-13 06:24:39] Starting to process purchase items: {
    "item_count": 3
}
[2025-12-13 06:24:39] Processing item 0: {
    "item_code": "SCMPL0010445",
    "item_name": "Directors Special Black Deluxe Whisky .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 600,
    "tot_bott": 240,
    "bl": 43.2
}
[2025-12-13 06:24:39] Item 0 inserted successfully: {
    "purchase_id": 8,
    "item_code": "SCMPL0010445"
}
[2025-12-13 06:24:39] Processing item 1: {
    "item_code": "SCMPL0010480",
    "item_name": "McDowell\\'s No.1 Celebration XXX Matured Rum .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 240,
    "bl": 43.2
}
[2025-12-13 06:24:39] Item 1 inserted successfully: {
    "purchase_id": 8,
    "item_code": "SCMPL0010480"
}
[2025-12-13 06:24:40] Processing item 2: {
    "item_code": "SCMPL0040788",
    "item_name": "Directors Special Black Deluxe Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-12-13 06:24:40] Item 2 inserted successfully: {
    "purchase_id": 8,
    "item_code": "SCMPL0040788"
}
[2025-12-13 06:24:40] Purchase items processing completed: {
    "successful_items": 3,
    "total_items": 3
}
[2025-12-13 06:24:40] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:25:27] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:25:27] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:25:27] POST data: []
[2025-12-13 06:25:27] GET data: {
    "mode": "F"
}
[2025-12-13 06:25:27] Company ID from session: 1
[2025-12-13 06:25:27] Database connection included
[2025-12-13 06:25:27] License functions included
[2025-12-13 06:25:27] License type: FL-II
[2025-12-13 06:25:27] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:25:27] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:25:27] Purchase mode: F
[2025-12-13 06:25:28] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:25:28] Next voucher number: 2
[2025-12-13 06:25:28] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:25:28] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:25:28] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:25:28] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:25:28] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:25:28] POST data: []
[2025-12-13 06:25:28] GET data: {
    "mode": "F"
}
[2025-12-13 06:25:28] Company ID from session: 1
[2025-12-13 06:25:28] Database connection included
[2025-12-13 06:25:28] License functions included
[2025-12-13 06:25:28] License type: FL-II
[2025-12-13 06:25:28] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:25:28] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:25:28] Purchase mode: F
[2025-12-13 06:25:28] Next voucher number: 2
[2025-12-13 06:25:28] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:25:28] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:25:28] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:25:28] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:25:28] Database connection closed
[2025-12-13 06:25:28] === PURCHASE SESSION ENDED ===
[2025-12-13 06:25:37] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:25:37] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:25:37] POST data: []
[2025-12-13 06:25:37] GET data: {
    "mode": "F"
}
[2025-12-13 06:25:37] Company ID from session: 1
[2025-12-13 06:25:37] Database connection included
[2025-12-13 06:25:37] License functions included
[2025-12-13 06:25:37] License type: FL-II
[2025-12-13 06:25:37] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:25:37] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:25:37] Purchase mode: F
[2025-12-13 06:25:37] Next voucher number: 2
[2025-12-13 06:25:37] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:25:37] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:25:38] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:25:38] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:25:38] Database connection closed
[2025-12-13 06:25:38] === PURCHASE SESSION ENDED ===
[2025-12-13 06:25:55] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:25:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:25:55] POST data: []
[2025-12-13 06:25:55] GET data: {
    "mode": "F"
}
[2025-12-13 06:25:55] Company ID from session: 1
[2025-12-13 06:25:55] Database connection included
[2025-12-13 06:25:55] License functions included
[2025-12-13 06:25:55] License type: FL-II
[2025-12-13 06:25:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:25:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:25:55] Purchase mode: F
[2025-12-13 06:25:55] Next voucher number: 2
[2025-12-13 06:25:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:25:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:25:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:25:55] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:25:55] Database connection closed
[2025-12-13 06:25:55] === PURCHASE SESSION ENDED ===
[2025-12-13 06:26:08] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:26:08] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:26:08] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-19",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "246",
            "auto_batch": "BTBL2-071125\/649",
            "mfg_month": "Nov-2025",
            "bl": "195",
            "vv": "8",
            "tot_bott": "300",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "25",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0018627",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "534",
            "auto_batch": "BTBL7-011125\/534",
            "mfg_month": "Nov-2025",
            "bl": "60",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "3500.00",
    "tamt": "3500.00"
}
[2025-12-13 06:26:08] GET data: {
    "mode": "F"
}
[2025-12-13 06:26:08] Company ID from session: 1
[2025-12-13 06:26:08] Database connection included
[2025-12-13 06:26:08] License functions included
[2025-12-13 06:26:08] License type: FL-II
[2025-12-13 06:26:08] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:26:08] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:26:08] Purchase mode: F
[2025-12-13 06:26:08] Next voucher number: 2
[2025-12-13 06:26:08] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:26:08] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:26:08] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:26:08] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:26:08] === FORM SUBMISSION STARTED ===
[2025-12-13 06:26:08] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "2",
    "auto_tp_no": "FL119851-191125\/5139",
    "tp_no": "5139",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "3500.00",
    "total_amt": "3500.00"
}
[2025-12-13 06:26:08] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "RAJ",
        "FL119851-191125\/5139",
        "2",
        "",
        "",
        "3500.00",
        "5139",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:26:08] Purchase header inserted successfully: {
    "purchase_id": 9,
    "affected_rows": 1
}
[2025-12-13 06:26:08] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-13 06:26:08] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 25,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 3000,
    "tot_bott": 300,
    "bl": 195
}
[2025-12-13 06:26:09] Item 0 inserted successfully: {
    "purchase_id": 9,
    "item_code": "SCMBR0009846"
}
[2025-12-13 06:26:09] Processing item 1: {
    "item_code": "SCMBR0018627",
    "item_name": "Kingfisher Strong Premium Beer .",
    "cases": 5,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 500,
    "tot_bott": 120,
    "bl": 60
}
[2025-12-13 06:26:09] Item 1 inserted successfully: {
    "purchase_id": 9,
    "item_code": "SCMBR0018627"
}
[2025-12-13 06:26:09] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-13 06:26:09] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:27:29] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:27:29] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:27:29] POST data: []
[2025-12-13 06:27:29] GET data: {
    "mode": "F"
}
[2025-12-13 06:27:29] Company ID from session: 1
[2025-12-13 06:27:29] Database connection included
[2025-12-13 06:27:29] License functions included
[2025-12-13 06:27:29] License type: FL-II
[2025-12-13 06:27:29] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:27:29] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:27:29] Purchase mode: F
[2025-12-13 06:27:29] Next voucher number: 3
[2025-12-13 06:27:29] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:27:29] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:27:29] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:27:29] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:27:29] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:27:29] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:27:29] POST data: []
[2025-12-13 06:27:29] GET data: {
    "mode": "F"
}
[2025-12-13 06:27:29] Company ID from session: 1
[2025-12-13 06:27:29] Database connection included
[2025-12-13 06:27:29] License functions included
[2025-12-13 06:27:29] License type: FL-II
[2025-12-13 06:27:29] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:27:29] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:27:29] Purchase mode: F
[2025-12-13 06:27:29] Next voucher number: 3
[2025-12-13 06:27:29] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:27:29] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:27:30] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:27:30] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:27:30] Database connection closed
[2025-12-13 06:27:30] === PURCHASE SESSION ENDED ===
[2025-12-13 06:27:39] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:27:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:27:39] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-11-18",
    "auto_tp_no": "FL170-181125\/24156",
    "tp_no": "24156",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMPL0038688",
            "name": "Royal Challenge American Pride Classic Gold Whisky",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "89",
            "auto_batch": "BTP27-050925\/89",
            "mfg_month": "Sep-2025",
            "bl": "8.64",
            "vv": "42.8",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "380"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-13 06:27:39] GET data: {
    "mode": "F"
}
[2025-12-13 06:27:39] Company ID from session: 1
[2025-12-13 06:27:39] Database connection included
[2025-12-13 06:27:39] License functions included
[2025-12-13 06:27:39] License type: FL-II
[2025-12-13 06:27:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:27:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:27:39] Purchase mode: F
[2025-12-13 06:27:39] Next voucher number: 3
[2025-12-13 06:27:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:27:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:27:39] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:27:39] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:27:39] === FORM SUBMISSION STARTED ===
[2025-12-13 06:27:39] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "3",
    "auto_tp_no": "FL170-181125\/24156",
    "tp_no": "24156",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-13 06:27:39] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-18",
        "HARE",
        "FL170-181125\/24156",
        "3",
        "",
        "",
        "800.00",
        "24156",
        "2025-11-18",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:27:39] Purchase header inserted successfully: {
    "purchase_id": 10,
    "affected_rows": 1
}
[2025-12-13 06:27:39] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-13 06:27:39] Processing item 0: {
    "item_code": "SCMPL0038688",
    "item_name": "Royal Challenge American Pride Classic Gold Whisky",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 800,
    "amount": 800,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-12-13 06:27:39] Item 0 inserted successfully: {
    "purchase_id": 10,
    "item_code": "SCMPL0038688"
}
[2025-12-13 06:27:39] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-12-13 06:27:39] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:30:30] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:30:30] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:30:30] POST data: []
[2025-12-13 06:30:30] GET data: {
    "mode": "F"
}
[2025-12-13 06:30:30] Company ID from session: 1
[2025-12-13 06:30:30] Database connection included
[2025-12-13 06:30:30] License functions included
[2025-12-13 06:30:30] License type: FL-II
[2025-12-13 06:30:30] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:30:30] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:30:30] Purchase mode: F
[2025-12-13 06:30:30] Next voucher number: 4
[2025-12-13 06:30:30] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:30:30] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:30:30] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:30:30] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:30:30] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:30:30] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:30:30] POST data: []
[2025-12-13 06:30:30] GET data: {
    "mode": "F"
}
[2025-12-13 06:30:30] Company ID from session: 1
[2025-12-13 06:30:31] Database connection included
[2025-12-13 06:30:31] License functions included
[2025-12-13 06:30:31] License type: FL-II
[2025-12-13 06:30:31] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:30:31] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:30:31] Purchase mode: F
[2025-12-13 06:30:31] Next voucher number: 4
[2025-12-13 06:30:31] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:30:31] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:30:31] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:30:31] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:30:31] Database connection closed
[2025-12-13 06:30:31] === PURCHASE SESSION ENDED ===
[2025-12-13 06:30:40] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:30:40] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:30:40] POST data: []
[2025-12-13 06:30:40] GET data: {
    "mode": "F"
}
[2025-12-13 06:30:40] Company ID from session: 1
[2025-12-13 06:30:40] Database connection included
[2025-12-13 06:30:40] License functions included
[2025-12-13 06:30:40] License type: FL-II
[2025-12-13 06:30:40] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:30:40] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:30:40] Purchase mode: F
[2025-12-13 06:30:40] Next voucher number: 4
[2025-12-13 06:30:40] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:30:40] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:30:40] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:30:40] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:30:40] Database connection closed
[2025-12-13 06:30:40] === PURCHASE SESSION ENDED ===
[2025-12-13 06:30:55] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:30:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:30:55] POST data: {
    "mode": "F",
    "voc_no": "4",
    "date": "2025-11-19",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMLS0019502",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "50 ML(120)",
            "bottles_per_case": "120",
            "batch_no": "LC6V1033",
            "auto_batch": "BTOI249-294",
            "mfg_month": "Mar-2024",
            "bl": "6",
            "vv": "43",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "210"
        },
        {
            "code": "SCMLS0019504",
            "name": "BALLANTINE\\'S FINEST SCOTCH .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "1045",
            "auto_batch": "BTOI249-391",
            "mfg_month": "Feb-2024",
            "bl": "18",
            "vv": "43",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "2400"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3185",
            "auto_batch": "BTOI249-280",
            "mfg_month": "Jul-2023",
            "bl": "6.75",
            "vv": "13",
            "tot_bott": "9",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "9",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019523",
            "name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L3248",
            "auto_batch": "BTOI249-305",
            "mfg_month": "Sep-2023",
            "bl": "2.25",
            "vv": "13",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "120.000",
            "mrp": "1600"
        },
        {
            "code": "SCMLW0019524",
            "name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
            "size": "750 ML",
            "bottles_per_case": "1",
            "batch_no": "L4311",
            "auto_batch": "BTOI249-382",
            "mfg_month": "Nov-2024",
            "bl": "9",
            "vv": "13.9",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "1600"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "1880.00",
    "tamt": "1880.00"
}
[2025-12-13 06:30:55] GET data: {
    "mode": "F"
}
[2025-12-13 06:30:55] Company ID from session: 1
[2025-12-13 06:30:55] Database connection included
[2025-12-13 06:30:55] License functions included
[2025-12-13 06:30:55] License type: FL-II
[2025-12-13 06:30:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:30:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:30:55] Purchase mode: F
[2025-12-13 06:30:55] Next voucher number: 4
[2025-12-13 06:30:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:30:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:30:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:30:55] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:30:55] === FORM SUBMISSION STARTED ===
[2025-12-13 06:30:55] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "4",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "4565",
    "tp_date": "2025-11-19",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "1880.00",
    "total_amt": "1880.00"
}
[2025-12-13 06:30:55] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-19",
        "EM2",
        "FL1249-191125\/4540",
        "4",
        "",
        "",
        "1880.00",
        "4565",
        "2025-11-19",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:30:55] Purchase header inserted successfully: {
    "purchase_id": 11,
    "affected_rows": 1
}
[2025-12-13 06:30:55] Starting to process purchase items: {
    "item_count": 5
}
[2025-12-13 06:30:55] Processing item 0: {
    "item_code": "SCMLS0019502",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 120,
    "bl": 6
}
[2025-12-13 06:30:55] Item 0 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLS0019502"
}
[2025-12-13 06:30:56] Processing item 1: {
    "item_code": "SCMLS0019504",
    "item_name": "BALLANTINE\\'S FINEST SCOTCH .",
    "cases": 2,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 240,
    "tot_bott": 24,
    "bl": 18
}
[2025-12-13 06:30:56] Item 1 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLS0019504"
}
[2025-12-13 06:30:56] Processing item 2: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 9,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 1080,
    "tot_bott": 9,
    "bl": 6.75
}
[2025-12-13 06:30:56] Item 2 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLW0019523"
}
[2025-12-13 06:30:57] Processing item 3: {
    "item_code": "SCMLW0019523",
    "item_name": "JACOB\\'S CREEK CLASSIC CHARDONNAY .",
    "cases": 0,
    "bottles": 3,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 360,
    "tot_bott": 3,
    "bl": 2.25
}
[2025-12-13 06:30:57] Item 3 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLW0019523"
}
[2025-12-13 06:30:57] Processing item 4: {
    "item_code": "SCMLW0019524",
    "item_name": "JACOB\\'S CREEK CLASSIC SHIRAZ CABERNET .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 12,
    "bl": 9
}
[2025-12-13 06:30:57] Item 4 inserted successfully: {
    "purchase_id": 11,
    "item_code": "SCMLW0019524"
}
[2025-12-13 06:30:58] Purchase items processing completed: {
    "successful_items": 5,
    "total_items": 5
}
[2025-12-13 06:30:58] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:47:03] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:47:03] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:47:03] POST data: []
[2025-12-13 06:47:03] GET data: {
    "mode": "F"
}
[2025-12-13 06:47:03] Company ID from session: 1
[2025-12-13 06:47:03] Database connection included
[2025-12-13 06:47:03] License functions included
[2025-12-13 06:47:03] License type: FL-II
[2025-12-13 06:47:03] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:47:03] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:47:03] Purchase mode: F
[2025-12-13 06:47:03] Next voucher number: 5
[2025-12-13 06:47:03] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:47:03] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:47:03] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:47:03] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:47:03] Database connection closed
[2025-12-13 06:47:03] === PURCHASE SESSION ENDED ===
[2025-12-13 06:47:23] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:47:23] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:47:23] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-12-13",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.00",
            "vv": "0",
            "tot_bott": "0",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-13 06:47:23] GET data: {
    "mode": "F"
}
[2025-12-13 06:47:23] Company ID from session: 1
[2025-12-13 06:47:23] Database connection included
[2025-12-13 06:47:23] License functions included
[2025-12-13 06:47:23] License type: FL-II
[2025-12-13 06:47:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:47:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:47:23] Purchase mode: F
[2025-12-13 06:47:23] Next voucher number: 5
[2025-12-13 06:47:23] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:47:23] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:47:23] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:47:23] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:47:23] === FORM SUBMISSION STARTED ===
[2025-12-13 06:47:23] Form data extracted: {
    "date": "2025-12-13",
    "voc_no": "5",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-13 06:47:23] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-13",
        "AMAR",
        "FL1305-310825\/7654",
        "5",
        "",
        "",
        "0.00",
        "7654",
        "",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:47:23] Purchase header inserted successfully: {
    "purchase_id": 12,
    "affected_rows": 1
}
[2025-12-13 06:47:23] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-13 06:47:23] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 0,
    "tot_bott": 0,
    "bl": 0
}
[2025-12-13 06:47:23] Item 0 inserted successfully: {
    "purchase_id": 12,
    "item_code": "SCMPL0019028"
}
[2025-12-13 06:47:23] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-12-13 06:47:23] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:47:49] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:47:49] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:47:49] POST data: []
[2025-12-13 06:47:49] GET data: {
    "mode": "F"
}
[2025-12-13 06:47:49] Company ID from session: 1
[2025-12-13 06:47:49] Database connection included
[2025-12-13 06:47:49] License functions included
[2025-12-13 06:47:49] License type: FL-II
[2025-12-13 06:47:49] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:47:49] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:47:49] Purchase mode: F
[2025-12-13 06:47:49] Next voucher number: 5
[2025-12-13 06:47:49] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:47:49] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:47:49] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:47:49] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:47:50] Database connection closed
[2025-12-13 06:47:50] === PURCHASE SESSION ENDED ===
[2025-12-13 06:48:13] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:48:13] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:48:13] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-12-13",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.00",
            "vv": "0",
            "tot_bott": "0",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-13 06:48:13] GET data: {
    "mode": "F"
}
[2025-12-13 06:48:13] Company ID from session: 1
[2025-12-13 06:48:13] Database connection included
[2025-12-13 06:48:13] License functions included
[2025-12-13 06:48:13] License type: FL-II
[2025-12-13 06:48:13] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:48:13] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:48:13] Purchase mode: F
[2025-12-13 06:48:13] Next voucher number: 5
[2025-12-13 06:48:13] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:48:13] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:48:13] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:48:13] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:48:13] === FORM SUBMISSION STARTED ===
[2025-12-13 06:48:13] Form data extracted: {
    "date": "2025-12-13",
    "voc_no": "5",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-13 06:48:13] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-13",
        "AMAR",
        "FL1305-310825\/7654",
        "5",
        "",
        "",
        "0.00",
        "7654",
        "2025-12-13",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:48:13] Purchase header inserted successfully: {
    "purchase_id": 13,
    "affected_rows": 1
}
[2025-12-13 06:48:13] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-13 06:48:13] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 0,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 0,
    "tot_bott": 0,
    "bl": 0
}
[2025-12-13 06:48:13] Item 0 inserted successfully: {
    "purchase_id": 13,
    "item_code": "SCMPL0019028"
}
[2025-12-13 06:48:13] Purchase items processing completed: {
    "successful_items": 1,
    "total_items": 1
}
[2025-12-13 06:48:13] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:48:19] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:48:19] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:48:19] POST data: []
[2025-12-13 06:48:19] GET data: {
    "mode": "F"
}
[2025-12-13 06:48:19] Company ID from session: 1
[2025-12-13 06:48:19] Database connection included
[2025-12-13 06:48:19] License functions included
[2025-12-13 06:48:19] License type: FL-II
[2025-12-13 06:48:19] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:48:19] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:48:19] Purchase mode: F
[2025-12-13 06:48:19] Next voucher number: 5
[2025-12-13 06:48:19] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:48:19] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:48:19] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:48:19] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:48:19] Database connection closed
[2025-12-13 06:48:19] === PURCHASE SESSION ENDED ===
[2025-12-13 06:49:41] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:49:41] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:49:41] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-12-13",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ELKAY SPIRITS",
    "supplier_code": "EKY",
    "items": {
        "0": {
            "code": "SCMPL0019028",
            "name": "20-20 Fine Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "8.64",
            "vv": "0",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        "1": {
            "code": "SCMBR0041385",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "330 ML(12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "3.96",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        },
        "3": {
            "code": "SCMBR0027987",
            "name": "Bira 91 Gold Wheat Strong Beer .",
            "size": "500 ML (12)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "6.00",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        },
        "4": {
            "code": "SCMWN0020397",
            "name": "Amora Red Wine .",
            "size": "375 ML",
            "bottles_per_case": "24",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "9.00",
            "vv": "0",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "0"
        }
    },
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "420.00",
    "tamt": "420.00"
}
[2025-12-13 06:49:41] GET data: {
    "mode": "F"
}
[2025-12-13 06:49:41] Company ID from session: 1
[2025-12-13 06:49:41] Database connection included
[2025-12-13 06:49:41] License functions included
[2025-12-13 06:49:41] License type: FL-II
[2025-12-13 06:49:41] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:49:41] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:49:41] Purchase mode: F
[2025-12-13 06:49:41] Next voucher number: 5
[2025-12-13 06:49:41] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:49:41] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:49:41] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:49:41] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:49:41] === FORM SUBMISSION STARTED ===
[2025-12-13 06:49:41] Form data extracted: {
    "date": "2025-12-13",
    "voc_no": "5",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EKY",
    "supplier_name": "ELKAY SPIRITS",
    "basic_amt": "420.00",
    "total_amt": "420.00"
}
[2025-12-13 06:49:41] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-13",
        "EKY",
        "FL1305-310825\/7654",
        "5",
        "",
        "",
        "420.00",
        "7654",
        "2025-12-13",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:49:41] Purchase header inserted successfully: {
    "purchase_id": 14,
    "affected_rows": 1
}
[2025-12-13 06:49:41] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-13 06:49:41] Processing item 0: {
    "item_code": "SCMPL0019028",
    "item_name": "20-20 Fine Whisky .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 96,
    "bl": 8.64
}
[2025-12-13 06:49:41] Item 0 inserted successfully: {
    "purchase_id": 14,
    "item_code": "SCMPL0019028"
}
[2025-12-13 06:49:41] Processing item 1: {
    "item_code": "SCMBR0041385",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 12,
    "bl": 3.96
}
[2025-12-13 06:49:41] Item 1 inserted successfully: {
    "purchase_id": 14,
    "item_code": "SCMBR0041385"
}
[2025-12-13 06:49:41] Processing item 3: {
    "item_code": "SCMBR0027987",
    "item_name": "Bira 91 Gold Wheat Strong Beer .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 12,
    "bl": 6
}
[2025-12-13 06:49:41] Item 3 inserted successfully: {
    "purchase_id": 14,
    "item_code": "SCMBR0027987"
}
[2025-12-13 06:49:41] Processing item 4: {
    "item_code": "SCMWN0020397",
    "item_name": "Amora Red Wine .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 100,
    "amount": 100,
    "tot_bott": 24,
    "bl": 9
}
[2025-12-13 06:49:41] Item 4 inserted successfully: {
    "purchase_id": 14,
    "item_code": "SCMWN0020397"
}
[2025-12-13 06:49:41] Purchase items processing completed: {
    "successful_items": 4,
    "total_items": 4
}
[2025-12-13 06:49:41] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:50:24] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:50:24] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:50:24] POST data: []
[2025-12-13 06:50:24] GET data: {
    "mode": "F"
}
[2025-12-13 06:50:24] Company ID from session: 1
[2025-12-13 06:50:24] Database connection included
[2025-12-13 06:50:24] License functions included
[2025-12-13 06:50:24] License type: FL-II
[2025-12-13 06:50:24] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:50:24] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:50:24] Purchase mode: F
[2025-12-13 06:50:24] Next voucher number: 6
[2025-12-13 06:50:24] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:50:24] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:50:25] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:50:25] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:50:25] Database connection closed
[2025-12-13 06:50:25] === PURCHASE SESSION ENDED ===
[2025-12-13 06:51:17] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:51:17] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:51:17] POST data: []
[2025-12-13 06:51:17] GET data: {
    "mode": "F"
}
[2025-12-13 06:51:17] Company ID from session: 1
[2025-12-13 06:51:17] Database connection included
[2025-12-13 06:51:17] License functions included
[2025-12-13 06:51:17] License type: FL-II
[2025-12-13 06:51:17] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:51:17] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:51:17] Purchase mode: F
[2025-12-13 06:51:17] Next voucher number: 5
[2025-12-13 06:51:17] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:51:17] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:51:17] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:51:17] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:51:17] Database connection closed
[2025-12-13 06:51:17] === PURCHASE SESSION ENDED ===
[2025-12-13 06:51:49] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:51:49] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:51:49] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-12-13",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "",
    "items": [
        {
            "code": "SCMBR0039553",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.65",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "0"
        },
        {
            "code": "SCMBR0021532",
            "name": "Amstel Super Premium Strong beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.65",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "200.00",
    "tamt": "200.00"
}
[2025-12-13 06:51:49] GET data: {
    "mode": "F"
}
[2025-12-13 06:51:49] Company ID from session: 1
[2025-12-13 06:51:49] Database connection included
[2025-12-13 06:51:49] License functions included
[2025-12-13 06:51:49] License type: FL-II
[2025-12-13 06:51:49] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:51:49] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:51:49] Purchase mode: F
[2025-12-13 06:51:49] Next voucher number: 5
[2025-12-13 06:51:49] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:51:49] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:51:49] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:51:49] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:51:49] === FORM SUBMISSION STARTED ===
[2025-12-13 06:51:49] Form data extracted: {
    "date": "2025-12-13",
    "voc_no": "5",
    "auto_tp_no": "FL1305-310825\/7654",
    "tp_no": "7654",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "200.00",
    "total_amt": "200.00"
}
[2025-12-13 06:51:49] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-13",
        "",
        "FL1305-310825\/7654",
        "5",
        "",
        "",
        "200.00",
        "7654",
        "2025-12-13",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:51:49] Purchase header inserted successfully: {
    "purchase_id": 15,
    "affected_rows": 1
}
[2025-12-13 06:51:49] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-13 06:51:49] Processing item 0: {
    "item_code": "SCMBR0039553",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 1,
    "bl": 0.65
}
[2025-12-13 06:51:49] Item 0 inserted successfully: {
    "purchase_id": 15,
    "item_code": "SCMBR0039553"
}
[2025-12-13 06:51:49] Processing item 1: {
    "item_code": "SCMBR0021532",
    "item_name": "Amstel Super Premium Strong beer .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 1,
    "bl": 0.65
}
[2025-12-13 06:51:49] Item 1 inserted successfully: {
    "purchase_id": 15,
    "item_code": "SCMBR0021532"
}
[2025-12-13 06:51:49] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-13 06:51:49] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:52:01] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:52:01] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:52:01] POST data: []
[2025-12-13 06:52:01] GET data: {
    "mode": "F"
}
[2025-12-13 06:52:01] Company ID from session: 1
[2025-12-13 06:52:01] Database connection included
[2025-12-13 06:52:01] License functions included
[2025-12-13 06:52:01] License type: FL-II
[2025-12-13 06:52:01] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:52:02] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:52:02] Purchase mode: F
[2025-12-13 06:52:02] Next voucher number: 6
[2025-12-13 06:52:02] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:52:02] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:52:02] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:52:02] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:52:02] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:52:02] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:52:02] POST data: []
[2025-12-13 06:52:02] GET data: {
    "mode": "F"
}
[2025-12-13 06:52:02] Company ID from session: 1
[2025-12-13 06:52:02] Database connection included
[2025-12-13 06:52:02] License functions included
[2025-12-13 06:52:02] License type: FL-II
[2025-12-13 06:52:02] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:52:02] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:52:02] Purchase mode: F
[2025-12-13 06:52:02] Next voucher number: 6
[2025-12-13 06:52:02] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:52:02] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:52:02] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:52:02] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:52:02] Database connection closed
[2025-12-13 06:52:02] === PURCHASE SESSION ENDED ===
[2025-12-13 06:53:57] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:53:57] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:53:57] POST data: {
    "mode": "F",
    "voc_no": "6",
    "date": "2025-12-13",
    "auto_tp_no": "FL1249-191125\/2007",
    "tp_no": "2007",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMBR0039553",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.65",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "0"
        },
        {
            "code": "SCMBR0031825",
            "name": "Bira 91 Superfresh Natural White Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.50",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "200.00",
    "tamt": "200.00"
}
[2025-12-13 06:53:57] GET data: {
    "mode": "F"
}
[2025-12-13 06:53:57] Company ID from session: 1
[2025-12-13 06:53:57] Database connection included
[2025-12-13 06:53:57] License functions included
[2025-12-13 06:53:57] License type: FL-II
[2025-12-13 06:53:57] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:53:57] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:53:57] Purchase mode: F
[2025-12-13 06:53:57] Next voucher number: 6
[2025-12-13 06:53:57] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:53:57] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:53:57] === NEW PURCHASE SESSION STARTED ===
[2025-12-13 06:53:57] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:53:57] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:53:57] === FORM SUBMISSION STARTED ===
[2025-12-13 06:53:57] Form data extracted: {
    "date": "2025-12-13",
    "voc_no": "6",
    "auto_tp_no": "FL1249-191125\/2007",
    "tp_no": "2007",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "200.00",
    "total_amt": "200.00"
}
[2025-12-13 06:53:57] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-13",
        "HARE",
        "FL1249-191125\/2007",
        "6",
        "",
        "",
        "200.00",
        "2007",
        "2025-12-13",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:53:57] Purchase header inserted successfully: {
    "purchase_id": 16,
    "affected_rows": 1
}
[2025-12-13 06:53:57] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-13 06:53:57] Processing item 0: {
    "item_code": "SCMBR0039553",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 1,
    "bl": 0.65
}
[2025-12-13 06:53:57] Item 0 inserted successfully: {
    "purchase_id": 16,
    "item_code": "SCMBR0039553"
}
[2025-12-13 06:53:57] Processing item 1: {
    "item_code": "SCMBR0031825",
    "item_name": "Bira 91 Superfresh Natural White Beer .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 1,
    "bl": 0.5
}
[2025-12-13 06:53:57] Item 1 inserted successfully: {
    "purchase_id": 16,
    "item_code": "SCMBR0031825"
}
[2025-12-13 06:53:57] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-13 06:53:57] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-13 06:53:57] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Diamond Wine Shop"
}
[2025-12-13 06:53:57] POST data: {
    "mode": "F",
    "voc_no": "6",
    "date": "2025-12-13",
    "auto_tp_no": "FL1249-191125\/2007",
    "tp_no": "2007",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMBR0039553",
            "name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.65",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "0"
        },
        {
            "code": "SCMBR0031825",
            "name": "Bira 91 Superfresh Natural White Beer .",
            "size": "500 ML (CAN)",
            "bottles_per_case": "1",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "0.50",
            "vv": "0",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "200.00",
    "tamt": "200.00"
}
[2025-12-13 06:53:57] GET data: {
    "mode": "F"
}
[2025-12-13 06:53:57] Company ID from session: 1
[2025-12-13 06:53:57] Database connection included
[2025-12-13 06:53:57] License functions included
[2025-12-13 06:53:57] License type: FL-II
[2025-12-13 06:53:57] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-13 06:53:57] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-13 06:53:57] Purchase mode: F
[2025-12-13 06:53:57] Next voucher number: 7
[2025-12-13 06:53:57] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-13 06:53:57] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-13 06:53:57] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-13 06:53:57] Suppliers fetched: {
    "count": 36
}
[2025-12-13 06:53:57] === FORM SUBMISSION STARTED ===
[2025-12-13 06:53:57] Form data extracted: {
    "date": "2025-12-13",
    "voc_no": "6",
    "auto_tp_no": "FL1249-191125\/2007",
    "tp_no": "2007",
    "tp_date": "2025-12-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "200.00",
    "total_amt": "200.00"
}
[2025-12-13 06:53:57] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-12-13",
        "HARE",
        "FL1249-191125\/2007",
        "6",
        "",
        "",
        "200.00",
        "2007",
        "2025-12-13",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        1
    ]
}
[2025-12-13 06:53:57] Purchase header inserted successfully: {
    "purchase_id": 17,
    "affected_rows": 1
}
[2025-12-13 06:53:57] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-13 06:53:57] Processing item 0: {
    "item_code": "SCMBR0039553",
    "item_name": "AMSTEL GRANDE INTERNATIONAL PREMIUM STRONG BEER .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 80,
    "amount": 80,
    "tot_bott": 1,
    "bl": 0.65
}
[2025-12-13 06:53:57] Item 0 inserted successfully: {
    "purchase_id": 17,
    "item_code": "SCMBR0039553"
}
[2025-12-13 06:53:58] Processing item 1: {
    "item_code": "SCMBR0031825",
    "item_name": "Bira 91 Superfresh Natural White Beer .",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 120,
    "amount": 120,
    "tot_bott": 1,
    "bl": 0.5
}
[2025-12-13 06:53:58] Item 1 inserted successfully: {
    "purchase_id": 17,
    "item_code": "SCMBR0031825"
}
[2025-12-13 06:53:58] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-13 06:53:58] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-20 08:38:27] === NEW PURCHASE SESSION STARTED ===
[2025-12-20 08:38:27] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-20 08:38:27] POST data: []
[2025-12-20 08:38:27] GET data: []
[2025-12-20 08:38:27] Company ID from session: 4
[2025-12-20 08:38:27] Database connection included
[2025-12-20 08:38:27] License functions included
[2025-12-20 08:38:27] License type: FL-III
[2025-12-20 08:38:27] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-20 08:38:27] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-20 08:38:27] Purchase mode: F
[2025-12-20 08:38:27] Next voucher number: 1
[2025-12-20 08:38:27] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-20 08:38:27] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-20 08:38:27] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-20 08:38:27] Suppliers fetched: {
    "count": 36
}
[2025-12-20 08:38:27] Database connection closed
[2025-12-20 08:38:27] === PURCHASE SESSION ENDED ===
[2025-12-20 08:40:03] === NEW PURCHASE SESSION STARTED ===
[2025-12-20 08:40:03] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-20 08:40:03] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-08",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "229",
            "auto_batch": "BTBL2-291025\/620",
            "mfg_month": "Oct-2025",
            "bl": "23.4",
            "vv": "8",
            "tot_bott": "36",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0009847",
            "name": "Kingfisher Strong Premium Beer ",
            "size": "330 ML",
            "bottles_per_case": "12",
            "batch_no": "213",
            "auto_batch": "BTBL2-161025\/580",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018145",
            "name": "London Pilsner Premium Strong Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "109",
            "auto_batch": "BTBL2-280925\/511",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "165"
        },
        {
            "code": "SCMBR0018149",
            "name": "Kingfisher Premium Lager Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "33",
            "auto_batch": "BTBL2-101025\/555",
            "mfg_month": "Oct-2025",
            "bl": "7.8",
            "vv": "5",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "200"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-20 08:40:03] GET data: []
[2025-12-20 08:40:03] Company ID from session: 4
[2025-12-20 08:40:03] Database connection included
[2025-12-20 08:40:03] License functions included
[2025-12-20 08:40:03] License type: FL-III
[2025-12-20 08:40:03] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-20 08:40:03] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-20 08:40:03] Purchase mode: F
[2025-12-20 08:40:03] Next voucher number: 1
[2025-12-20 08:40:03] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-20 08:40:03] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-20 08:40:03] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-20 08:40:03] Suppliers fetched: {
    "count": 36
}
[2025-12-20 08:40:03] === FORM SUBMISSION STARTED ===
[2025-12-20 08:40:03] Form data extracted: {
    "date": "2025-11-08",
    "voc_no": "1",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-20 08:40:03] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-08",
        "RAJ",
        "FL119851-081125\/4797",
        "1",
        "",
        "",
        "0.00",
        "4797",
        "2025-11-08",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        4
    ]
}
[2025-12-20 08:40:03] Purchase header inserted successfully: {
    "purchase_id": 18,
    "affected_rows": 1
}
[2025-12-20 08:40:03] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-20 08:40:03] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer ",
    "mrp": 195,
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 36,
    "bl": 23.4
}
[2025-12-20 08:40:03] Item 0 inserted successfully: {
    "purchase_id": 18,
    "item_code": "SCMBR0009846",
    "mrp": 195
}
[2025-12-20 08:40:03] cleanItemCode: 'SCMBR0009846' -> 'BR0009846'
[2025-12-20 08:40:03] Updating MRP for item: {
    "item_code": "BR0009846",
    "mrp": 195
}
[2025-12-20 08:40:03] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009846",
    "mrp": 195
}
[2025-12-20 08:40:03] No rows affected - item might not exist: {
    "clean_code": "BR0009846",
    "mrp": 195
}
[2025-12-20 08:40:04] Processing item 1: {
    "item_code": "SCMBR0009847",
    "item_name": "Kingfisher Strong Premium Beer ",
    "mrp": 130,
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 24,
    "bl": 7.92
}
[2025-12-20 08:40:04] Item 1 inserted successfully: {
    "purchase_id": 18,
    "item_code": "SCMBR0009847",
    "mrp": 130
}
[2025-12-20 08:40:04] cleanItemCode: 'SCMBR0009847' -> 'BR0009847'
[2025-12-20 08:40:04] Updating MRP for item: {
    "item_code": "BR0009847",
    "mrp": 130
}
[2025-12-20 08:40:04] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009847",
    "mrp": 130
}
[2025-12-20 08:40:04] No rows affected - item might not exist: {
    "clean_code": "BR0009847",
    "mrp": 130
}
[2025-12-20 08:40:04] Processing item 2: {
    "item_code": "SCMBR0018145",
    "item_name": "London Pilsner Premium Strong Beer ",
    "mrp": 165,
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 12,
    "bl": 7.8
}
[2025-12-20 08:40:04] Item 2 inserted successfully: {
    "purchase_id": 18,
    "item_code": "SCMBR0018145",
    "mrp": 165
}
[2025-12-20 08:40:04] cleanItemCode: 'SCMBR0018145' -> 'BR0018145'
[2025-12-20 08:40:04] Updating MRP for item: {
    "item_code": "BR0018145",
    "mrp": 165
}
[2025-12-20 08:40:04] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018145",
    "mrp": 165
}
[2025-12-20 08:40:04] No rows affected - item might not exist: {
    "clean_code": "BR0018145",
    "mrp": 165
}
[2025-12-20 08:40:05] Processing item 3: {
    "item_code": "SCMBR0018149",
    "item_name": "Kingfisher Premium Lager Beer ",
    "mrp": 200,
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 12,
    "bl": 7.8
}
[2025-12-20 08:40:05] Item 3 inserted successfully: {
    "purchase_id": 18,
    "item_code": "SCMBR0018149",
    "mrp": 200
}
[2025-12-20 08:40:05] cleanItemCode: 'SCMBR0018149' -> 'BR0018149'
[2025-12-20 08:40:05] Updating MRP for item: {
    "item_code": "BR0018149",
    "mrp": 200
}
[2025-12-20 08:40:05] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018149",
    "mrp": 200
}
[2025-12-20 08:40:05] No rows affected - item might not exist: {
    "clean_code": "BR0018149",
    "mrp": 200
}
[2025-12-20 08:40:06] Purchase items processing completed: {
    "successful_items": 4,
    "total_items": 4
}
[2025-12-20 08:40:06] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-20 08:43:36] === NEW PURCHASE SESSION STARTED ===
[2025-12-20 08:43:36] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-20 08:43:36] POST data: []
[2025-12-20 08:43:36] GET data: {
    "mode": "F"
}
[2025-12-20 08:43:36] Company ID from session: 4
[2025-12-20 08:43:36] Database connection included
[2025-12-20 08:43:36] License functions included
[2025-12-20 08:43:36] License type: FL-III
[2025-12-20 08:43:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-20 08:43:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-20 08:43:36] Purchase mode: F
[2025-12-20 08:43:36] Next voucher number: 1
[2025-12-20 08:43:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-20 08:43:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-20 08:43:36] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-20 08:43:36] Suppliers fetched: {
    "count": 36
}
[2025-12-20 08:43:36] Database connection closed
[2025-12-20 08:43:36] === PURCHASE SESSION ENDED ===
[2025-12-20 08:43:51] === NEW PURCHASE SESSION STARTED ===
[2025-12-20 08:43:51] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-20 08:43:51] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-08",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "229",
            "auto_batch": "BTBL2-291025\/620",
            "mfg_month": "Oct-2025",
            "bl": "23.4",
            "vv": "8",
            "tot_bott": "36",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0009847",
            "name": "Kingfisher Strong Premium Beer ",
            "size": "330 ML",
            "bottles_per_case": "12",
            "batch_no": "213",
            "auto_batch": "BTBL2-161025\/580",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018145",
            "name": "London Pilsner Premium Strong Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "109",
            "auto_batch": "BTBL2-280925\/511",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "165"
        },
        {
            "code": "SCMBR0018149",
            "name": "Kingfisher Premium Lager Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "33",
            "auto_batch": "BTBL2-101025\/555",
            "mfg_month": "Oct-2025",
            "bl": "7.8",
            "vv": "5",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "200"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-20 08:43:52] GET data: {
    "mode": "F"
}
[2025-12-20 08:43:52] Company ID from session: 4
[2025-12-20 08:43:52] Database connection included
[2025-12-20 08:43:52] License functions included
[2025-12-20 08:43:52] License type: FL-III
[2025-12-20 08:43:52] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-20 08:43:52] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-20 08:43:52] Purchase mode: F
[2025-12-20 08:43:52] Next voucher number: 1
[2025-12-20 08:43:52] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-20 08:43:52] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-20 08:43:52] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-20 08:43:52] Suppliers fetched: {
    "count": 36
}
[2025-12-20 08:43:52] === FORM SUBMISSION STARTED ===
[2025-12-20 08:43:52] Form data extracted: {
    "date": "2025-11-08",
    "voc_no": "1",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-20 08:43:52] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-08",
        "RAJ",
        "FL119851-081125\/4797",
        "1",
        "",
        "",
        "0.00",
        "4797",
        "2025-11-08",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        4
    ]
}
[2025-12-20 08:43:52] Purchase header inserted successfully: {
    "purchase_id": 19,
    "affected_rows": 1
}
[2025-12-20 08:43:52] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-20 08:43:52] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer ",
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 36,
    "bl": 23.4
}
[2025-12-20 08:43:52] Item 0 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0009846"
}
[2025-12-20 08:43:52] Processing item 1: {
    "item_code": "SCMBR0009847",
    "item_name": "Kingfisher Strong Premium Beer ",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 24,
    "bl": 7.92
}
[2025-12-20 08:43:52] Item 1 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0009847"
}
[2025-12-20 08:43:53] Processing item 2: {
    "item_code": "SCMBR0018145",
    "item_name": "London Pilsner Premium Strong Beer ",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 12,
    "bl": 7.8
}
[2025-12-20 08:43:53] Item 2 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0018145"
}
[2025-12-20 08:43:53] Processing item 3: {
    "item_code": "SCMBR0018149",
    "item_name": "Kingfisher Premium Lager Beer ",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 12,
    "bl": 7.8
}
[2025-12-20 08:43:53] Item 3 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0018149"
}
[2025-12-20 08:43:54] Purchase items processing completed: {
    "successful_items": 4,
    "total_items": 4
}
[2025-12-20 08:43:54] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-21 13:06:42] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 13:06:42] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 13:06:42] POST data: []
[2025-12-21 13:06:42] GET data: []
[2025-12-21 13:06:42] Company ID from session: 4
[2025-12-21 13:06:42] Database connection included
[2025-12-21 13:06:42] License functions included
[2025-12-21 13:06:42] License type: FL-III
[2025-12-21 13:06:42] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 13:06:42] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 13:06:42] Purchase mode: F
[2025-12-21 13:06:42] Next voucher number: 2
[2025-12-21 13:06:42] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 13:06:42] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 13:06:42] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 13:06:42] Suppliers fetched: {
    "count": 36
}
[2025-12-21 13:06:43] Database connection closed
[2025-12-21 13:06:43] === PURCHASE SESSION ENDED ===
[2025-12-21 13:15:11] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 13:15:11] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 13:15:11] POST data: []
[2025-12-21 13:15:11] GET data: []
[2025-12-21 13:15:11] Company ID from session: 4
[2025-12-21 13:15:11] Database connection included
[2025-12-21 13:15:11] License functions included
[2025-12-21 13:15:11] License type: FL-III
[2025-12-21 13:15:11] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 13:15:11] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 13:15:11] Purchase mode: F
[2025-12-21 13:15:11] Next voucher number: 1
[2025-12-21 13:15:11] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 13:15:11] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 13:15:11] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 13:15:11] Suppliers fetched: {
    "count": 36
}
[2025-12-21 13:15:12] Database connection closed
[2025-12-21 13:15:12] === PURCHASE SESSION ENDED ===
[2025-12-21 13:17:56] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 13:17:56] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 13:17:56] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-12",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ASIAN TRADERS",
    "supplier_code": "ASIA",
    "items": [
        {
            "code": "SCMPL0033617",
            "name": "Grand Masters Cranberry Platinum Vodka ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "668",
            "auto_batch": "BTP44-181025\/668",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "42.8",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "300"
        },
        {
            "code": "SCMPL0033620",
            "name": "Grand Masters Mango Platinum Vodka ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "640",
            "auto_batch": "BTP44-111025\/640",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "300"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-21 13:17:56] GET data: []
[2025-12-21 13:17:56] Company ID from session: 4
[2025-12-21 13:17:56] Database connection included
[2025-12-21 13:17:56] License functions included
[2025-12-21 13:17:56] License type: FL-III
[2025-12-21 13:17:56] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 13:17:56] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 13:17:56] Purchase mode: F
[2025-12-21 13:17:56] Next voucher number: 1
[2025-12-21 13:17:56] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 13:17:56] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 13:17:56] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 13:17:56] Suppliers fetched: {
    "count": 36
}
[2025-12-21 13:17:56] === FORM SUBMISSION STARTED ===
[2025-12-21 13:17:56] Form data extracted: {
    "date": "2025-11-12",
    "voc_no": "1",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ASIA",
    "supplier_name": "ASIAN TRADERS",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-21 13:17:56] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-12",
        "ASIA",
        "FL175-111125\/4046",
        "1",
        "",
        "",
        "0.00",
        "3935",
        "2025-11-11",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        4
    ]
}
[2025-12-21 13:17:56] Purchase header inserted successfully: {
    "purchase_id": 18,
    "affected_rows": 1
}
[2025-12-21 13:17:56] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-21 13:17:56] Processing item 0: {
    "item_code": "SCMPL0033617",
    "item_name": "Grand Masters Cranberry Platinum Vodka ",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-12-21 13:17:56] Item 0 inserted successfully: {
    "purchase_id": 18,
    "item_code": "SCMPL0033617"
}
[2025-12-21 13:17:57] Processing item 1: {
    "item_code": "SCMPL0033620",
    "item_name": "Grand Masters Mango Platinum Vodka ",
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 48,
    "bl": 8.64
}
[2025-12-21 13:17:57] Item 1 inserted successfully: {
    "purchase_id": 18,
    "item_code": "SCMPL0033620"
}
[2025-12-21 13:17:57] Purchase items processing completed: {
    "successful_items": 2,
    "total_items": 2
}
[2025-12-21 13:17:57] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-21 13:24:45] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 13:24:45] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 13:24:45] POST data: []
[2025-12-21 13:24:45] GET data: []
[2025-12-21 13:24:45] Company ID from session: 4
[2025-12-21 13:24:45] Database connection included
[2025-12-21 13:24:45] License functions included
[2025-12-21 13:24:45] License type: FL-III
[2025-12-21 13:24:45] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 13:24:45] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 13:24:45] Purchase mode: F
[2025-12-21 13:24:45] Next voucher number: 2
[2025-12-21 13:24:45] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 13:24:45] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 13:24:45] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 13:24:45] Suppliers fetched: {
    "count": 36
}
[2025-12-21 13:24:46] Database connection closed
[2025-12-21 13:24:46] === PURCHASE SESSION ENDED ===
[2025-12-21 14:13:50] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:13:50] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 14:13:50] POST data: []
[2025-12-21 14:13:50] GET data: []
[2025-12-21 14:13:50] Company ID from session: 4
[2025-12-21 14:13:50] Database connection included
[2025-12-21 14:13:50] License functions included
[2025-12-21 14:13:50] License type: FL-III
[2025-12-21 14:13:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:13:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:13:50] Purchase mode: F
[2025-12-21 14:13:50] Next voucher number: 2
[2025-12-21 14:13:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:13:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:13:50] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:13:50] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:13:50] Database connection closed
[2025-12-21 14:13:50] === PURCHASE SESSION ENDED ===
[2025-12-21 14:14:07] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:14:07] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 14:14:07] POST data: []
[2025-12-21 14:14:07] GET data: {
    "mode": "F"
}
[2025-12-21 14:14:07] Company ID from session: 4
[2025-12-21 14:14:07] Database connection included
[2025-12-21 14:14:07] License functions included
[2025-12-21 14:14:07] License type: FL-III
[2025-12-21 14:14:07] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:14:07] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:14:07] Purchase mode: F
[2025-12-21 14:14:07] Next voucher number: 1
[2025-12-21 14:14:07] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:14:07] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:14:07] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:14:07] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:14:07] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:14:07] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 14:14:07] POST data: []
[2025-12-21 14:14:07] GET data: {
    "mode": "F"
}
[2025-12-21 14:14:07] Company ID from session: 4
[2025-12-21 14:14:07] Database connection included
[2025-12-21 14:14:07] License functions included
[2025-12-21 14:14:07] License type: FL-III
[2025-12-21 14:14:08] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:14:08] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:14:08] Purchase mode: F
[2025-12-21 14:14:08] Next voucher number: 1
[2025-12-21 14:14:08] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:14:08] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:14:08] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:14:08] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:14:08] Database connection closed
[2025-12-21 14:14:08] === PURCHASE SESSION ENDED ===
[2025-12-21 14:14:16] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:14:16] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 14:14:16] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-08",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "229",
            "auto_batch": "BTBL2-291025\/620",
            "mfg_month": "Oct-2025",
            "bl": "23.4",
            "vv": "8",
            "tot_bott": "36",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0009847",
            "name": "Kingfisher Strong Premium Beer ",
            "size": "330 ML",
            "bottles_per_case": "12",
            "batch_no": "213",
            "auto_batch": "BTBL2-161025\/580",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018145",
            "name": "London Pilsner Premium Strong Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "109",
            "auto_batch": "BTBL2-280925\/511",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "165"
        },
        {
            "code": "SCMBR0018149",
            "name": "Kingfisher Premium Lager Beer ",
            "size": "650 ML",
            "bottles_per_case": "12",
            "batch_no": "33",
            "auto_batch": "BTBL2-101025\/555",
            "mfg_month": "Oct-2025",
            "bl": "7.8",
            "vv": "5",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "200"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-21 14:14:16] GET data: {
    "mode": "F"
}
[2025-12-21 14:14:16] Company ID from session: 4
[2025-12-21 14:14:16] Database connection included
[2025-12-21 14:14:16] License functions included
[2025-12-21 14:14:16] License type: FL-III
[2025-12-21 14:14:16] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:14:16] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:14:16] Purchase mode: F
[2025-12-21 14:14:16] Next voucher number: 1
[2025-12-21 14:14:16] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:14:16] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:14:16] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:14:16] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:14:16] === FORM SUBMISSION STARTED ===
[2025-12-21 14:14:16] Form data extracted: {
    "date": "2025-11-08",
    "voc_no": "1",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-21 14:14:16] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
    "parameters": [
        "2025-11-08",
        "RAJ",
        "FL119851-081125\/4797",
        "1",
        "",
        "",
        "0.00",
        "4797",
        "2025-11-08",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "0.00",
        "T",
        4
    ]
}
[2025-12-21 14:14:16] Purchase header inserted successfully: {
    "purchase_id": 19,
    "affected_rows": 1
}
[2025-12-21 14:14:16] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-21 14:14:16] Processing item 0: {
    "item_code": "SCMBR0009846",
    "item_name": "Kingfisher Strong Premium Beer ",
    "mrp": 195,
    "cases": 3,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 36,
    "bl": 23.4
}
[2025-12-21 14:14:16] Item 0 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0009846",
    "mrp": 195
}
[2025-12-21 14:14:16] cleanItemCode: 'SCMBR0009846' -> 'BR0009846'
[2025-12-21 14:14:16] Updating MRP for item: {
    "item_code": "BR0009846",
    "mrp": 195
}
[2025-12-21 14:14:16] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009846",
    "mrp": 195
}
[2025-12-21 14:14:16] No rows affected - item might not exist: {
    "clean_code": "BR0009846",
    "mrp": 195
}
[2025-12-21 14:14:16] Checking if month is archived: {
    "company_id": 4,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_4_11_25"
}
[2025-12-21 14:14:16] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_4_11_25'"
}
[2025-12-21 14:14:16] Processing item 1: {
    "item_code": "SCMBR0009847",
    "item_name": "Kingfisher Strong Premium Beer ",
    "mrp": 130,
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 24,
    "bl": 7.92
}
[2025-12-21 14:14:16] Item 1 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0009847",
    "mrp": 130
}
[2025-12-21 14:14:16] cleanItemCode: 'SCMBR0009847' -> 'BR0009847'
[2025-12-21 14:14:16] Updating MRP for item: {
    "item_code": "BR0009847",
    "mrp": 130
}
[2025-12-21 14:14:16] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009847",
    "mrp": 130
}
[2025-12-21 14:14:16] No rows affected - item might not exist: {
    "clean_code": "BR0009847",
    "mrp": 130
}
[2025-12-21 14:14:16] Checking if month is archived: {
    "company_id": 4,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_4_11_25"
}
[2025-12-21 14:14:16] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_4_11_25'"
}
[2025-12-21 14:14:16] Processing item 2: {
    "item_code": "SCMBR0018145",
    "item_name": "London Pilsner Premium Strong Beer ",
    "mrp": 165,
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 12,
    "bl": 7.8
}
[2025-12-21 14:14:16] Item 2 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0018145",
    "mrp": 165
}
[2025-12-21 14:14:16] cleanItemCode: 'SCMBR0018145' -> 'BR0018145'
[2025-12-21 14:14:16] Updating MRP for item: {
    "item_code": "BR0018145",
    "mrp": 165
}
[2025-12-21 14:14:16] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018145",
    "mrp": 165
}
[2025-12-21 14:14:16] No rows affected - item might not exist: {
    "clean_code": "BR0018145",
    "mrp": 165
}
[2025-12-21 14:14:16] Checking if month is archived: {
    "company_id": 4,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_4_11_25"
}
[2025-12-21 14:14:16] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_4_11_25'"
}
[2025-12-21 14:14:16] Processing item 3: {
    "item_code": "SCMBR0018149",
    "item_name": "Kingfisher Premium Lager Beer ",
    "mrp": 200,
    "cases": 1,
    "bottles": 0,
    "free_cases": 0,
    "free_bottles": 0,
    "case_rate": 0,
    "amount": 0,
    "tot_bott": 12,
    "bl": 7.8
}
[2025-12-21 14:14:16] Item 3 inserted successfully: {
    "purchase_id": 19,
    "item_code": "SCMBR0018149",
    "mrp": 200
}
[2025-12-21 14:14:16] cleanItemCode: 'SCMBR0018149' -> 'BR0018149'
[2025-12-21 14:14:16] Updating MRP for item: {
    "item_code": "BR0018149",
    "mrp": 200
}
[2025-12-21 14:14:16] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018149",
    "mrp": 200
}
[2025-12-21 14:14:16] No rows affected - item might not exist: {
    "clean_code": "BR0018149",
    "mrp": 200
}
[2025-12-21 14:14:16] Checking if month is archived: {
    "company_id": 4,
    "month": "11",
    "year": "2025",
    "archive_table": "tbldailystock_4_11_25"
}
[2025-12-21 14:14:16] Month archive check result: {
    "table_exists": true,
    "query": "SELECT COUNT(*) as count FROM information_schema.tables \n                           WHERE table_schema = DATABASE() \n                           AND table_name = 'tbldailystock_4_11_25'"
}
[2025-12-21 14:14:16] Purchase items processing completed: {
    "successful_items": 4,
    "total_items": 4
}
[2025-12-21 14:14:16] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-21 14:28:24] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:28:24] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 14:28:24] POST data: []
[2025-12-21 14:28:24] GET data: {
    "mode": "F"
}
[2025-12-21 14:28:24] Company ID from session: 4
[2025-12-21 14:28:24] Database connection included
[2025-12-21 14:28:24] License functions included
[2025-12-21 14:28:24] License type: FL-III
[2025-12-21 14:28:24] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:28:24] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:28:24] Purchase mode: F
[2025-12-21 14:28:24] Next voucher number: 2
[2025-12-21 14:28:24] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:28:24] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:28:24] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:28:24] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:28:24] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:28:24] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-21 14:28:24] POST data: []
[2025-12-21 14:28:24] GET data: {
    "mode": "F"
}
[2025-12-21 14:28:24] Company ID from session: 4
[2025-12-21 14:28:24] Database connection included
[2025-12-21 14:28:24] License functions included
[2025-12-21 14:28:24] License type: FL-III
[2025-12-21 14:28:24] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:28:24] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:28:24] Purchase mode: F
[2025-12-21 14:28:24] Next voucher number: 2
[2025-12-21 14:28:24] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:28:24] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)  -- REMOVED: im.LIQ_FLAG = ?\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:28:24] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:28:24] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:28:24] Database connection closed
[2025-12-21 14:28:24] === PURCHASE SESSION ENDED ===
[2025-12-21 14:53:39] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:53:39] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 14:53:39] POST data: []
[2025-12-21 14:53:39] GET data: []
[2025-12-21 14:53:39] Company ID from session: 4
[2025-12-21 14:53:39] Database connection included
[2025-12-21 14:53:39] License functions included
[2025-12-21 14:53:39] License type: FL-III
[2025-12-21 14:53:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:53:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:53:39] Purchase mode: F
[2025-12-21 14:53:39] Next voucher number: 2
[2025-12-21 14:53:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:53:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:53:39] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:53:39] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:53:39] Database connection closed
[2025-12-21 14:53:39] === PURCHASE SESSION ENDED ===
[2025-12-21 14:54:40] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:54:40] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 14:54:40] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagrams Royal Stag Deluxe Whisky ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-21 14:54:40] GET data: []
[2025-12-21 14:54:40] Company ID from session: 4
[2025-12-21 14:54:40] Database connection included
[2025-12-21 14:54:40] License functions included
[2025-12-21 14:54:40] License type: FL-III
[2025-12-21 14:54:40] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:54:40] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:54:40] Purchase mode: F
[2025-12-21 14:54:40] Next voucher number: 2
[2025-12-21 14:54:40] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:54:40] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:54:40] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:54:40] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:54:40] === FORM SUBMISSION STARTED ===
[2025-12-21 14:54:40] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "2",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-21 14:54:40] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-21 14:54:40] Purchase header inserted successfully: {
    "purchase_id": 20,
    "affected_rows": 1
}
[2025-12-21 14:54:40] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-21 14:54:40] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-21 14:54:40] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-21 14:54:40] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 14:54:40] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 14:54:40] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-21 14:54:40] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-21 14:54:40] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-21 14:57:52] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:57:52] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 14:57:52] POST data: []
[2025-12-21 14:57:52] GET data: []
[2025-12-21 14:57:52] Company ID from session: 4
[2025-12-21 14:57:52] Database connection included
[2025-12-21 14:57:52] License functions included
[2025-12-21 14:57:52] License type: FL-III
[2025-12-21 14:57:52] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:57:52] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:57:52] Purchase mode: F
[2025-12-21 14:57:52] Next voucher number: 3
[2025-12-21 14:57:52] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 14:57:52] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 14:57:52] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 14:57:52] Suppliers fetched: {
    "count": 36
}
[2025-12-21 14:57:52] Database connection closed
[2025-12-21 14:57:52] === PURCHASE SESSION ENDED ===
[2025-12-21 14:59:04] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:59:04] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 14:59:04] POST data: []
[2025-12-21 14:59:04] GET data: []
[2025-12-21 14:59:04] Company ID from session: 4
[2025-12-21 14:59:04] Database connection included
[2025-12-21 14:59:04] License functions included
[2025-12-21 14:59:04] License type: FL-III
[2025-12-21 14:59:04] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:59:04] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:59:04] Purchase mode: F
[2025-12-21 14:59:23] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 14:59:23] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 14:59:23] POST data: []
[2025-12-21 14:59:23] GET data: []
[2025-12-21 14:59:23] Company ID from session: 4
[2025-12-21 14:59:23] Database connection included
[2025-12-21 14:59:23] License functions included
[2025-12-21 14:59:23] License type: FL-III
[2025-12-21 14:59:23] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 14:59:23] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 14:59:23] Purchase mode: F
[2025-12-21 15:07:12] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 15:07:12] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 15:07:12] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 15:07:12] POST data: []
[2025-12-21 15:07:12] GET data: {
    "mode": "F"
}
[2025-12-21 15:07:12] Company ID from session: 4
[2025-12-21 15:07:12] Database connection included
[2025-12-21 15:07:12] License functions included
[2025-12-21 15:07:12] License type: FL-III
[2025-12-21 15:07:12] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 15:07:12] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 15:07:12] Purchase mode: F
[2025-12-21 15:07:12] Next voucher number: 1
[2025-12-21 15:07:12] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 15:07:12] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 15:07:12] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 15:07:12] Suppliers fetched: {
    "count": 36
}
[2025-12-21 15:07:12] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 15:07:12] POST data: []
[2025-12-21 15:07:12] GET data: {
    "mode": "F"
}
[2025-12-21 15:07:12] Company ID from session: 4
[2025-12-21 15:07:12] Database connection included
[2025-12-21 15:07:12] License functions included
[2025-12-21 15:07:12] License type: FL-III
[2025-12-21 15:07:12] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 15:07:12] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 15:07:12] Purchase mode: F
[2025-12-21 15:07:12] Next voucher number: 1
[2025-12-21 15:07:12] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 15:07:12] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 15:07:12] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 15:07:12] Suppliers fetched: {
    "count": 36
}
[2025-12-21 15:07:12] Database connection closed
[2025-12-21 15:07:12] === PURCHASE SESSION ENDED ===
[2025-12-21 15:07:42] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 15:07:42] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true
}
[2025-12-21 15:07:42] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagrams Royal Stag Deluxe Whisky ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-21 15:07:42] GET data: {
    "mode": "F"
}
[2025-12-21 15:07:42] Company ID from session: 4
[2025-12-21 15:07:42] Database connection included
[2025-12-21 15:07:42] License functions included
[2025-12-21 15:07:42] License type: FL-III
[2025-12-21 15:07:42] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 15:07:42] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 15:07:42] Purchase mode: F
[2025-12-21 15:07:42] Next voucher number: 1
[2025-12-21 15:07:42] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 15:07:42] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 15:07:43] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 15:07:43] Suppliers fetched: {
    "count": 36
}
[2025-12-21 15:07:43] === FORM SUBMISSION STARTED ===
[2025-12-21 15:07:43] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-21 15:07:43] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-21 15:07:43] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-21 15:07:43] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-21 15:07:43] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-21 15:07:43] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-21 15:07:43] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 15:07:43] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 15:07:43] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-21 15:07:43] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-21 15:07:43] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-21 15:34:37] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 15:34:37] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMPL0009770": 20
    }
}
[2025-12-21 15:34:37] POST data: []
[2025-12-21 15:34:37] GET data: {
    "mode": "F"
}
[2025-12-21 15:34:37] Company ID from session: 4
[2025-12-21 15:34:37] Database connection included
[2025-12-21 15:34:37] License functions included
[2025-12-21 15:34:37] License type: FL-III
[2025-12-21 15:34:37] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 15:34:37] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 15:34:37] Purchase mode: F
[2025-12-21 15:34:37] Next voucher number: 1
[2025-12-21 15:34:37] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 15:34:37] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 15:34:37] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 15:34:37] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 15:34:37] Suppliers fetched: {
    "count": 36
}
[2025-12-21 15:34:37] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMPL0009770": 20
    }
}
[2025-12-21 15:34:37] POST data: []
[2025-12-21 15:34:37] GET data: {
    "mode": "F"
}
[2025-12-21 15:34:37] Company ID from session: 4
[2025-12-21 15:34:37] Database connection included
[2025-12-21 15:34:37] License functions included
[2025-12-21 15:34:37] License type: FL-III
[2025-12-21 15:34:37] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 15:34:37] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 15:34:37] Purchase mode: F
[2025-12-21 15:34:37] Next voucher number: 1
[2025-12-21 15:34:37] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 15:34:37] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 15:34:37] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 15:34:37] Suppliers fetched: {
    "count": 36
}
[2025-12-21 15:34:37] Database connection closed
[2025-12-21 15:34:37] === PURCHASE SESSION ENDED ===
[2025-12-21 15:34:47] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 15:34:47] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMPL0009770": 20
    }
}
[2025-12-21 15:34:47] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagrams Royal Stag Deluxe Whisky ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-21 15:34:47] GET data: {
    "mode": "F"
}
[2025-12-21 15:34:47] Company ID from session: 4
[2025-12-21 15:34:47] Database connection included
[2025-12-21 15:34:47] License functions included
[2025-12-21 15:34:47] License type: FL-III
[2025-12-21 15:34:47] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 15:34:47] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 15:34:47] Purchase mode: F
[2025-12-21 15:34:47] Next voucher number: 1
[2025-12-21 15:34:47] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 15:34:47] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 15:34:47] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 15:34:47] Suppliers fetched: {
    "count": 36
}
[2025-12-21 15:34:47] === FORM SUBMISSION STARTED ===
[2025-12-21 15:34:47] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-21 15:34:47] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-21 15:34:47] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-21 15:34:47] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-21 15:34:47] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-21 15:34:47] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-21 15:34:47] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 15:34:47] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 15:34:47] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-21 15:34:47] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-21 15:34:47] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-21 16:04:26] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 16:04:26] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMPL0009770": 20
    },
    "error": "Error deleting purchase: Unknown column 'PURCHASE_ID' in 'where clause'"
}
[2025-12-21 16:04:26] POST data: []
[2025-12-21 16:04:26] GET data: []
[2025-12-21 16:04:26] Company ID from session: 4
[2025-12-21 16:04:26] Database connection included
[2025-12-21 16:04:26] License functions included
[2025-12-21 16:04:26] License type: FL-III
[2025-12-21 16:04:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 16:04:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 16:04:26] Purchase mode: F
[2025-12-21 16:04:26] Next voucher number: 1
[2025-12-21 16:04:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 16:04:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 16:04:26] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 16:04:26] Suppliers fetched: {
    "count": 36
}
[2025-12-21 16:04:26] Database connection closed
[2025-12-21 16:04:26] === PURCHASE SESSION ENDED ===
[2025-12-21 16:04:41] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 16:04:41] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMPL0009770": 20
    },
    "error": "Error deleting purchase: Unknown column 'PURCHASE_ID' in 'where clause'"
}
[2025-12-21 16:04:41] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagrams Royal Stag Deluxe Whisky ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-21 16:04:41] GET data: []
[2025-12-21 16:04:41] Company ID from session: 4
[2025-12-21 16:04:41] Database connection included
[2025-12-21 16:04:41] License functions included
[2025-12-21 16:04:41] License type: FL-III
[2025-12-21 16:04:41] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 16:04:41] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 16:04:41] Purchase mode: F
[2025-12-21 16:04:41] Next voucher number: 1
[2025-12-21 16:04:41] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 16:04:41] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 16:04:41] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 16:04:41] Suppliers fetched: {
    "count": 36
}
[2025-12-21 16:04:41] === FORM SUBMISSION STARTED ===
[2025-12-21 16:04:41] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-21 16:04:41] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-21 16:04:41] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-21 16:04:41] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-21 16:04:41] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-21 16:04:41] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-21 16:04:41] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 16:04:41] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 16:04:41] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-21 16:04:41] Month is current, updating current table with cascading
[2025-12-21 16:04:41] Updating current month stock: {
    "table": "bitalaystock_4",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-21 16:05:58] === NEW PURCHASE SESSION STARTED ===
[2025-12-21 16:05:58] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMPL0009770": 20
    },
    "error": "Error deleting purchase: Unknown column 'PURCHASE_ID' in 'where clause'"
}
[2025-12-21 16:05:58] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagrams Royal Stag Deluxe Whisky ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-21 16:05:58] GET data: []
[2025-12-21 16:05:58] Company ID from session: 4
[2025-12-21 16:05:58] Database connection included
[2025-12-21 16:05:58] License functions included
[2025-12-21 16:05:58] License type: FL-III
[2025-12-21 16:05:58] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-21 16:05:58] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-21 16:05:58] Purchase mode: F
[2025-12-21 16:05:58] Next voucher number: 2
[2025-12-21 16:05:58] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-21 16:05:58] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-21 16:05:58] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-21 16:05:58] Suppliers fetched: {
    "count": 36
}
[2025-12-21 16:05:58] === FORM SUBMISSION STARTED ===
[2025-12-21 16:05:58] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-21 16:05:58] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-21 16:05:58] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-21 16:05:58] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-21 16:05:58] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-21 16:05:58] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-21 16:05:58] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 16:05:58] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-21 16:05:58] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-21 16:05:58] Month is archived, updating archive table with cascading
[2025-12-21 16:05:58] Updating archived month stock: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-21 16:05:58] Starting cascading updates in table: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "purchaseDay": "14"
}
[2025-12-21 16:05:58] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-21 16:05:58] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-21 16:05:58] Cascading updates completed for all days after purchase day
[2025-12-21 16:05:58] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-21 16:05:58] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-22 04:16:16] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 04:16:16] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 04:16:16] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMLS0024545": 0,
        "SCMKS0038715": 10,
        "SCMPL0010694": 10
    }
}
[2025-12-22 04:16:16] POST data: []
[2025-12-22 04:16:16] GET data: {
    "mode": "F"
}
[2025-12-22 04:16:16] Company ID from session: 4
[2025-12-22 04:16:16] Database connection included
[2025-12-22 04:16:16] License functions included
[2025-12-22 04:16:16] License type: FL-III
[2025-12-22 04:16:16] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 04:16:16] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 04:16:16] Purchase mode: F
[2025-12-22 04:16:16] Next voucher number: 1
[2025-12-22 04:16:16] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 04:16:16] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 04:16:16] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-22 04:16:16] Suppliers fetched: {
    "count": 36
}
[2025-12-22 04:16:16] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMLS0024545": 0,
        "SCMKS0038715": 10,
        "SCMPL0010694": 10
    }
}
[2025-12-22 04:16:16] POST data: []
[2025-12-22 04:16:16] GET data: {
    "mode": "F"
}
[2025-12-22 04:16:16] Company ID from session: 4
[2025-12-22 04:16:16] Database connection included
[2025-12-22 04:16:16] License functions included
[2025-12-22 04:16:16] License type: FL-III
[2025-12-22 04:16:16] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 04:16:16] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 04:16:16] Purchase mode: F
[2025-12-22 04:16:16] Next voucher number: 1
[2025-12-22 04:16:16] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 04:16:16] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 04:16:16] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-22 04:16:16] Suppliers fetched: {
    "count": 36
}
[2025-12-22 04:16:16] Database connection closed
[2025-12-22 04:16:16] === PURCHASE SESSION ENDED ===
[2025-12-22 04:17:18] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 04:17:18] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMLS0024545": 0,
        "SCMKS0038715": 10,
        "SCMPL0010694": 10
    }
}
[2025-12-22 04:17:18] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagrams Royal Stag Deluxe Whisky ",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "0.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-22 04:17:18] GET data: {
    "mode": "F"
}
[2025-12-22 04:17:18] Company ID from session: 4
[2025-12-22 04:17:18] Database connection included
[2025-12-22 04:17:18] License functions included
[2025-12-22 04:17:18] License type: FL-III
[2025-12-22 04:17:18] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 04:17:18] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 04:17:18] Purchase mode: F
[2025-12-22 04:17:18] Next voucher number: 1
[2025-12-22 04:17:18] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 04:17:18] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 04:17:19] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-22 04:17:19] Suppliers fetched: {
    "count": 36
}
[2025-12-22 04:17:19] === FORM SUBMISSION STARTED ===
[2025-12-22 04:17:19] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-22 04:17:19] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-22 04:17:19] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-22 04:17:19] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-22 04:17:19] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-22 04:17:19] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-22 04:17:19] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-22 04:17:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-22 04:17:19] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-22 04:17:19] Month is archived, updating archive table with cascading
[2025-12-22 04:17:19] Updating archived month stock: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-22 04:17:19] Starting cascading updates in table: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "purchaseDay": "14"
}
[2025-12-22 04:17:19] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-22 04:17:19] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-22 04:17:19] Cascading updates completed for all days after purchase day
[2025-12-22 04:17:19] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-22 04:17:19] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-22 04:42:53] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 04:42:53] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMLS0024545": 0,
        "SCMKS0038715": 10,
        "SCMPL0010694": 10
    },
    "error": "Error deleting purchase: Unknown column 'PUR_ID' in 'where clause'"
}
[2025-12-22 04:42:53] POST data: []
[2025-12-22 04:42:53] GET data: {
    "mode": "F"
}
[2025-12-22 04:42:53] Company ID from session: 4
[2025-12-22 04:42:53] Database connection included
[2025-12-22 04:42:53] License functions included
[2025-12-22 04:42:53] License type: FL-III
[2025-12-22 04:42:53] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 04:42:53] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 04:42:53] Purchase mode: F
[2025-12-22 04:42:53] Next voucher number: 2
[2025-12-22 04:42:53] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 04:42:53] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 04:42:53] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-22 04:42:53] Suppliers fetched: {
    "count": 36
}
[2025-12-22 04:42:53] Database connection closed
[2025-12-22 04:42:53] === PURCHASE SESSION ENDED ===
[2025-12-22 04:50:06] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 04:50:06] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMLS0024545": 0,
        "SCMKS0038715": 10,
        "SCMPL0010694": 10
    },
    "error": "Error deleting purchase: Unknown column 'PUR_ID' in 'where clause'"
}
[2025-12-22 04:50:06] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-18",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "SAMBARAGI TRADERS",
    "supplier_code": "SAMB",
    "items": [
        {
            "code": "SCMKS0039633",
            "name": "Smirnoff Minty Jamum Triple Distilled Flavoured Vo",
            "size": "180 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "33",
            "auto_batch": "BTOS190-1291",
            "mfg_month": "Oct-2025",
            "bl": "0.54",
            "vv": "25",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "0.000",
            "mrp": "440"
        },
        {
            "code": "SCMLS0042805",
            "name": "Johnnie Walker Blonde Blended Scotch Whisky ",
            "size": "200 ML (24)",
            "bottles_per_case": "12",
            "batch_no": "I1221025",
            "auto_batch": "BTOI67-824",
            "mfg_month": "Sep-2025",
            "bl": "0.2",
            "vv": "25",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "1",
            "case_rate": "0.000",
            "mrp": "850"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-22 04:50:06] GET data: {
    "mode": "F"
}
[2025-12-22 04:50:06] Company ID from session: 4
[2025-12-22 04:50:06] Database connection included
[2025-12-22 04:50:06] License functions included
[2025-12-22 04:50:06] License type: FL-III
[2025-12-22 04:50:06] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 04:50:06] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 04:50:06] Purchase mode: F
[2025-12-22 04:50:06] Next voucher number: 2
[2025-12-22 04:50:06] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 04:50:06] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 04:50:06] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-22 04:50:06] Suppliers fetched: {
    "count": 36
}
[2025-12-22 04:50:06] === FORM SUBMISSION STARTED ===
[2025-12-22 04:50:06] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "2",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "SAMB",
    "supplier_name": "SAMBARAGI TRADERS",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-22 04:50:06] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-22 04:50:06] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-22 04:50:06] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-22 04:50:06] Processing item 0: {
    "item_code": "SCMKS0039633",
    "mrp": 440,
    "tot_bott": 3
}
[2025-12-22 04:50:06] cleanItemCode: 'SCMKS0039633' -> 'KS0039633'
[2025-12-22 04:50:06] Updating MRP for item: {
    "item_code": "KS0039633",
    "mrp": 440
}
[2025-12-22 04:50:06] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "KS0039633",
    "mrp": 440
}
[2025-12-22 04:50:06] Updating stock for item: {
    "item_code": "SCMKS0039633",
    "total_bottles": 3,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-22 04:50:06] Month is archived, updating archive table with cascading
[2025-12-22 04:50:06] Updating archived month stock: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "dayOfMonth": "18",
    "totalBottles": 3
}
[2025-12-22 04:50:06] Starting cascading updates in table: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "purchaseDay": "18"
}
[2025-12-22 04:50:06] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-22 04:50:06] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-22 04:50:06] Cascading updates completed for all days after purchase day
[2025-12-22 04:50:06] Continuing cascading to current month: {
    "comp_id": 4,
    "itemCode": "SCMKS0039633",
    "purchaseDate": "2025-11-18"
}
[2025-12-22 04:50:06] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-22 04:50:06] Cascading completed up to current date
[2025-12-22 04:50:06] Processing item 1: {
    "item_code": "SCMLS0042805",
    "mrp": 850,
    "tot_bott": 1
}
[2025-12-22 04:50:06] cleanItemCode: 'SCMLS0042805' -> 'LS0042805'
[2025-12-22 04:50:06] Updating MRP for item: {
    "item_code": "LS0042805",
    "mrp": 850
}
[2025-12-22 04:50:06] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "LS0042805",
    "mrp": 850
}
[2025-12-22 04:50:06] Updating stock for item: {
    "item_code": "SCMLS0042805",
    "total_bottles": 1,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-22 04:50:06] Month is archived, updating archive table with cascading
[2025-12-22 04:50:06] Updating archived month stock: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMLS0042805",
    "dayOfMonth": "18",
    "totalBottles": 1
}
[2025-12-22 04:50:06] Continuing cascading to current month: {
    "comp_id": 4,
    "itemCode": "SCMLS0042805",
    "purchaseDate": "2025-11-18"
}
[2025-12-22 04:50:06] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-22 04:50:06] Cascading completed up to current date
[2025-12-22 04:50:06] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-22 04:50:06] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-22 04:56:18] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 04:56:18] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMLS0024545": 0,
        "SCMKS0038715": 10,
        "SCMPL0010694": 10
    },
    "error": "Error deleting purchase: Unknown column 'PUR_ID' in 'where clause'"
}
[2025-12-22 04:56:18] POST data: []
[2025-12-22 04:56:18] GET data: {
    "mode": "F"
}
[2025-12-22 04:56:18] Company ID from session: 4
[2025-12-22 04:56:18] Database connection included
[2025-12-22 04:56:18] License functions included
[2025-12-22 04:56:18] License type: FL-III
[2025-12-22 04:56:18] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 04:56:18] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 04:56:18] Purchase mode: F
[2025-12-22 04:56:18] Next voucher number: 1
[2025-12-22 04:56:18] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 04:56:18] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 04:56:19] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-22 04:56:19] Suppliers fetched: {
    "count": 36
}
[2025-12-22 04:56:19] Database connection closed
[2025-12-22 04:56:19] === PURCHASE SESSION ENDED ===
[2025-12-22 04:56:33] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 04:56:33] Session data: {
    "user_id": "4",
    "username": "admin",
    "CompID": 4,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "stock_columns_checked": true,
    "sale_quantities": {
        "SCMLS0024545": 0,
        "SCMKS0038715": 10,
        "SCMPL0010694": 10
    },
    "error": "Error deleting purchase: Unknown column 'PUR_ID' in 'where clause'"
}
[2025-12-22 04:56:33] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-18",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "SAMBARAGI TRADERS",
    "supplier_code": "SAMB",
    "items": [
        {
            "code": "SCMKS0039633",
            "name": "Smirnoff Minty Jamum Triple Distilled Flavoured Vo",
            "size": "180 ML (Pet)",
            "bottles_per_case": "12",
            "batch_no": "33",
            "auto_batch": "BTOS190-1291",
            "mfg_month": "Oct-2025",
            "bl": "0.54",
            "vv": "25",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "0.000",
            "mrp": "440"
        },
        {
            "code": "SCMLS0042805",
            "name": "Johnnie Walker Blonde Blended Scotch Whisky ",
            "size": "200 ML (24)",
            "bottles_per_case": "12",
            "batch_no": "I1221025",
            "auto_batch": "BTOI67-824",
            "mfg_month": "Sep-2025",
            "bl": "0.2",
            "vv": "25",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "1",
            "case_rate": "0.000",
            "mrp": "850"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "0.00",
    "tamt": "0.00"
}
[2025-12-22 04:56:33] GET data: {
    "mode": "F"
}
[2025-12-22 04:56:33] Company ID from session: 4
[2025-12-22 04:56:33] Database connection included
[2025-12-22 04:56:33] License functions included
[2025-12-22 04:56:33] License type: FL-III
[2025-12-22 04:56:33] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 04:56:33] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 04:56:33] Purchase mode: F
[2025-12-22 04:56:33] Next voucher number: 1
[2025-12-22 04:56:33] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 04:56:33] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 04:56:33] Items fetched from database: {
    "count": 3551,
    "license_filter_applied": true
}
[2025-12-22 04:56:33] Suppliers fetched: {
    "count": 36
}
[2025-12-22 04:56:33] === FORM SUBMISSION STARTED ===
[2025-12-22 04:56:33] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "1",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "SAMB",
    "supplier_name": "SAMBARAGI TRADERS",
    "basic_amt": "0.00",
    "total_amt": "0.00"
}
[2025-12-22 04:56:33] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-22 04:56:33] Purchase header inserted successfully: {
    "purchase_id": 3,
    "affected_rows": 1
}
[2025-12-22 04:56:33] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-22 04:56:33] Processing item 0: {
    "item_code": "SCMKS0039633",
    "mrp": 440,
    "tot_bott": 3
}
[2025-12-22 04:56:33] cleanItemCode: 'SCMKS0039633' -> 'KS0039633'
[2025-12-22 04:56:33] Updating MRP for item: {
    "item_code": "KS0039633",
    "mrp": 440
}
[2025-12-22 04:56:33] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "KS0039633",
    "mrp": 440
}
[2025-12-22 04:56:33] Updating stock for item: {
    "item_code": "SCMKS0039633",
    "total_bottles": 3,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-22 04:56:33] Month is archived, updating archive table with cascading
[2025-12-22 04:56:33] Updating archived month stock: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "dayOfMonth": "18",
    "totalBottles": 3
}
[2025-12-22 04:56:33] Starting cascading updates in table: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "purchaseDay": "18"
}
[2025-12-22 04:56:33] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-22 04:56:33] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-22 04:56:33] Cascading updates completed for all days after purchase day
[2025-12-22 04:56:33] Continuing cascading to current month: {
    "comp_id": 4,
    "itemCode": "SCMKS0039633",
    "purchaseDate": "2025-11-18"
}
[2025-12-22 04:56:33] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-22 04:56:34] Cascading completed up to current date
[2025-12-22 04:56:34] Processing item 1: {
    "item_code": "SCMLS0042805",
    "mrp": 850,
    "tot_bott": 1
}
[2025-12-22 04:56:34] cleanItemCode: 'SCMLS0042805' -> 'LS0042805'
[2025-12-22 04:56:34] Updating MRP for item: {
    "item_code": "LS0042805",
    "mrp": 850
}
[2025-12-22 04:56:34] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "LS0042805",
    "mrp": 850
}
[2025-12-22 04:56:34] Updating stock for item: {
    "item_code": "SCMLS0042805",
    "total_bottles": 1,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-22 04:56:34] Month is archived, updating archive table with cascading
[2025-12-22 04:56:34] Updating archived month stock: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMLS0042805",
    "dayOfMonth": "18",
    "totalBottles": 1
}
[2025-12-22 04:56:34] Starting cascading updates in table: {
    "table": "tbldailystock_4_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMLS0042805",
    "purchaseDay": "18"
}
[2025-12-22 04:56:34] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-22 04:56:34] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_4_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-22 04:56:34] Cascading updates completed for all days after purchase day
[2025-12-22 04:56:34] Continuing cascading to current month: {
    "comp_id": 4,
    "itemCode": "SCMLS0042805",
    "purchaseDate": "2025-11-18"
}
[2025-12-22 04:56:34] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-22 04:56:34] Cascading completed up to current date
[2025-12-22 04:56:34] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-22 04:56:34] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-22 08:12:24] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 08:12:24] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-22 08:12:24] POST data: []
[2025-12-22 08:12:24] GET data: []
[2025-12-22 08:12:24] Company ID from session: 1
[2025-12-22 08:12:24] Database connection included
[2025-12-22 08:12:24] License functions included
[2025-12-22 08:12:24] License type: FL-III
[2025-12-22 08:12:24] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 08:12:24] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 08:12:24] Purchase mode: F
[2025-12-22 08:12:24] Next voucher number: 1
[2025-12-22 08:12:24] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 08:12:24] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 08:12:24] Items fetched from database: {
    "count": 4693,
    "license_filter_applied": true
}
[2025-12-22 08:12:24] Suppliers fetched: {
    "count": 36
}
[2025-12-22 08:12:24] Database connection closed
[2025-12-22 08:12:24] === PURCHASE SESSION ENDED ===
[2025-12-22 08:12:32] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 08:12:32] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-22 08:12:32] POST data: []
[2025-12-22 08:12:32] GET data: []
[2025-12-22 08:12:32] Company ID from session: 1
[2025-12-22 08:12:32] Database connection included
[2025-12-22 08:12:32] License functions included
[2025-12-22 08:12:32] License type: FL-III
[2025-12-22 08:12:32] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 08:12:32] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 08:12:32] Purchase mode: F
[2025-12-22 08:12:32] Next voucher number: 1
[2025-12-22 08:12:32] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 08:12:32] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 08:12:32] Items fetched from database: {
    "count": 4693,
    "license_filter_applied": true
}
[2025-12-22 08:12:32] Suppliers fetched: {
    "count": 36
}
[2025-12-22 08:12:32] Database connection closed
[2025-12-22 08:12:32] === PURCHASE SESSION ENDED ===
[2025-12-22 08:12:40] === NEW PURCHASE SESSION STARTED ===
[2025-12-22 08:12:40] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-22 08:12:40] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-12",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ASIAN TRADERS",
    "supplier_code": "ASIA",
    "items": [
        {
            "code": "SCMPL0033617",
            "name": "Grand Master's Cranberry Platinum Vodka",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "668",
            "auto_batch": "BTP44-181025\/668",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "42.8",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "1736.000",
            "mrp": "300"
        },
        {
            "code": "SCMPL0033620",
            "name": "Grand Master's Mango Platinum Vodka",
            "size": "180 ML",
            "bottles_per_case": "12",
            "batch_no": "640",
            "auto_batch": "BTP44-111025\/640",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "4559.000",
            "mrp": "300"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "6295.00",
    "tamt": "6295.00"
}
[2025-12-22 08:12:40] GET data: []
[2025-12-22 08:12:40] Company ID from session: 1
[2025-12-22 08:12:40] Database connection included
[2025-12-22 08:12:40] License functions included
[2025-12-22 08:12:40] License type: FL-III
[2025-12-22 08:12:40] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    }
]
[2025-12-22 08:12:40] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "O",
    "O",
    "O",
    "M"
]
[2025-12-22 08:12:40] Purchase mode: F
[2025-12-22 08:12:40] Next voucher number: 1
[2025-12-22 08:12:40] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-22 08:12:40] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "O",
        "O",
        "O",
        "M"
    ],
    "types": "ssssssssssss"
}
[2025-12-22 08:12:40] Items fetched from database: {
    "count": 4693,
    "license_filter_applied": true
}
[2025-12-22 08:12:40] Suppliers fetched: {
    "count": 36
}
[2025-12-22 08:12:40] === FORM SUBMISSION STARTED ===
[2025-12-22 08:12:40] Form data extracted: {
    "date": "2025-11-12",
    "voc_no": "1",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ASIA",
    "supplier_name": "ASIAN TRADERS",
    "basic_amt": "6295.00",
    "total_amt": "6295.00"
}
[2025-12-22 08:12:40] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-22 08:12:40] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-22 08:12:40] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-22 08:12:40] Processing item 0: {
    "item_code": "SCMPL0033617",
    "mrp": 300,
    "tot_bott": 48
}
[2025-12-22 08:12:40] cleanItemCode: 'SCMPL0033617' -> 'PL0033617'
[2025-12-22 08:12:40] Updating MRP for item: {
    "item_code": "PL0033617",
    "mrp": 300
}
[2025-12-22 08:12:40] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0033617",
    "mrp": 300
}
[2025-12-22 08:12:40] Updating stock for item: {
    "item_code": "SCMPL0033617",
    "total_bottles": 48,
    "purchase_date": "2025-11-12",
    "day_of_month": "12",
    "month": "11",
    "year": "2025"
}
[2025-12-22 08:12:40] Month is current, updating current table with cascading
[2025-12-22 08:12:40] Updating current month stock: {
    "table": "tbldailystock_1",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033617",
    "dayOfMonth": "12",
    "totalBottles": 48
}
[2025-12-22 08:12:40] Processing item 1: {
    "item_code": "SCMPL0033620",
    "mrp": 300,
    "tot_bott": 48
}
[2025-12-22 08:12:40] cleanItemCode: 'SCMPL0033620' -> 'PL0033620'
[2025-12-22 08:12:40] Updating MRP for item: {
    "item_code": "PL0033620",
    "mrp": 300
}
[2025-12-22 08:12:40] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0033620",
    "mrp": 300
}
[2025-12-22 08:12:40] Updating stock for item: {
    "item_code": "SCMPL0033620",
    "total_bottles": 48,
    "purchase_date": "2025-11-12",
    "day_of_month": "12",
    "month": "11",
    "year": "2025"
}
[2025-12-22 08:12:40] Month is current, updating current table with cascading
[2025-12-22 08:12:40] Updating current month stock: {
    "table": "tbldailystock_1",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033620",
    "dayOfMonth": "12",
    "totalBottles": 48
}
[2025-12-22 08:12:40] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-22 08:12:40] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 14:43:41] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 14:43:41] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 14:43:41] POST data: []
[2025-12-23 14:43:41] GET data: []
[2025-12-23 14:43:41] Company ID from session: 1
[2025-12-23 14:43:41] Database connection included
[2025-12-23 14:43:41] License functions included
[2025-12-23 14:43:41] License type: FL-II
[2025-12-23 14:43:41] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 14:43:41] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 14:43:41] Purchase mode: F
[2025-12-23 14:43:41] Next voucher number: 1
[2025-12-23 14:43:41] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 14:43:41] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 14:43:42] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 14:43:42] Suppliers fetched: {
    "count": 36
}
[2025-12-23 14:43:42] Database connection closed
[2025-12-23 14:43:42] === PURCHASE SESSION ENDED ===
[2025-12-23 15:45:53] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:45:53] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:45:53] POST data: []
[2025-12-23 15:45:53] GET data: []
[2025-12-23 15:45:53] Company ID from session: 1
[2025-12-23 15:45:53] Database connection included
[2025-12-23 15:45:53] License functions included
[2025-12-23 15:45:53] License type: FL-II
[2025-12-23 15:45:53] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:45:53] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:45:53] Purchase mode: F
[2025-12-23 15:45:53] Next voucher number: 1
[2025-12-23 15:45:53] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:45:53] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:45:53] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:45:53] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:45:53] Database connection closed
[2025-12-23 15:45:53] === PURCHASE SESSION ENDED ===
[2025-12-23 15:46:02] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:46:02] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:46:02] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-08",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "229",
            "auto_batch": "BTBL2-291025\/620",
            "mfg_month": "Oct-2025",
            "bl": "23.4",
            "vv": "8",
            "tot_bott": "36",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0009847",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "213",
            "auto_batch": "BTBL2-161025\/580",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018145",
            "name": "London Pilsner Premium Strong Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "109",
            "auto_batch": "BTBL2-280925\/511",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "165"
        },
        {
            "code": "SCMBR0018149",
            "name": "Kingfisher Premium Lager Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "33",
            "auto_batch": "BTBL2-101025\/555",
            "mfg_month": "Oct-2025",
            "bl": "7.8",
            "vv": "5",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "200"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "2060.00",
    "tamt": "2060.00"
}
[2025-12-23 15:46:02] GET data: []
[2025-12-23 15:46:02] Company ID from session: 1
[2025-12-23 15:46:02] Database connection included
[2025-12-23 15:46:02] License functions included
[2025-12-23 15:46:02] License type: FL-II
[2025-12-23 15:46:02] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:46:02] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:46:02] Purchase mode: F
[2025-12-23 15:46:02] Next voucher number: 1
[2025-12-23 15:46:02] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:46:02] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:46:02] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:46:02] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:46:02] === FORM SUBMISSION STARTED ===
[2025-12-23 15:46:02] Form data extracted: {
    "date": "2025-11-08",
    "voc_no": "1",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "2060.00",
    "total_amt": "2060.00"
}
[2025-12-23 15:46:02] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:46:02] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-23 15:46:02] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-23 15:46:02] Processing item 0: {
    "item_code": "SCMBR0009846",
    "mrp": 195,
    "tot_bott": 36
}
[2025-12-23 15:46:02] cleanItemCode: 'SCMBR0009846' -> 'BR0009846'
[2025-12-23 15:46:02] Updating MRP for item: {
    "item_code": "BR0009846",
    "mrp": 195
}
[2025-12-23 15:46:02] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009846",
    "mrp": 195
}
[2025-12-23 15:46:02] Updating stock for item: {
    "item_code": "SCMBR0009846",
    "total_bottles": 36,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:46:02] Month is archived, updating archive table with cascading
[2025-12-23 15:46:02] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009846",
    "dayOfMonth": "8",
    "totalBottles": 36
}
[2025-12-23 15:46:02] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009846",
    "purchaseDay": "8"
}
[2025-12-23 15:46:02] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_09_OPEN = DAY_08_CLOSING,\n                           DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_10_OPEN = DAY_09_CLOSING,\n                           DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_11_OPEN = DAY_10_CLOSING,\n                           DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_12_OPEN = DAY_11_CLOSING,\n                           DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_13_OPEN = DAY_12_CLOSING,\n                           DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_14_OPEN = DAY_13_CLOSING,\n                           DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-23 15:46:02] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:46:03] Cascading updates completed for all days after purchase day
[2025-12-23 15:46:03] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0009846",
    "purchaseDate": "2025-11-08"
}
[2025-12-23 15:46:03] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:46:03] Cascading completed up to current date
[2025-12-23 15:46:03] Processing item 1: {
    "item_code": "SCMBR0009847",
    "mrp": 130,
    "tot_bott": 24
}
[2025-12-23 15:46:03] cleanItemCode: 'SCMBR0009847' -> 'BR0009847'
[2025-12-23 15:46:03] Updating MRP for item: {
    "item_code": "BR0009847",
    "mrp": 130
}
[2025-12-23 15:46:03] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009847",
    "mrp": 130
}
[2025-12-23 15:46:03] Updating stock for item: {
    "item_code": "SCMBR0009847",
    "total_bottles": 24,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:46:03] Month is archived, updating archive table with cascading
[2025-12-23 15:46:03] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009847",
    "dayOfMonth": "8",
    "totalBottles": 24
}
[2025-12-23 15:46:03] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009847",
    "purchaseDay": "8"
}
[2025-12-23 15:46:03] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_09_OPEN = DAY_08_CLOSING,\n                           DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_10_OPEN = DAY_09_CLOSING,\n                           DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_11_OPEN = DAY_10_CLOSING,\n                           DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_12_OPEN = DAY_11_CLOSING,\n                           DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_13_OPEN = DAY_12_CLOSING,\n                           DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_14_OPEN = DAY_13_CLOSING,\n                           DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:46:03] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:46:04] Cascading updates completed for all days after purchase day
[2025-12-23 15:46:04] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0009847",
    "purchaseDate": "2025-11-08"
}
[2025-12-23 15:46:04] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:46:04] Cascading completed up to current date
[2025-12-23 15:46:04] Processing item 2: {
    "item_code": "SCMBR0018145",
    "mrp": 165,
    "tot_bott": 12
}
[2025-12-23 15:46:04] cleanItemCode: 'SCMBR0018145' -> 'BR0018145'
[2025-12-23 15:46:04] Updating MRP for item: {
    "item_code": "BR0018145",
    "mrp": 165
}
[2025-12-23 15:46:04] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018145",
    "mrp": 165
}
[2025-12-23 15:46:04] Updating stock for item: {
    "item_code": "SCMBR0018145",
    "total_bottles": 12,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:46:04] Month is archived, updating archive table with cascading
[2025-12-23 15:46:04] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018145",
    "dayOfMonth": "8",
    "totalBottles": 12
}
[2025-12-23 15:46:04] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018145",
    "purchaseDay": "8"
}
[2025-12-23 15:46:04] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_09_OPEN = DAY_08_CLOSING,\n                           DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_10_OPEN = DAY_09_CLOSING,\n                           DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_11_OPEN = DAY_10_CLOSING,\n                           DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_12_OPEN = DAY_11_CLOSING,\n                           DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_13_OPEN = DAY_12_CLOSING,\n                           DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_14_OPEN = DAY_13_CLOSING,\n                           DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:46:04] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:46:04] Cascading updates completed for all days after purchase day
[2025-12-23 15:46:04] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018145",
    "purchaseDate": "2025-11-08"
}
[2025-12-23 15:46:04] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:46:05] Cascading completed up to current date
[2025-12-23 15:46:05] Processing item 3: {
    "item_code": "SCMBR0018149",
    "mrp": 200,
    "tot_bott": 12
}
[2025-12-23 15:46:05] cleanItemCode: 'SCMBR0018149' -> 'BR0018149'
[2025-12-23 15:46:05] Updating MRP for item: {
    "item_code": "BR0018149",
    "mrp": 200
}
[2025-12-23 15:46:05] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018149",
    "mrp": 200
}
[2025-12-23 15:46:05] Updating stock for item: {
    "item_code": "SCMBR0018149",
    "total_bottles": 12,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:46:05] Month is archived, updating archive table with cascading
[2025-12-23 15:46:05] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018149",
    "dayOfMonth": "8",
    "totalBottles": 12
}
[2025-12-23 15:46:05] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018149",
    "purchaseDay": "8"
}
[2025-12-23 15:46:05] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_09_OPEN = DAY_08_CLOSING,\n                           DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_10_OPEN = DAY_09_CLOSING,\n                           DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_11_OPEN = DAY_10_CLOSING,\n                           DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_12_OPEN = DAY_11_CLOSING,\n                           DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_13_OPEN = DAY_12_CLOSING,\n                           DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_14_OPEN = DAY_13_CLOSING,\n                           DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:46:05] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:46:05] Cascading updates completed for all days after purchase day
[2025-12-23 15:46:05] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018149",
    "purchaseDate": "2025-11-08"
}
[2025-12-23 15:46:05] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:46:05] Cascading completed up to current date
[2025-12-23 15:46:05] Purchase items processing completed: {
    "successful_items": 4
}
[2025-12-23 15:46:05] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:46:59] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:46:59] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:46:59] POST data: []
[2025-12-23 15:46:59] GET data: []
[2025-12-23 15:46:59] Company ID from session: 1
[2025-12-23 15:46:59] Database connection included
[2025-12-23 15:46:59] License functions included
[2025-12-23 15:46:59] License type: FL-II
[2025-12-23 15:46:59] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:46:59] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:46:59] Purchase mode: F
[2025-12-23 15:46:59] Next voucher number: 2
[2025-12-23 15:46:59] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:46:59] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:46:59] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:46:59] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:46:59] Database connection closed
[2025-12-23 15:46:59] === PURCHASE SESSION ENDED ===
[2025-12-23 15:47:09] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:47:09] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:47:09] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-12",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ASIAN TRADERS",
    "supplier_code": "ASIA",
    "items": [
        {
            "code": "SCMPL0033617",
            "name": "Grand Master\\'s Cranberry Platinum Vodka .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "668",
            "auto_batch": "BTP44-181025\/668",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "42.8",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "300"
        },
        {
            "code": "SCMPL0033620",
            "name": "Grand Master\\'s Mango Platinum Vodka .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "640",
            "auto_batch": "BTP44-111025\/640",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "300"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "180.00",
    "tamt": "180.00"
}
[2025-12-23 15:47:09] GET data: []
[2025-12-23 15:47:09] Company ID from session: 1
[2025-12-23 15:47:09] Database connection included
[2025-12-23 15:47:09] License functions included
[2025-12-23 15:47:09] License type: FL-II
[2025-12-23 15:47:09] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:47:09] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:47:09] Purchase mode: F
[2025-12-23 15:47:09] Next voucher number: 2
[2025-12-23 15:47:09] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:47:09] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:47:09] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:47:09] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:47:09] === FORM SUBMISSION STARTED ===
[2025-12-23 15:47:09] Form data extracted: {
    "date": "2025-11-12",
    "voc_no": "2",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ASIA",
    "supplier_name": "ASIAN TRADERS",
    "basic_amt": "180.00",
    "total_amt": "180.00"
}
[2025-12-23 15:47:09] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:47:09] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-23 15:47:09] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-23 15:47:09] Processing item 0: {
    "item_code": "SCMPL0033617",
    "mrp": 300,
    "tot_bott": 48
}
[2025-12-23 15:47:09] cleanItemCode: 'SCMPL0033617' -> 'PL0033617'
[2025-12-23 15:47:09] Updating MRP for item: {
    "item_code": "PL0033617",
    "mrp": 300
}
[2025-12-23 15:47:09] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0033617",
    "mrp": 300
}
[2025-12-23 15:47:09] Updating stock for item: {
    "item_code": "SCMPL0033617",
    "total_bottles": 48,
    "purchase_date": "2025-11-12",
    "day_of_month": "12",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:47:09] Month is archived, updating archive table with cascading
[2025-12-23 15:47:09] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033617",
    "dayOfMonth": "12",
    "totalBottles": 48
}
[2025-12-23 15:47:09] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033617",
    "purchaseDay": "12"
}
[2025-12-23 15:47:09] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_13_OPEN = DAY_12_CLOSING,\n                           DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_14_OPEN = DAY_13_CLOSING,\n                           DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:47:09] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:47:09] Cascading updates completed for all days after purchase day
[2025-12-23 15:47:09] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0033617",
    "purchaseDate": "2025-11-12"
}
[2025-12-23 15:47:09] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:47:09] Cascading completed up to current date
[2025-12-23 15:47:09] Processing item 1: {
    "item_code": "SCMPL0033620",
    "mrp": 300,
    "tot_bott": 48
}
[2025-12-23 15:47:09] cleanItemCode: 'SCMPL0033620' -> 'PL0033620'
[2025-12-23 15:47:09] Updating MRP for item: {
    "item_code": "PL0033620",
    "mrp": 300
}
[2025-12-23 15:47:09] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0033620",
    "mrp": 300
}
[2025-12-23 15:47:09] Updating stock for item: {
    "item_code": "SCMPL0033620",
    "total_bottles": 48,
    "purchase_date": "2025-11-12",
    "day_of_month": "12",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:47:09] Month is archived, updating archive table with cascading
[2025-12-23 15:47:09] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033620",
    "dayOfMonth": "12",
    "totalBottles": 48
}
[2025-12-23 15:47:09] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033620",
    "purchaseDay": "12"
}
[2025-12-23 15:47:09] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_13_OPEN = DAY_12_CLOSING,\n                           DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_14_OPEN = DAY_13_CLOSING,\n                           DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:47:10] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:47:10] Cascading updates completed for all days after purchase day
[2025-12-23 15:47:10] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0033620",
    "purchaseDate": "2025-11-12"
}
[2025-12-23 15:47:10] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:47:10] Cascading completed up to current date
[2025-12-23 15:47:10] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-23 15:47:10] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:47:34] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:47:34] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:47:34] POST data: []
[2025-12-23 15:47:34] GET data: {
    "mode": "F"
}
[2025-12-23 15:47:34] Company ID from session: 1
[2025-12-23 15:47:34] Database connection included
[2025-12-23 15:47:34] License functions included
[2025-12-23 15:47:34] License type: FL-II
[2025-12-23 15:47:34] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:47:34] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:47:34] Purchase mode: F
[2025-12-23 15:47:34] Next voucher number: 3
[2025-12-23 15:47:34] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:47:34] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:47:34] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:47:34] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:47:34] Database connection closed
[2025-12-23 15:47:34] === PURCHASE SESSION ENDED ===
[2025-12-23 15:48:46] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:48:46] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:48:46] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-23 15:48:46] GET data: {
    "mode": "F"
}
[2025-12-23 15:48:46] Company ID from session: 1
[2025-12-23 15:48:46] Database connection included
[2025-12-23 15:48:46] License functions included
[2025-12-23 15:48:46] License type: FL-II
[2025-12-23 15:48:46] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:48:46] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:48:46] Purchase mode: F
[2025-12-23 15:48:46] Next voucher number: 3
[2025-12-23 15:48:46] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:48:46] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:48:46] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:48:46] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:48:46] === FORM SUBMISSION STARTED ===
[2025-12-23 15:48:46] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "3",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-23 15:48:46] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:48:46] Purchase header inserted successfully: {
    "purchase_id": 3,
    "affected_rows": 1
}
[2025-12-23 15:48:46] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-23 15:48:46] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-23 15:48:47] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-23 15:48:47] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-23 15:48:47] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-23 15:48:47] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:48:47] Month is archived, updating archive table with cascading
[2025-12-23 15:48:47] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-23 15:48:47] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "purchaseDay": "14"
}
[2025-12-23 15:48:47] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:48:47] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:48:47] Cascading updates completed for all days after purchase day
[2025-12-23 15:48:47] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010087",
    "purchaseDate": "2025-11-14"
}
[2025-12-23 15:48:47] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:48:47] Cascading completed up to current date
[2025-12-23 15:48:47] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-23 15:48:47] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:49:07] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:49:07] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:49:07] POST data: []
[2025-12-23 15:49:07] GET data: {
    "mode": "F"
}
[2025-12-23 15:49:07] Company ID from session: 1
[2025-12-23 15:49:07] Database connection included
[2025-12-23 15:49:07] License functions included
[2025-12-23 15:49:07] License type: FL-II
[2025-12-23 15:49:07] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:49:07] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:49:07] Purchase mode: F
[2025-12-23 15:49:07] Next voucher number: 4
[2025-12-23 15:49:07] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:49:07] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:49:07] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:49:07] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:49:07] Database connection closed
[2025-12-23 15:49:07] === PURCHASE SESSION ENDED ===
[2025-12-23 15:49:19] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:49:19] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:49:19] POST data: {
    "mode": "F",
    "voc_no": "4",
    "date": "2025-11-18",
    "auto_tp_no": "FL170-171125\/24022",
    "tp_no": "24022",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMBR0018160",
            "name": "Carlsberg Elephant Strong Super Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "762",
            "auto_batch": "BTBL4-160925\/762",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "250"
        },
        {
            "code": "SCMBR0018161",
            "name": "Tuborg Strong Premium Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "814",
            "auto_batch": "BTBL5-131025\/970",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018164",
            "name": "Tuborg Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "925",
            "auto_batch": "BTBL5-131125\/1120",
            "mfg_month": "Nov-2025",
            "bl": "31.2",
            "vv": "8",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "4",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "195"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "3400.00",
    "tamt": "3400.00"
}
[2025-12-23 15:49:19] GET data: {
    "mode": "F"
}
[2025-12-23 15:49:19] Company ID from session: 1
[2025-12-23 15:49:19] Database connection included
[2025-12-23 15:49:19] License functions included
[2025-12-23 15:49:19] License type: FL-II
[2025-12-23 15:49:19] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:49:19] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:49:19] Purchase mode: F
[2025-12-23 15:49:19] Next voucher number: 4
[2025-12-23 15:49:19] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:49:19] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:49:19] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:49:19] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:49:19] === FORM SUBMISSION STARTED ===
[2025-12-23 15:49:19] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "4",
    "auto_tp_no": "FL170-171125\/24022",
    "tp_no": "24022",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "3400.00",
    "total_amt": "3400.00"
}
[2025-12-23 15:49:19] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:49:19] Purchase header inserted successfully: {
    "purchase_id": 4,
    "affected_rows": 1
}
[2025-12-23 15:49:19] Starting to process purchase items: {
    "item_count": 3
}
[2025-12-23 15:49:19] Processing item 0: {
    "item_code": "SCMBR0018160",
    "mrp": 250,
    "tot_bott": 12
}
[2025-12-23 15:49:19] cleanItemCode: 'SCMBR0018160' -> 'BR0018160'
[2025-12-23 15:49:19] Updating MRP for item: {
    "item_code": "BR0018160",
    "mrp": 250
}
[2025-12-23 15:49:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018160",
    "mrp": 250
}
[2025-12-23 15:49:19] Updating stock for item: {
    "item_code": "SCMBR0018160",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:49:19] Month is archived, updating archive table with cascading
[2025-12-23 15:49:19] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018160",
    "dayOfMonth": "18",
    "totalBottles": 12
}
[2025-12-23 15:49:19] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018160",
    "purchaseDay": "18"
}
[2025-12-23 15:49:19] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:49:19] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:49:19] Cascading updates completed for all days after purchase day
[2025-12-23 15:49:19] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018160",
    "purchaseDate": "2025-11-18"
}
[2025-12-23 15:49:19] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:49:20] Cascading completed up to current date
[2025-12-23 15:49:20] Processing item 1: {
    "item_code": "SCMBR0018161",
    "mrp": 130,
    "tot_bott": 24
}
[2025-12-23 15:49:20] cleanItemCode: 'SCMBR0018161' -> 'BR0018161'
[2025-12-23 15:49:20] Updating MRP for item: {
    "item_code": "BR0018161",
    "mrp": 130
}
[2025-12-23 15:49:20] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018161",
    "mrp": 130
}
[2025-12-23 15:49:20] Updating stock for item: {
    "item_code": "SCMBR0018161",
    "total_bottles": 24,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:49:20] Month is archived, updating archive table with cascading
[2025-12-23 15:49:20] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "dayOfMonth": "18",
    "totalBottles": 24
}
[2025-12-23 15:49:20] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "purchaseDay": "18"
}
[2025-12-23 15:49:20] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:49:20] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:49:20] Cascading updates completed for all days after purchase day
[2025-12-23 15:49:20] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018161",
    "purchaseDate": "2025-11-18"
}
[2025-12-23 15:49:20] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:49:20] Cascading completed up to current date
[2025-12-23 15:49:20] Processing item 2: {
    "item_code": "SCMBR0018164",
    "mrp": 195,
    "tot_bott": 48
}
[2025-12-23 15:49:20] cleanItemCode: 'SCMBR0018164' -> 'BR0018164'
[2025-12-23 15:49:20] Updating MRP for item: {
    "item_code": "BR0018164",
    "mrp": 195
}
[2025-12-23 15:49:21] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018164",
    "mrp": 195
}
[2025-12-23 15:49:21] Updating stock for item: {
    "item_code": "SCMBR0018164",
    "total_bottles": 48,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:49:21] Month is archived, updating archive table with cascading
[2025-12-23 15:49:21] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "dayOfMonth": "18",
    "totalBottles": 48
}
[2025-12-23 15:49:21] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "purchaseDay": "18"
}
[2025-12-23 15:49:21] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:49:21] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:49:21] Cascading updates completed for all days after purchase day
[2025-12-23 15:49:21] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018164",
    "purchaseDate": "2025-11-18"
}
[2025-12-23 15:49:21] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:49:21] Cascading completed up to current date
[2025-12-23 15:49:21] Purchase items processing completed: {
    "successful_items": 3
}
[2025-12-23 15:49:21] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:49:48] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:49:48] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:49:48] POST data: []
[2025-12-23 15:49:48] GET data: {
    "mode": "F"
}
[2025-12-23 15:49:48] Company ID from session: 1
[2025-12-23 15:49:48] Database connection included
[2025-12-23 15:49:48] License functions included
[2025-12-23 15:49:48] License type: FL-II
[2025-12-23 15:49:48] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:49:48] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:49:48] Purchase mode: F
[2025-12-23 15:49:48] Next voucher number: 5
[2025-12-23 15:49:48] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:49:48] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:49:48] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-23 15:49:48] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:49:49] Database connection closed
[2025-12-23 15:49:49] === PURCHASE SESSION ENDED ===
[2025-12-23 15:50:55] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:50:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:50:55] POST data: []
[2025-12-23 15:50:55] GET data: []
[2025-12-23 15:50:55] Company ID from session: 1
[2025-12-23 15:50:55] Database connection included
[2025-12-23 15:50:55] License functions included
[2025-12-23 15:50:55] License type: FL-II
[2025-12-23 15:50:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:50:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:50:55] Purchase mode: F
[2025-12-23 15:50:55] Next voucher number: 5
[2025-12-23 15:50:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:50:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:50:56] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:50:56] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:50:56] Database connection closed
[2025-12-23 15:50:56] === PURCHASE SESSION ENDED ===
[2025-12-23 15:51:06] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:51:06] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:51:06] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-11-18",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "SAMBARAGI TRADERS",
    "supplier_code": "SAMB",
    "items": [
        {
            "code": "SCMKS0039633",
            "name": "Smirnoff Minty Jamum Triple Distilled Flavoured Vo",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "33",
            "auto_batch": "BTOS190-1291",
            "mfg_month": "Oct-2025",
            "bl": "0.54",
            "vv": "25",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "80.000",
            "mrp": "440"
        },
        {
            "code": "SCMLS0042805",
            "name": "Johnnie Walker Blonde Blended Scotch Whisky .",
            "size": "200 ML (24)",
            "bottles_per_case": "24",
            "batch_no": "I1221025",
            "auto_batch": "BTOI67-824",
            "mfg_month": "Sep-2025",
            "bl": "0.2",
            "vv": "25",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "1",
            "case_rate": "0.000",
            "mrp": "850"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "240.00",
    "tamt": "240.00"
}
[2025-12-23 15:51:06] GET data: []
[2025-12-23 15:51:06] Company ID from session: 1
[2025-12-23 15:51:06] Database connection included
[2025-12-23 15:51:06] License functions included
[2025-12-23 15:51:06] License type: FL-II
[2025-12-23 15:51:06] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:51:06] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:51:06] Purchase mode: F
[2025-12-23 15:51:06] Next voucher number: 5
[2025-12-23 15:51:06] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:51:06] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:51:07] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:51:07] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:51:07] === FORM SUBMISSION STARTED ===
[2025-12-23 15:51:07] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "5",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "SAMB",
    "supplier_name": "SAMBARAGI TRADERS",
    "basic_amt": "240.00",
    "total_amt": "240.00"
}
[2025-12-23 15:51:07] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:51:07] Purchase header inserted successfully: {
    "purchase_id": 5,
    "affected_rows": 1
}
[2025-12-23 15:51:07] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-23 15:51:07] Processing item 0: {
    "item_code": "SCMKS0039633",
    "mrp": 440,
    "tot_bott": 3
}
[2025-12-23 15:51:07] cleanItemCode: 'SCMKS0039633' -> 'KS0039633'
[2025-12-23 15:51:07] Updating MRP for item: {
    "item_code": "KS0039633",
    "mrp": 440
}
[2025-12-23 15:51:07] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "KS0039633",
    "mrp": 440
}
[2025-12-23 15:51:07] Updating stock for item: {
    "item_code": "SCMKS0039633",
    "total_bottles": 3,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:51:07] Month is archived, updating archive table with cascading
[2025-12-23 15:51:07] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "dayOfMonth": "18",
    "totalBottles": 3
}
[2025-12-23 15:51:07] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "purchaseDay": "18"
}
[2025-12-23 15:51:07] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:51:07] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:51:07] Cascading updates completed for all days after purchase day
[2025-12-23 15:51:07] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMKS0039633",
    "purchaseDate": "2025-11-18"
}
[2025-12-23 15:51:07] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:51:07] Cascading completed up to current date
[2025-12-23 15:51:07] Processing item 1: {
    "item_code": "SCMLS0042805",
    "mrp": 850,
    "tot_bott": 1
}
[2025-12-23 15:51:07] cleanItemCode: 'SCMLS0042805' -> 'LS0042805'
[2025-12-23 15:51:07] Updating MRP for item: {
    "item_code": "LS0042805",
    "mrp": 850
}
[2025-12-23 15:51:07] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "LS0042805",
    "mrp": 850
}
[2025-12-23 15:51:07] Updating stock for item: {
    "item_code": "SCMLS0042805",
    "total_bottles": 1,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:51:07] Month is archived, updating archive table with cascading
[2025-12-23 15:51:07] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMLS0042805",
    "dayOfMonth": "18",
    "totalBottles": 1
}
[2025-12-23 15:51:07] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMLS0042805",
    "purchaseDate": "2025-11-18"
}
[2025-12-23 15:51:07] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:51:07] Cascading completed up to current date
[2025-12-23 15:51:07] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-23 15:51:07] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:51:28] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:51:28] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:51:28] POST data: []
[2025-12-23 15:51:28] GET data: {
    "mode": "F"
}
[2025-12-23 15:51:28] Company ID from session: 1
[2025-12-23 15:51:28] Database connection included
[2025-12-23 15:51:28] License functions included
[2025-12-23 15:51:28] License type: FL-II
[2025-12-23 15:51:28] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:51:28] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:51:28] Purchase mode: F
[2025-12-23 15:51:28] Next voucher number: 6
[2025-12-23 15:51:28] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:51:28] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:51:28] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:51:28] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:51:28] Database connection closed
[2025-12-23 15:51:28] === PURCHASE SESSION ENDED ===
[2025-12-23 15:51:36] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:51:36] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:51:36] POST data: {
    "mode": "F",
    "voc_no": "6",
    "date": "2025-11-19",
    "auto_tp_no": "FL177-181125\/10070",
    "tp_no": "10070",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ROCKY TRADERS",
    "supplier_code": "ROCK",
    "items": [
        {
            "code": "SCMPL0041325",
            "name": "Old Monk Very Old Vatted XXX Rum .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "409",
            "auto_batch": "BTP31-311025\/409",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "110"
        },
        {
            "code": "SCMPL0041326",
            "name": "Old Monk Very Old Vatted XXX Rum .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "441",
            "auto_batch": "BTP31-111125\/441",
            "mfg_month": "Nov-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "215"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "960.00",
    "tamt": "960.00"
}
[2025-12-23 15:51:36] GET data: {
    "mode": "F"
}
[2025-12-23 15:51:36] Company ID from session: 1
[2025-12-23 15:51:36] Database connection included
[2025-12-23 15:51:36] License functions included
[2025-12-23 15:51:36] License type: FL-II
[2025-12-23 15:51:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:51:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:51:36] Purchase mode: F
[2025-12-23 15:51:36] Next voucher number: 6
[2025-12-23 15:51:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:51:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:51:37] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:51:37] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:51:37] === FORM SUBMISSION STARTED ===
[2025-12-23 15:51:37] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "6",
    "auto_tp_no": "FL177-181125\/10070",
    "tp_no": "10070",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ROCK",
    "supplier_name": "ROCKY TRADERS",
    "basic_amt": "960.00",
    "total_amt": "960.00"
}
[2025-12-23 15:51:37] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:51:37] Purchase header inserted successfully: {
    "purchase_id": 6,
    "affected_rows": 1
}
[2025-12-23 15:51:37] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-23 15:51:37] Processing item 0: {
    "item_code": "SCMPL0041325",
    "mrp": 110,
    "tot_bott": 96
}
[2025-12-23 15:51:37] cleanItemCode: 'SCMPL0041325' -> 'PL0041325'
[2025-12-23 15:51:37] Updating MRP for item: {
    "item_code": "PL0041325",
    "mrp": 110
}
[2025-12-23 15:51:37] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0041325",
    "mrp": 110
}
[2025-12-23 15:51:37] Updating stock for item: {
    "item_code": "SCMPL0041325",
    "total_bottles": 96,
    "purchase_date": "2025-11-19",
    "day_of_month": "19",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:51:37] Month is archived, updating archive table with cascading
[2025-12-23 15:51:37] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041325",
    "dayOfMonth": "19",
    "totalBottles": 96
}
[2025-12-23 15:51:37] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041325",
    "purchaseDay": "19"
}
[2025-12-23 15:51:37] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:51:37] Cascading updates completed for all days after purchase day
[2025-12-23 15:51:37] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0041325",
    "purchaseDate": "2025-11-19"
}
[2025-12-23 15:51:37] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:51:37] Cascading completed up to current date
[2025-12-23 15:51:37] Processing item 1: {
    "item_code": "SCMPL0041326",
    "mrp": 215,
    "tot_bott": 96
}
[2025-12-23 15:51:37] cleanItemCode: 'SCMPL0041326' -> 'PL0041326'
[2025-12-23 15:51:37] Updating MRP for item: {
    "item_code": "PL0041326",
    "mrp": 215
}
[2025-12-23 15:51:37] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0041326",
    "mrp": 215
}
[2025-12-23 15:51:37] Updating stock for item: {
    "item_code": "SCMPL0041326",
    "total_bottles": 96,
    "purchase_date": "2025-11-19",
    "day_of_month": "19",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:51:37] Month is archived, updating archive table with cascading
[2025-12-23 15:51:37] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041326",
    "dayOfMonth": "19",
    "totalBottles": 96
}
[2025-12-23 15:51:37] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041326",
    "purchaseDay": "19"
}
[2025-12-23 15:51:37] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:51:37] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:51:37] Cascading updates completed for all days after purchase day
[2025-12-23 15:51:37] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0041326",
    "purchaseDate": "2025-11-19"
}
[2025-12-23 15:51:37] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:51:38] Cascading completed up to current date
[2025-12-23 15:51:38] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-23 15:51:38] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:51:59] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:51:59] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:51:59] POST data: []
[2025-12-23 15:51:59] GET data: {
    "mode": "F"
}
[2025-12-23 15:51:59] Company ID from session: 1
[2025-12-23 15:51:59] Database connection included
[2025-12-23 15:51:59] License functions included
[2025-12-23 15:51:59] License type: FL-II
[2025-12-23 15:51:59] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:51:59] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:51:59] Purchase mode: F
[2025-12-23 15:51:59] Next voucher number: 7
[2025-12-23 15:51:59] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:51:59] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:51:59] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:51:59] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:51:59] Database connection closed
[2025-12-23 15:51:59] === PURCHASE SESSION ENDED ===
[2025-12-23 15:52:08] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:52:08] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:52:08] POST data: {
    "mode": "F",
    "voc_no": "7",
    "date": "2025-11-23",
    "auto_tp_no": "FL170-221125\/24665",
    "tp_no": "24666",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMBR0018161",
            "name": "Tuborg Strong Premium Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "810",
            "auto_batch": "BTBL5-121025\/965",
            "mfg_month": "Oct-2025",
            "bl": "39.6",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018164",
            "name": "Tuborg Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "901",
            "auto_batch": "BTBL5-071125\/1086",
            "mfg_month": "Nov-2025",
            "bl": "117",
            "vv": "8",
            "tot_bott": "180",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "15",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "195"
        },
        {
            "code": "SCMPL0036328",
            "name": "Royal Challenge Finest Premium Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "497",
            "auto_batch": "BTP17-311025\/497",
            "mfg_month": "Nov-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "135"
        },
        {
            "code": "SCMPL0042623",
            "name": "Royal Challenge Classic Premium Whisky .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "031",
            "auto_batch": "BTP4-041125\/653",
            "mfg_month": "Nov-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "12680.00",
    "tamt": "12680.00"
}
[2025-12-23 15:52:08] GET data: {
    "mode": "F"
}
[2025-12-23 15:52:08] Company ID from session: 1
[2025-12-23 15:52:08] Database connection included
[2025-12-23 15:52:08] License functions included
[2025-12-23 15:52:08] License type: FL-II
[2025-12-23 15:52:08] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:52:08] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:52:08] Purchase mode: F
[2025-12-23 15:52:08] Next voucher number: 7
[2025-12-23 15:52:08] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:52:08] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:52:08] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:52:08] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:52:08] === FORM SUBMISSION STARTED ===
[2025-12-23 15:52:08] Form data extracted: {
    "date": "2025-11-23",
    "voc_no": "7",
    "auto_tp_no": "FL170-221125\/24665",
    "tp_no": "24666",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "12680.00",
    "total_amt": "12680.00"
}
[2025-12-23 15:52:08] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:52:08] Purchase header inserted successfully: {
    "purchase_id": 7,
    "affected_rows": 1
}
[2025-12-23 15:52:08] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-23 15:52:08] Processing item 0: {
    "item_code": "SCMBR0018161",
    "mrp": 130,
    "tot_bott": 120
}
[2025-12-23 15:52:08] cleanItemCode: 'SCMBR0018161' -> 'BR0018161'
[2025-12-23 15:52:08] Updating MRP for item: {
    "item_code": "BR0018161",
    "mrp": 130
}
[2025-12-23 15:52:08] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018161",
    "mrp": 130
}
[2025-12-23 15:52:08] Updating stock for item: {
    "item_code": "SCMBR0018161",
    "total_bottles": 120,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:52:08] Month is archived, updating archive table with cascading
[2025-12-23 15:52:08] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "dayOfMonth": "23",
    "totalBottles": 120
}
[2025-12-23 15:52:08] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "purchaseDay": "23"
}
[2025-12-23 15:52:08] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:52:08] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:52:08] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:52:09] Cascading updates completed for all days after purchase day
[2025-12-23 15:52:09] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018161",
    "purchaseDate": "2025-11-23"
}
[2025-12-23 15:52:09] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:52:09] Cascading completed up to current date
[2025-12-23 15:52:09] Processing item 1: {
    "item_code": "SCMBR0018164",
    "mrp": 195,
    "tot_bott": 180
}
[2025-12-23 15:52:09] cleanItemCode: 'SCMBR0018164' -> 'BR0018164'
[2025-12-23 15:52:09] Updating MRP for item: {
    "item_code": "BR0018164",
    "mrp": 195
}
[2025-12-23 15:52:09] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018164",
    "mrp": 195
}
[2025-12-23 15:52:09] Updating stock for item: {
    "item_code": "SCMBR0018164",
    "total_bottles": 180,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:52:09] Month is archived, updating archive table with cascading
[2025-12-23 15:52:09] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "dayOfMonth": "23",
    "totalBottles": 180
}
[2025-12-23 15:52:09] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "purchaseDay": "23"
}
[2025-12-23 15:52:09] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:52:09] Cascading updates completed for all days after purchase day
[2025-12-23 15:52:09] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018164",
    "purchaseDate": "2025-11-23"
}
[2025-12-23 15:52:09] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:52:09] Cascading completed up to current date
[2025-12-23 15:52:09] Processing item 2: {
    "item_code": "SCMPL0036328",
    "mrp": 135,
    "tot_bott": 100
}
[2025-12-23 15:52:09] cleanItemCode: 'SCMPL0036328' -> 'PL0036328'
[2025-12-23 15:52:09] Updating MRP for item: {
    "item_code": "PL0036328",
    "mrp": 135
}
[2025-12-23 15:52:09] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036328",
    "mrp": 135
}
[2025-12-23 15:52:09] Updating stock for item: {
    "item_code": "SCMPL0036328",
    "total_bottles": 100,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:52:09] Month is archived, updating archive table with cascading
[2025-12-23 15:52:09] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036328",
    "dayOfMonth": "23",
    "totalBottles": 100
}
[2025-12-23 15:52:09] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036328",
    "purchaseDay": "23"
}
[2025-12-23 15:52:09] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:52:09] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:52:10] Cascading updates completed for all days after purchase day
[2025-12-23 15:52:10] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036328",
    "purchaseDate": "2025-11-23"
}
[2025-12-23 15:52:10] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:52:10] Cascading completed up to current date
[2025-12-23 15:52:10] Processing item 3: {
    "item_code": "SCMPL0042623",
    "mrp": 250,
    "tot_bott": 96
}
[2025-12-23 15:52:10] cleanItemCode: 'SCMPL0042623' -> 'PL0042623'
[2025-12-23 15:52:10] Updating MRP for item: {
    "item_code": "PL0042623",
    "mrp": 250
}
[2025-12-23 15:52:10] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0042623",
    "mrp": 250
}
[2025-12-23 15:52:10] Updating stock for item: {
    "item_code": "SCMPL0042623",
    "total_bottles": 96,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:52:10] Month is archived, updating archive table with cascading
[2025-12-23 15:52:10] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0042623",
    "dayOfMonth": "23",
    "totalBottles": 96
}
[2025-12-23 15:52:10] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0042623",
    "purchaseDay": "23"
}
[2025-12-23 15:52:10] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:52:10] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:52:10] Cascading updates completed for all days after purchase day
[2025-12-23 15:52:10] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0042623",
    "purchaseDate": "2025-11-23"
}
[2025-12-23 15:52:10] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:52:10] Cascading completed up to current date
[2025-12-23 15:52:10] Purchase items processing completed: {
    "successful_items": 4
}
[2025-12-23 15:52:10] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:52:35] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:52:35] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:52:35] POST data: []
[2025-12-23 15:52:35] GET data: {
    "mode": "F"
}
[2025-12-23 15:52:35] Company ID from session: 1
[2025-12-23 15:52:35] Database connection included
[2025-12-23 15:52:35] License functions included
[2025-12-23 15:52:35] License type: FL-II
[2025-12-23 15:52:35] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:52:35] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:52:35] Purchase mode: F
[2025-12-23 15:52:35] Next voucher number: 8
[2025-12-23 15:52:35] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:52:35] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:52:36] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:52:36] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:52:36] Database connection closed
[2025-12-23 15:52:36] === PURCHASE SESSION ENDED ===
[2025-12-23 15:52:50] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:52:50] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:52:50] POST data: {
    "mode": "F",
    "voc_no": "8",
    "date": "2025-11-23",
    "auto_tp_no": "FL1249-221125\/4570",
    "tp_no": "4595",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010088",
            "name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2269",
            "auto_batch": "BTP28-171125\/2269",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "220"
        },
        {
            "code": "SCMPL0010702",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2197",
            "auto_batch": "BTP28-121125\/2197",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "380"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "200.00",
    "tamt": "200.00"
}
[2025-12-23 15:52:50] GET data: {
    "mode": "F"
}
[2025-12-23 15:52:50] Company ID from session: 1
[2025-12-23 15:52:50] Database connection included
[2025-12-23 15:52:50] License functions included
[2025-12-23 15:52:50] License type: FL-II
[2025-12-23 15:52:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:52:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:52:50] Purchase mode: F
[2025-12-23 15:52:50] Next voucher number: 8
[2025-12-23 15:52:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:52:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:52:50] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:52:50] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:52:50] === FORM SUBMISSION STARTED ===
[2025-12-23 15:52:50] Form data extracted: {
    "date": "2025-11-23",
    "voc_no": "8",
    "auto_tp_no": "FL1249-221125\/4570",
    "tp_no": "4595",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "200.00",
    "total_amt": "200.00"
}
[2025-12-23 15:52:50] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:52:50] Purchase header inserted successfully: {
    "purchase_id": 8,
    "affected_rows": 1
}
[2025-12-23 15:52:50] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-23 15:52:50] Processing item 0: {
    "item_code": "SCMPL0010088",
    "mrp": 220,
    "tot_bott": 48
}
[2025-12-23 15:52:50] cleanItemCode: 'SCMPL0010088' -> 'PL0010088'
[2025-12-23 15:52:50] Updating MRP for item: {
    "item_code": "PL0010088",
    "mrp": 220
}
[2025-12-23 15:52:50] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010088",
    "mrp": 220
}
[2025-12-23 15:52:50] Updating stock for item: {
    "item_code": "SCMPL0010088",
    "total_bottles": 48,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:52:50] Month is archived, updating archive table with cascading
[2025-12-23 15:52:50] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010088",
    "dayOfMonth": "23",
    "totalBottles": 48
}
[2025-12-23 15:52:50] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010088",
    "purchaseDay": "23"
}
[2025-12-23 15:52:50] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:52:50] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:52:50] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:52:50] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:52:50] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:52:50] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:52:50] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:52:50] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:52:50] Cascading updates completed for all days after purchase day
[2025-12-23 15:52:50] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010088",
    "purchaseDate": "2025-11-23"
}
[2025-12-23 15:52:50] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:52:51] Cascading completed up to current date
[2025-12-23 15:52:51] Processing item 1: {
    "item_code": "SCMPL0010702",
    "mrp": 380,
    "tot_bott": 48
}
[2025-12-23 15:52:51] cleanItemCode: 'SCMPL0010702' -> 'PL0010702'
[2025-12-23 15:52:51] Updating MRP for item: {
    "item_code": "PL0010702",
    "mrp": 380
}
[2025-12-23 15:52:51] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010702",
    "mrp": 380
}
[2025-12-23 15:52:51] Updating stock for item: {
    "item_code": "SCMPL0010702",
    "total_bottles": 48,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:52:51] Month is archived, updating archive table with cascading
[2025-12-23 15:52:51] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010702",
    "dayOfMonth": "23",
    "totalBottles": 48
}
[2025-12-23 15:52:51] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010702",
    "purchaseDay": "23"
}
[2025-12-23 15:52:51] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-23 15:52:51] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-23 15:52:51] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-23 15:52:51] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-23 15:52:51] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-23 15:52:51] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:52:51] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:52:51] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:52:51] Cascading updates completed for all days after purchase day
[2025-12-23 15:52:51] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010702",
    "purchaseDate": "2025-11-23"
}
[2025-12-23 15:52:51] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:52:51] Cascading completed up to current date
[2025-12-23 15:52:52] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-23 15:52:52] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-23 15:53:08] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:53:08] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:53:08] POST data: []
[2025-12-23 15:53:08] GET data: {
    "mode": "F"
}
[2025-12-23 15:53:08] Company ID from session: 1
[2025-12-23 15:53:08] Database connection included
[2025-12-23 15:53:08] License functions included
[2025-12-23 15:53:08] License type: FL-II
[2025-12-23 15:53:08] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:53:08] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:53:08] Purchase mode: F
[2025-12-23 15:53:08] Next voucher number: 9
[2025-12-23 15:53:08] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:53:08] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:53:09] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:53:09] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:53:09] Database connection closed
[2025-12-23 15:53:09] === PURCHASE SESSION ENDED ===
[2025-12-23 15:53:17] === NEW PURCHASE SESSION STARTED ===
[2025-12-23 15:53:17] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-23 15:53:17] POST data: {
    "mode": "F",
    "voc_no": "9",
    "date": "2025-11-28",
    "auto_tp_no": "FL1305-271125\/12687",
    "tp_no": "12687",
    "tp_date": "2025-11-27",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMBR0009735",
            "name": "Budweiser Premium King of Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "975",
            "auto_batch": "BTBL6-271025\/978",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "5",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "170"
        },
        {
            "code": "SCMBR0018132",
            "name": "Budweiser Premium King of Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "993",
            "auto_batch": "BTBL6-291025\/995",
            "mfg_month": "Oct-2025",
            "bl": "39",
            "vv": "5",
            "tot_bott": "60",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "245"
        },
        {
            "code": "SCMBR0027089",
            "name": "Budweiser Magnum Super Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "887",
            "auto_batch": "BTBL6-061025\/888",
            "mfg_month": "Oct-2025",
            "bl": "78",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0036599",
            "name": "OAKSMITH INTERNATIONAL BLENDED WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "074",
            "auto_batch": "BTP69-280825\/74",
            "mfg_month": "Aug-2025",
            "bl": "2.16",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "12",
            "case_rate": "80.000",
            "mrp": "330"
        },
        {
            "code": "SCMPL0036598",
            "name": "OAKSMITH GOLD INTERNATIONAL BLENDED WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "094",
            "auto_batch": "BTP69-031025\/94",
            "mfg_month": "Oct-2025",
            "bl": "2.16",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "12",
            "case_rate": "800.000",
            "mrp": "400"
        },
        {
            "code": "SCMKB0031388",
            "name": "BUDWEISER MAGNUM UNIVERSAL KING OF BEERS .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "674",
            "auto_batch": "BTBL6-170825\/676",
            "mfg_month": "Aug-2025",
            "bl": "23.76",
            "vv": "8",
            "tot_bott": "72",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "180"
        },
        {
            "code": "SCMPL0031817",
            "name": "BREEZER Tangy CRANBERRY FLAVOUR .",
            "size": "275 ML(24)",
            "bottles_per_case": "24",
            "batch_no": "278",
            "auto_batch": "BTP67-131025\/278",
            "mfg_month": "Oct-2025",
            "bl": "6.6",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "22960.00",
    "tamt": "22960.00"
}
[2025-12-23 15:53:17] GET data: {
    "mode": "F"
}
[2025-12-23 15:53:17] Company ID from session: 1
[2025-12-23 15:53:17] Database connection included
[2025-12-23 15:53:17] License functions included
[2025-12-23 15:53:17] License type: FL-II
[2025-12-23 15:53:17] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-23 15:53:17] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-23 15:53:17] Purchase mode: F
[2025-12-23 15:53:17] Next voucher number: 9
[2025-12-23 15:53:17] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-23 15:53:17] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-23 15:53:18] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-23 15:53:18] Suppliers fetched: {
    "count": 36
}
[2025-12-23 15:53:18] === FORM SUBMISSION STARTED ===
[2025-12-23 15:53:18] Form data extracted: {
    "date": "2025-11-28",
    "voc_no": "9",
    "auto_tp_no": "FL1305-271125\/12687",
    "tp_no": "12687",
    "tp_date": "2025-11-27",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "22960.00",
    "total_amt": "22960.00"
}
[2025-12-23 15:53:18] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-23 15:53:18] Purchase header inserted successfully: {
    "purchase_id": 9,
    "affected_rows": 1
}
[2025-12-23 15:53:18] Starting to process purchase items: {
    "item_count": 7
}
[2025-12-23 15:53:18] Processing item 0: {
    "item_code": "SCMBR0009735",
    "mrp": 170,
    "tot_bott": 24
}
[2025-12-23 15:53:18] cleanItemCode: 'SCMBR0009735' -> 'BR0009735'
[2025-12-23 15:53:18] Updating MRP for item: {
    "item_code": "BR0009735",
    "mrp": 170
}
[2025-12-23 15:53:18] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009735",
    "mrp": 170
}
[2025-12-23 15:53:18] Updating stock for item: {
    "item_code": "SCMBR0009735",
    "total_bottles": 24,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:53:18] Month is archived, updating archive table with cascading
[2025-12-23 15:53:18] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009735",
    "dayOfMonth": "28",
    "totalBottles": 24
}
[2025-12-23 15:53:18] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009735",
    "purchaseDay": "28"
}
[2025-12-23 15:53:18] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:53:18] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:53:18] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:53:18] Cascading updates completed for all days after purchase day
[2025-12-23 15:53:18] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0009735",
    "purchaseDate": "2025-11-28"
}
[2025-12-23 15:53:18] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:53:18] Cascading completed up to current date
[2025-12-23 15:53:18] Processing item 1: {
    "item_code": "SCMBR0018132",
    "mrp": 245,
    "tot_bott": 60
}
[2025-12-23 15:53:18] cleanItemCode: 'SCMBR0018132' -> 'BR0018132'
[2025-12-23 15:53:18] Updating MRP for item: {
    "item_code": "BR0018132",
    "mrp": 245
}
[2025-12-23 15:53:18] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018132",
    "mrp": 245
}
[2025-12-23 15:53:18] Updating stock for item: {
    "item_code": "SCMBR0018132",
    "total_bottles": 60,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:53:18] Month is archived, updating archive table with cascading
[2025-12-23 15:53:18] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018132",
    "dayOfMonth": "28",
    "totalBottles": 60
}
[2025-12-23 15:53:18] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018132",
    "purchaseDay": "28"
}
[2025-12-23 15:53:18] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:53:18] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:53:18] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:53:18] Cascading updates completed for all days after purchase day
[2025-12-23 15:53:18] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018132",
    "purchaseDate": "2025-11-28"
}
[2025-12-23 15:53:18] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:53:18] Cascading completed up to current date
[2025-12-23 15:53:18] Processing item 2: {
    "item_code": "SCMBR0027089",
    "mrp": 250,
    "tot_bott": 120
}
[2025-12-23 15:53:18] cleanItemCode: 'SCMBR0027089' -> 'BR0027089'
[2025-12-23 15:53:18] Updating MRP for item: {
    "item_code": "BR0027089",
    "mrp": 250
}
[2025-12-23 15:53:18] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0027089",
    "mrp": 250
}
[2025-12-23 15:53:18] Updating stock for item: {
    "item_code": "SCMBR0027089",
    "total_bottles": 120,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:53:18] Month is archived, updating archive table with cascading
[2025-12-23 15:53:18] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0027089",
    "dayOfMonth": "28",
    "totalBottles": 120
}
[2025-12-23 15:53:18] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0027089",
    "purchaseDay": "28"
}
[2025-12-23 15:53:18] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:53:18] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:53:18] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:53:18] Cascading updates completed for all days after purchase day
[2025-12-23 15:53:18] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0027089",
    "purchaseDate": "2025-11-28"
}
[2025-12-23 15:53:18] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:53:19] Cascading completed up to current date
[2025-12-23 15:53:19] Processing item 3: {
    "item_code": "SCMPL0036599",
    "mrp": 330,
    "tot_bott": 12
}
[2025-12-23 15:53:19] cleanItemCode: 'SCMPL0036599' -> 'PL0036599'
[2025-12-23 15:53:19] Updating MRP for item: {
    "item_code": "PL0036599",
    "mrp": 330
}
[2025-12-23 15:53:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036599",
    "mrp": 330
}
[2025-12-23 15:53:19] Updating stock for item: {
    "item_code": "SCMPL0036599",
    "total_bottles": 12,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:53:19] Month is archived, updating archive table with cascading
[2025-12-23 15:53:19] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036599",
    "dayOfMonth": "28",
    "totalBottles": 12
}
[2025-12-23 15:53:19] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036599",
    "purchaseDay": "28"
}
[2025-12-23 15:53:19] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:53:19] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:53:19] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:53:19] Cascading updates completed for all days after purchase day
[2025-12-23 15:53:19] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036599",
    "purchaseDate": "2025-11-28"
}
[2025-12-23 15:53:19] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:53:19] Cascading completed up to current date
[2025-12-23 15:53:19] Processing item 4: {
    "item_code": "SCMPL0036598",
    "mrp": 400,
    "tot_bott": 12
}
[2025-12-23 15:53:19] cleanItemCode: 'SCMPL0036598' -> 'PL0036598'
[2025-12-23 15:53:19] Updating MRP for item: {
    "item_code": "PL0036598",
    "mrp": 400
}
[2025-12-23 15:53:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036598",
    "mrp": 400
}
[2025-12-23 15:53:19] Updating stock for item: {
    "item_code": "SCMPL0036598",
    "total_bottles": 12,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:53:19] Month is archived, updating archive table with cascading
[2025-12-23 15:53:19] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036598",
    "dayOfMonth": "28",
    "totalBottles": 12
}
[2025-12-23 15:53:19] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036598",
    "purchaseDay": "28"
}
[2025-12-23 15:53:19] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:53:19] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:53:19] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:53:19] Cascading updates completed for all days after purchase day
[2025-12-23 15:53:19] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036598",
    "purchaseDate": "2025-11-28"
}
[2025-12-23 15:53:19] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:53:19] Cascading completed up to current date
[2025-12-23 15:53:19] Processing item 5: {
    "item_code": "SCMKB0031388",
    "mrp": 180,
    "tot_bott": 72
}
[2025-12-23 15:53:19] cleanItemCode: 'SCMKB0031388' -> 'KB0031388'
[2025-12-23 15:53:19] Updating MRP for item: {
    "item_code": "KB0031388",
    "mrp": 180
}
[2025-12-23 15:53:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "KB0031388",
    "mrp": 180
}
[2025-12-23 15:53:19] Updating stock for item: {
    "item_code": "SCMKB0031388",
    "total_bottles": 72,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:53:19] Month is archived, updating archive table with cascading
[2025-12-23 15:53:19] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKB0031388",
    "dayOfMonth": "28",
    "totalBottles": 72
}
[2025-12-23 15:53:19] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKB0031388",
    "purchaseDay": "28"
}
[2025-12-23 15:53:19] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:53:20] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:53:20] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:53:20] Cascading updates completed for all days after purchase day
[2025-12-23 15:53:20] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMKB0031388",
    "purchaseDate": "2025-11-28"
}
[2025-12-23 15:53:20] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:53:20] Cascading completed up to current date
[2025-12-23 15:53:20] Processing item 6: {
    "item_code": "SCMPL0031817",
    "mrp": 150,
    "tot_bott": 24
}
[2025-12-23 15:53:20] cleanItemCode: 'SCMPL0031817' -> 'PL0031817'
[2025-12-23 15:53:20] Updating MRP for item: {
    "item_code": "PL0031817",
    "mrp": 150
}
[2025-12-23 15:53:20] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0031817",
    "mrp": 150
}
[2025-12-23 15:53:20] Updating stock for item: {
    "item_code": "SCMPL0031817",
    "total_bottles": 24,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-23 15:53:20] Month is archived, updating archive table with cascading
[2025-12-23 15:53:20] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0031817",
    "dayOfMonth": "28",
    "totalBottles": 24
}
[2025-12-23 15:53:20] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0031817",
    "purchaseDay": "28"
}
[2025-12-23 15:53:20] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-23 15:53:20] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-23 15:53:20] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-23 15:53:20] Cascading updates completed for all days after purchase day
[2025-12-23 15:53:20] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0031817",
    "purchaseDate": "2025-11-28"
}
[2025-12-23 15:53:20] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-23 15:53:20] Cascading completed up to current date
[2025-12-23 15:53:20] Purchase items processing completed: {
    "successful_items": 7
}
[2025-12-23 15:53:20] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 07:01:45] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:01:45] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:01:45] POST data: []
[2025-12-24 07:01:45] GET data: []
[2025-12-24 07:01:45] Company ID from session: 1
[2025-12-24 07:01:45] Database connection included
[2025-12-24 07:01:45] License functions included
[2025-12-24 07:01:45] License type: FL-II
[2025-12-24 07:01:45] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:01:45] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:01:45] Purchase mode: F
[2025-12-24 07:01:45] Next voucher number: 1
[2025-12-24 07:01:45] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:01:45] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:01:45] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:01:45] Suppliers fetched: {
    "count": 36
}
[2025-12-24 07:01:45] Database connection closed
[2025-12-24 07:01:45] === PURCHASE SESSION ENDED ===
[2025-12-24 07:03:11] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:03:11] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:03:11] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-24 07:03:11] GET data: []
[2025-12-24 07:03:11] Company ID from session: 1
[2025-12-24 07:03:11] Database connection included
[2025-12-24 07:03:11] License functions included
[2025-12-24 07:03:11] License type: FL-II
[2025-12-24 07:03:11] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:03:11] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:03:11] Purchase mode: F
[2025-12-24 07:03:11] Next voucher number: 1
[2025-12-24 07:03:11] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:03:11] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:03:11] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:03:11] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:03:11] Suppliers fetched: {
    "count": 36
}
[2025-12-24 07:03:11] === FORM SUBMISSION STARTED ===
[2025-12-24 07:03:11] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-24 07:03:11] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 07:03:11] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-24 07:03:11] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-24 07:03:11] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-24 07:03:11] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-24 07:03:11] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 07:03:11] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 07:03:11] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-24 07:03:11] Month is archived, updating archive table with cascading
[2025-12-24 07:03:11] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-24 07:03:11] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "purchaseDay": "14"
}
[2025-12-24 07:03:11] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-24 07:03:11] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-24 07:03:12] Cascading updates completed for all days after purchase day
[2025-12-24 07:03:12] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010087",
    "purchaseDate": "2025-11-14"
}
[2025-12-24 07:03:12] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 07:03:12] Cascading completed up to current date
[2025-12-24 07:03:12] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-24 07:03:12] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 07:03:12] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:03:12] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-24 07:03:12] GET data: []
[2025-12-24 07:03:12] Company ID from session: 1
[2025-12-24 07:03:12] Database connection included
[2025-12-24 07:03:12] License functions included
[2025-12-24 07:03:12] License type: FL-II
[2025-12-24 07:03:12] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:03:12] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:03:12] Purchase mode: F
[2025-12-24 07:03:12] Next voucher number: 2
[2025-12-24 07:03:12] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:03:12] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:03:12] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:03:12] Suppliers fetched: {
    "count": 36
}
[2025-12-24 07:03:12] === FORM SUBMISSION STARTED ===
[2025-12-24 07:03:12] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-24 07:03:12] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 07:03:12] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-24 07:03:12] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-24 07:03:12] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-24 07:03:12] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-24 07:03:12] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 07:03:12] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 07:03:12] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-24 07:03:12] Month is archived, updating archive table with cascading
[2025-12-24 07:03:12] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-24 07:03:12] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "purchaseDay": "14"
}
[2025-12-24 07:03:12] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-24 07:03:12] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-24 07:03:12] Cascading updates completed for all days after purchase day
[2025-12-24 07:03:12] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010087",
    "purchaseDate": "2025-11-14"
}
[2025-12-24 07:03:12] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 07:03:12] Cascading completed up to current date
[2025-12-24 07:03:12] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-24 07:03:12] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 07:24:59] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:24:59] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:24:59] POST data: []
[2025-12-24 07:24:59] GET data: {
    "mode": "F"
}
[2025-12-24 07:24:59] Company ID from session: 1
[2025-12-24 07:24:59] Database connection included
[2025-12-24 07:24:59] License functions included
[2025-12-24 07:24:59] License type: FL-II
[2025-12-24 07:24:59] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:24:59] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:24:59] Purchase mode: F
[2025-12-24 07:24:59] Next voucher number: 1
[2025-12-24 07:24:59] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:24:59] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:24:59] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:24:59] Suppliers fetched: {
    "count": 36
}
[2025-12-24 07:24:59] Database connection closed
[2025-12-24 07:24:59] === PURCHASE SESSION ENDED ===
[2025-12-24 07:25:14] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:25:14] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:25:14] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-24 07:25:14] GET data: {
    "mode": "F"
}
[2025-12-24 07:25:14] Company ID from session: 1
[2025-12-24 07:25:14] Database connection included
[2025-12-24 07:25:14] License functions included
[2025-12-24 07:25:14] License type: FL-II
[2025-12-24 07:25:14] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:25:14] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:25:14] Purchase mode: F
[2025-12-24 07:25:14] Next voucher number: 1
[2025-12-24 07:25:14] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:25:14] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:25:14] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:25:14] Suppliers fetched: {
    "count": 36
}
[2025-12-24 07:25:14] === FORM SUBMISSION STARTED ===
[2025-12-24 07:25:14] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "1",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-24 07:25:14] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 07:25:14] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-24 07:25:14] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-24 07:25:14] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-24 07:25:14] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-24 07:25:14] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 07:25:14] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 07:25:14] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-24 07:25:14] Month is archived, updating archive table with cascading
[2025-12-24 07:25:14] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-24 07:25:14] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "purchaseDay": "14"
}
[2025-12-24 07:25:14] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-24 07:25:14] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-24 07:25:14] Cascading updates completed for all days after purchase day
[2025-12-24 07:25:14] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010087",
    "purchaseDate": "2025-11-14"
}
[2025-12-24 07:25:14] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 07:25:14] Cascading completed up to current date
[2025-12-24 07:25:14] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-24 07:25:14] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 07:47:47] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:47:47] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:47:47] POST data: []
[2025-12-24 07:47:47] GET data: {
    "mode": "F"
}
[2025-12-24 07:47:47] Company ID from session: 1
[2025-12-24 07:47:47] Database connection included
[2025-12-24 07:47:47] License functions included
[2025-12-24 07:47:47] License type: FL-II
[2025-12-24 07:47:47] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:47:47] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:47:47] Purchase mode: F
[2025-12-24 07:47:47] Next voucher number: 1
[2025-12-24 07:47:47] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:47:47] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:47:47] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:47:47] Suppliers fetched: {
    "count": 36
}
[2025-12-24 07:47:47] Database connection closed
[2025-12-24 07:47:47] === PURCHASE SESSION ENDED ===
[2025-12-24 07:48:07] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:48:07] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:48:07] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-08",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "229",
            "auto_batch": "BTBL2-291025\/620",
            "mfg_month": "Oct-2025",
            "bl": "23.4",
            "vv": "8",
            "tot_bott": "36",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0009847",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "213",
            "auto_batch": "BTBL2-161025\/580",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018145",
            "name": "London Pilsner Premium Strong Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "109",
            "auto_batch": "BTBL2-280925\/511",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "165"
        },
        {
            "code": "SCMBR0018149",
            "name": "Kingfisher Premium Lager Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "33",
            "auto_batch": "BTBL2-101025\/555",
            "mfg_month": "Oct-2025",
            "bl": "7.8",
            "vv": "5",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "200"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "2060.00",
    "tamt": "2060.00"
}
[2025-12-24 07:48:07] GET data: {
    "mode": "F"
}
[2025-12-24 07:48:07] Company ID from session: 1
[2025-12-24 07:48:07] Database connection included
[2025-12-24 07:48:07] License functions included
[2025-12-24 07:48:07] License type: FL-II
[2025-12-24 07:48:07] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:48:07] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:48:07] Purchase mode: F
[2025-12-24 07:48:07] Next voucher number: 1
[2025-12-24 07:48:07] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:48:07] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:48:07] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:48:07] Suppliers fetched: {
    "count": 36
}
[2025-12-24 07:48:07] === FORM SUBMISSION STARTED ===
[2025-12-24 07:48:07] Form data extracted: {
    "date": "2025-11-08",
    "voc_no": "1",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "2060.00",
    "total_amt": "2060.00"
}
[2025-12-24 07:48:07] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 07:48:07] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-24 07:48:07] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-24 07:48:07] Processing item 0: {
    "item_code": "SCMBR0009846",
    "mrp": 195,
    "tot_bott": 36
}
[2025-12-24 07:48:07] cleanItemCode: 'SCMBR0009846' -> 'BR0009846'
[2025-12-24 07:48:07] Updating MRP for item: {
    "item_code": "BR0009846",
    "mrp": 195
}
[2025-12-24 07:48:07] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009846",
    "mrp": 195
}
[2025-12-24 07:48:07] Updating stock for item: {
    "item_code": "SCMBR0009846",
    "total_bottles": 36,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-24 07:48:07] Month is archived, updating archive table with cascading
[2025-12-24 07:48:07] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009846",
    "dayOfMonth": "8",
    "totalBottles": 36
}
[2025-12-24 07:48:07] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009846",
    "purchaseDay": "8"
}
[2025-12-24 07:48:07] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_09_OPEN = DAY_08_CLOSING,\n                           DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_10_OPEN = DAY_09_CLOSING,\n                           DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_11_OPEN = DAY_10_CLOSING,\n                           DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_12_OPEN = DAY_11_CLOSING,\n                           DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_13_OPEN = DAY_12_CLOSING,\n                           DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_14_OPEN = DAY_13_CLOSING,\n                           DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_15_OPEN = DAY_14_CLOSING,\n                           DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_16_OPEN = DAY_15_CLOSING,\n                           DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_17_OPEN = DAY_16_CLOSING,\n                           DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_18_OPEN = DAY_17_CLOSING,\n                           DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_19_OPEN = DAY_18_CLOSING,\n                           DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_20_OPEN = DAY_19_CLOSING,\n                           DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_21_OPEN = DAY_20_CLOSING,\n                           DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_22_OPEN = DAY_21_CLOSING,\n                           DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_23_OPEN = DAY_22_CLOSING,\n                           DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_24_OPEN = DAY_23_CLOSING,\n                           DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_25_OPEN = DAY_24_CLOSING,\n                           DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_26_OPEN = DAY_25_CLOSING,\n                           DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_27_OPEN = DAY_26_CLOSING,\n                           DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_28_OPEN = DAY_27_CLOSING,\n                           DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_29_OPEN = DAY_28_CLOSING,\n                           DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_30_OPEN = DAY_29_CLOSING,\n                           DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING"
}
[2025-12-24 07:48:07] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1_11_25 \n                       SET DAY_31_OPEN = DAY_30_CLOSING,\n                           DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                       WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING"
}
[2025-12-24 07:51:12] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 07:51:12] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 07:51:12] POST data: []
[2025-12-24 07:51:12] GET data: {
    "mode": "F"
}
[2025-12-24 07:51:12] Company ID from session: 1
[2025-12-24 07:51:12] Database connection included
[2025-12-24 07:51:12] License functions included
[2025-12-24 07:51:12] License type: FL-II
[2025-12-24 07:51:12] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 07:51:12] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 07:51:12] Purchase mode: F
[2025-12-24 07:51:12] Next voucher number: 2
[2025-12-24 07:51:12] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 07:51:12] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 07:51:12] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 07:51:12] Suppliers fetched: {
    "count": 36
}
[2025-12-24 13:18:55] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 13:18:55] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 13:18:55] POST data: []
[2025-12-24 13:18:55] GET data: []
[2025-12-24 13:18:55] Company ID from session: 1
[2025-12-24 13:18:55] Database connection included
[2025-12-24 13:18:55] License functions included
[2025-12-24 13:18:55] License type: FL-II
[2025-12-24 13:18:55] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 13:18:55] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 13:18:55] Purchase mode: F
[2025-12-24 13:18:55] Next voucher number: 1
[2025-12-24 13:18:55] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 13:18:55] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 13:18:55] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 13:18:55] Suppliers fetched: {
    "count": 36
}
[2025-12-24 13:18:55] Database connection closed
[2025-12-24 13:18:55] === PURCHASE SESSION ENDED ===
[2025-12-24 13:19:06] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 13:19:06] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 13:19:06] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-11-08",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "RAJ MARKETING & CO.",
    "supplier_code": "RAJ",
    "items": [
        {
            "code": "SCMBR0009846",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "229",
            "auto_batch": "BTBL2-291025\/620",
            "mfg_month": "Oct-2025",
            "bl": "23.4",
            "vv": "8",
            "tot_bott": "36",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "195"
        },
        {
            "code": "SCMBR0009847",
            "name": "Kingfisher Strong Premium Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "213",
            "auto_batch": "BTBL2-161025\/580",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018145",
            "name": "London Pilsner Premium Strong Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "109",
            "auto_batch": "BTBL2-280925\/511",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "165"
        },
        {
            "code": "SCMBR0018149",
            "name": "Kingfisher Premium Lager Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "33",
            "auto_batch": "BTBL2-101025\/555",
            "mfg_month": "Oct-2025",
            "bl": "7.8",
            "vv": "5",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "200"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "2060.00",
    "tamt": "2060.00"
}
[2025-12-24 13:19:06] GET data: []
[2025-12-24 13:19:06] Company ID from session: 1
[2025-12-24 13:19:06] Database connection included
[2025-12-24 13:19:06] License functions included
[2025-12-24 13:19:06] License type: FL-II
[2025-12-24 13:19:06] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 13:19:06] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 13:19:06] Purchase mode: F
[2025-12-24 13:19:06] Next voucher number: 1
[2025-12-24 13:19:06] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 13:19:06] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 13:19:06] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 13:19:06] Suppliers fetched: {
    "count": 36
}
[2025-12-24 13:19:06] === FORM SUBMISSION STARTED ===
[2025-12-24 13:19:06] Form data extracted: {
    "date": "2025-11-08",
    "voc_no": "1",
    "auto_tp_no": "FL119851-081125\/4797",
    "tp_no": "4797",
    "tp_date": "2025-11-08",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "RAJ",
    "supplier_name": "RAJ MARKETING & CO.",
    "basic_amt": "2060.00",
    "total_amt": "2060.00"
}
[2025-12-24 13:19:06] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 13:19:06] Purchase header inserted successfully: {
    "purchase_id": 1,
    "affected_rows": 1
}
[2025-12-24 13:19:06] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-24 13:19:06] Processing item 0: {
    "item_code": "SCMBR0009846",
    "mrp": 195,
    "tot_bott": 36
}
[2025-12-24 13:19:06] cleanItemCode: 'SCMBR0009846' -> 'BR0009846'
[2025-12-24 13:19:06] Updating MRP for item: {
    "item_code": "BR0009846",
    "mrp": 195
}
[2025-12-24 13:19:06] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009846",
    "mrp": 195
}
[2025-12-24 13:19:06] Updating stock for item: {
    "item_code": "SCMBR0009846",
    "total_bottles": 36,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-24 13:19:06] Month is archived, updating archive table with cascading
[2025-12-24 13:19:06] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009846",
    "dayOfMonth": "8",
    "totalBottles": 36
}
[2025-12-24 13:19:06] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009846",
    "purchaseDay": "8"
}
[2025-12-24 13:19:06] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 13:19:06] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_09_OPEN = DAY_08_CLOSING,\n                               DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_10_OPEN = DAY_09_CLOSING,\n                               DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_11_OPEN = DAY_10_CLOSING,\n                               DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_12_OPEN = DAY_11_CLOSING,\n                               DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_13_OPEN = DAY_12_CLOSING,\n                               DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_14_OPEN = DAY_13_CLOSING,\n                               DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_15_OPEN = DAY_14_CLOSING,\n                               DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:06] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading updates completed for all days after purchase day
[2025-12-24 13:19:07] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0009846",
    "purchaseDate": "2025-11-08"
}
[2025-12-24 13:19:07] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 13:19:07] Cascading completed up to current date
[2025-12-24 13:19:07] Processing item 1: {
    "item_code": "SCMBR0009847",
    "mrp": 130,
    "tot_bott": 24
}
[2025-12-24 13:19:07] cleanItemCode: 'SCMBR0009847' -> 'BR0009847'
[2025-12-24 13:19:07] Updating MRP for item: {
    "item_code": "BR0009847",
    "mrp": 130
}
[2025-12-24 13:19:07] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009847",
    "mrp": 130
}
[2025-12-24 13:19:07] Updating stock for item: {
    "item_code": "SCMBR0009847",
    "total_bottles": 24,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-24 13:19:07] Month is archived, updating archive table with cascading
[2025-12-24 13:19:07] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009847",
    "dayOfMonth": "8",
    "totalBottles": 24
}
[2025-12-24 13:19:07] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009847",
    "purchaseDay": "8"
}
[2025-12-24 13:19:07] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 13:19:07] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_09_OPEN = DAY_08_CLOSING,\n                               DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_10_OPEN = DAY_09_CLOSING,\n                               DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_11_OPEN = DAY_10_CLOSING,\n                               DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_12_OPEN = DAY_11_CLOSING,\n                               DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:07] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_13_OPEN = DAY_12_CLOSING,\n                               DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_14_OPEN = DAY_13_CLOSING,\n                               DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_15_OPEN = DAY_14_CLOSING,\n                               DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading updates completed for all days after purchase day
[2025-12-24 13:19:08] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0009847",
    "purchaseDate": "2025-11-08"
}
[2025-12-24 13:19:08] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 13:19:08] Cascading completed up to current date
[2025-12-24 13:19:08] Processing item 2: {
    "item_code": "SCMBR0018145",
    "mrp": 165,
    "tot_bott": 12
}
[2025-12-24 13:19:08] cleanItemCode: 'SCMBR0018145' -> 'BR0018145'
[2025-12-24 13:19:08] Updating MRP for item: {
    "item_code": "BR0018145",
    "mrp": 165
}
[2025-12-24 13:19:08] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018145",
    "mrp": 165
}
[2025-12-24 13:19:08] Updating stock for item: {
    "item_code": "SCMBR0018145",
    "total_bottles": 12,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-24 13:19:08] Month is archived, updating archive table with cascading
[2025-12-24 13:19:08] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018145",
    "dayOfMonth": "8",
    "totalBottles": 12
}
[2025-12-24 13:19:08] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018145",
    "purchaseDay": "8"
}
[2025-12-24 13:19:08] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 13:19:08] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_09_OPEN = DAY_08_CLOSING,\n                               DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:08] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_10_OPEN = DAY_09_CLOSING,\n                               DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_11_OPEN = DAY_10_CLOSING,\n                               DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_12_OPEN = DAY_11_CLOSING,\n                               DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_13_OPEN = DAY_12_CLOSING,\n                               DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_14_OPEN = DAY_13_CLOSING,\n                               DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_15_OPEN = DAY_14_CLOSING,\n                               DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:09] Cascading updates completed for all days after purchase day
[2025-12-24 13:19:09] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018145",
    "purchaseDate": "2025-11-08"
}
[2025-12-24 13:19:09] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 13:19:09] Cascading completed up to current date
[2025-12-24 13:19:09] Processing item 3: {
    "item_code": "SCMBR0018149",
    "mrp": 200,
    "tot_bott": 12
}
[2025-12-24 13:19:09] cleanItemCode: 'SCMBR0018149' -> 'BR0018149'
[2025-12-24 13:19:09] Updating MRP for item: {
    "item_code": "BR0018149",
    "mrp": 200
}
[2025-12-24 13:19:09] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018149",
    "mrp": 200
}
[2025-12-24 13:19:09] Updating stock for item: {
    "item_code": "SCMBR0018149",
    "total_bottles": 12,
    "purchase_date": "2025-11-08",
    "day_of_month": "8",
    "month": "11",
    "year": "2025"
}
[2025-12-24 13:19:09] Month is archived, updating archive table with cascading
[2025-12-24 13:19:09] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018149",
    "dayOfMonth": "8",
    "totalBottles": 12
}
[2025-12-24 13:19:10] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018149",
    "purchaseDay": "8"
}
[2025-12-24 13:19:10] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 13:19:10] Cascading update for day 9: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_09_OPEN = DAY_08_CLOSING,\n                               DAY_09_CLOSING = DAY_08_CLOSING + DAY_09_PURCHASE - DAY_09_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_08_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 10: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_10_OPEN = DAY_09_CLOSING,\n                               DAY_10_CLOSING = DAY_09_CLOSING + DAY_10_PURCHASE - DAY_10_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_09_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 11: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_11_OPEN = DAY_10_CLOSING,\n                               DAY_11_CLOSING = DAY_10_CLOSING + DAY_11_PURCHASE - DAY_11_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_10_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 12: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_12_OPEN = DAY_11_CLOSING,\n                               DAY_12_CLOSING = DAY_11_CLOSING + DAY_12_PURCHASE - DAY_12_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_11_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_13_OPEN = DAY_12_CLOSING,\n                               DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_14_OPEN = DAY_13_CLOSING,\n                               DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_15_OPEN = DAY_14_CLOSING,\n                               DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 13:19:10] Cascading updates completed for all days after purchase day
[2025-12-24 13:19:10] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018149",
    "purchaseDate": "2025-11-08"
}
[2025-12-24 13:19:10] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 13:19:11] Cascading completed up to current date
[2025-12-24 13:19:11] Purchase items processing completed: {
    "successful_items": 4
}
[2025-12-24 13:19:11] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 14:54:36] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:54:36] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:54:36] POST data: []
[2025-12-24 14:54:36] GET data: {
    "mode": "F"
}
[2025-12-24 14:54:36] Company ID from session: 1
[2025-12-24 14:54:36] Database connection included
[2025-12-24 14:54:36] License functions included
[2025-12-24 14:54:36] License type: FL-II
[2025-12-24 14:54:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:54:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:54:36] Purchase mode: F
[2025-12-24 14:54:36] Next voucher number: 2
[2025-12-24 14:54:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:54:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:54:36] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:54:36] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:54:36] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:54:36] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:54:36] POST data: []
[2025-12-24 14:54:36] GET data: {
    "mode": "F"
}
[2025-12-24 14:54:36] Company ID from session: 1
[2025-12-24 14:54:36] Database connection included
[2025-12-24 14:54:36] License functions included
[2025-12-24 14:54:36] License type: FL-II
[2025-12-24 14:54:36] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:54:36] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:54:36] Purchase mode: F
[2025-12-24 14:54:36] Next voucher number: 2
[2025-12-24 14:54:36] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:54:36] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:54:36] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:54:36] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:54:36] Database connection closed
[2025-12-24 14:54:36] === PURCHASE SESSION ENDED ===
[2025-12-24 14:54:47] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:54:47] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:54:47] POST data: {
    "mode": "F",
    "voc_no": "2",
    "date": "2025-11-12",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ASIAN TRADERS",
    "supplier_code": "ASIA",
    "items": [
        {
            "code": "SCMPL0033617",
            "name": "Grand Master\\'s Cranberry Platinum Vodka .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "668",
            "auto_batch": "BTP44-181025\/668",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "42.8",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "300"
        },
        {
            "code": "SCMPL0033620",
            "name": "Grand Master\\'s Mango Platinum Vodka .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "640",
            "auto_batch": "BTP44-111025\/640",
            "mfg_month": "Oct-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "300"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "180.00",
    "tamt": "180.00"
}
[2025-12-24 14:54:47] GET data: {
    "mode": "F"
}
[2025-12-24 14:54:47] Company ID from session: 1
[2025-12-24 14:54:47] Database connection included
[2025-12-24 14:54:47] License functions included
[2025-12-24 14:54:47] License type: FL-II
[2025-12-24 14:54:47] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:54:47] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:54:47] Purchase mode: F
[2025-12-24 14:54:47] Next voucher number: 2
[2025-12-24 14:54:47] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:54:47] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:54:47] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:54:47] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:54:47] === FORM SUBMISSION STARTED ===
[2025-12-24 14:54:47] Form data extracted: {
    "date": "2025-11-12",
    "voc_no": "2",
    "auto_tp_no": "FL175-111125\/4046",
    "tp_no": "3935",
    "tp_date": "2025-11-11",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ASIA",
    "supplier_name": "ASIAN TRADERS",
    "basic_amt": "180.00",
    "total_amt": "180.00"
}
[2025-12-24 14:54:47] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 14:54:47] Purchase header inserted successfully: {
    "purchase_id": 2,
    "affected_rows": 1
}
[2025-12-24 14:54:47] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-24 14:54:47] Processing item 0: {
    "item_code": "SCMPL0033617",
    "mrp": 300,
    "tot_bott": 48
}
[2025-12-24 14:54:47] cleanItemCode: 'SCMPL0033617' -> 'PL0033617'
[2025-12-24 14:54:47] Updating MRP for item: {
    "item_code": "PL0033617",
    "mrp": 300
}
[2025-12-24 14:54:47] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0033617",
    "mrp": 300
}
[2025-12-24 14:54:47] Updating stock for item: {
    "item_code": "SCMPL0033617",
    "total_bottles": 48,
    "purchase_date": "2025-11-12",
    "day_of_month": "12",
    "month": "11",
    "year": "2025"
}
[2025-12-24 14:54:47] Month is archived, updating archive table with cascading
[2025-12-24 14:54:47] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033617",
    "dayOfMonth": "12",
    "totalBottles": 48
}
[2025-12-24 14:54:47] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033617",
    "purchaseDay": "12"
}
[2025-12-24 14:54:47] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 14:54:47] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_13_OPEN = DAY_12_CLOSING,\n                               DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_14_OPEN = DAY_13_CLOSING,\n                               DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_15_OPEN = DAY_14_CLOSING,\n                               DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:47] Cascading updates completed for all days after purchase day
[2025-12-24 14:54:47] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0033617",
    "purchaseDate": "2025-11-12"
}
[2025-12-24 14:54:47] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 14:54:48] Cascading completed up to current date
[2025-12-24 14:54:48] Processing item 1: {
    "item_code": "SCMPL0033620",
    "mrp": 300,
    "tot_bott": 48
}
[2025-12-24 14:54:48] cleanItemCode: 'SCMPL0033620' -> 'PL0033620'
[2025-12-24 14:54:48] Updating MRP for item: {
    "item_code": "PL0033620",
    "mrp": 300
}
[2025-12-24 14:54:48] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0033620",
    "mrp": 300
}
[2025-12-24 14:54:48] Updating stock for item: {
    "item_code": "SCMPL0033620",
    "total_bottles": 48,
    "purchase_date": "2025-11-12",
    "day_of_month": "12",
    "month": "11",
    "year": "2025"
}
[2025-12-24 14:54:48] Month is archived, updating archive table with cascading
[2025-12-24 14:54:48] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033620",
    "dayOfMonth": "12",
    "totalBottles": 48
}
[2025-12-24 14:54:48] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0033620",
    "purchaseDay": "12"
}
[2025-12-24 14:54:48] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 14:54:48] Cascading update for day 13: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_13_OPEN = DAY_12_CLOSING,\n                               DAY_13_CLOSING = DAY_12_CLOSING + DAY_13_PURCHASE - DAY_13_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_12_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 14: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_14_OPEN = DAY_13_CLOSING,\n                               DAY_14_CLOSING = DAY_13_CLOSING + DAY_14_PURCHASE - DAY_14_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_13_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_15_OPEN = DAY_14_CLOSING,\n                               DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:54:48] Cascading updates completed for all days after purchase day
[2025-12-24 14:54:48] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0033620",
    "purchaseDate": "2025-11-12"
}
[2025-12-24 14:54:48] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 14:54:49] Cascading completed up to current date
[2025-12-24 14:54:49] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-24 14:54:49] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 14:56:15] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:56:15] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:56:15] POST data: []
[2025-12-24 14:56:15] GET data: {
    "mode": "F"
}
[2025-12-24 14:56:15] Company ID from session: 1
[2025-12-24 14:56:15] Database connection included
[2025-12-24 14:56:15] License functions included
[2025-12-24 14:56:15] License type: FL-II
[2025-12-24 14:56:15] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:56:15] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:56:15] Purchase mode: F
[2025-12-24 14:56:15] Next voucher number: 3
[2025-12-24 14:56:15] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:56:15] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:56:15] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:56:15] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:56:15] Database connection closed
[2025-12-24 14:56:15] === PURCHASE SESSION ENDED ===
[2025-12-24 14:56:22] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:56:22] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:56:22] POST data: {
    "mode": "F",
    "voc_no": "3",
    "date": "2025-11-14",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010087",
            "name": "Seagram\\'s Royal Stag Deluxe Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2112",
            "auto_batch": "BTP28-051125\/2112",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "800.00",
    "tamt": "800.00"
}
[2025-12-24 14:56:22] GET data: {
    "mode": "F"
}
[2025-12-24 14:56:22] Company ID from session: 1
[2025-12-24 14:56:22] Database connection included
[2025-12-24 14:56:22] License functions included
[2025-12-24 14:56:22] License type: FL-II
[2025-12-24 14:56:22] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:56:22] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:56:22] Purchase mode: F
[2025-12-24 14:56:22] Next voucher number: 3
[2025-12-24 14:56:22] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:56:22] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:56:22] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:56:22] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:56:22] === FORM SUBMISSION STARTED ===
[2025-12-24 14:56:22] Form data extracted: {
    "date": "2025-11-14",
    "voc_no": "3",
    "auto_tp_no": "FL1249-131125\/4370",
    "tp_no": "4395",
    "tp_date": "2025-11-13",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "800.00",
    "total_amt": "800.00"
}
[2025-12-24 14:56:22] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 14:56:22] Purchase header inserted successfully: {
    "purchase_id": 3,
    "affected_rows": 1
}
[2025-12-24 14:56:22] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-24 14:56:22] Processing item 0: {
    "item_code": "SCMPL0010087",
    "mrp": 250,
    "tot_bott": 48
}
[2025-12-24 14:56:22] cleanItemCode: 'SCMPL0010087' -> 'PL0010087'
[2025-12-24 14:56:22] Updating MRP for item: {
    "item_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 14:56:22] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010087",
    "mrp": 250
}
[2025-12-24 14:56:22] Updating stock for item: {
    "item_code": "SCMPL0010087",
    "total_bottles": 48,
    "purchase_date": "2025-11-14",
    "day_of_month": "14",
    "month": "11",
    "year": "2025"
}
[2025-12-24 14:56:22] Month is archived, updating archive table with cascading
[2025-12-24 14:56:22] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "dayOfMonth": "14",
    "totalBottles": 48
}
[2025-12-24 14:56:22] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010087",
    "purchaseDay": "14"
}
[2025-12-24 14:56:22] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 14:56:23] Cascading update for day 15: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_15_OPEN = DAY_14_CLOSING,\n                               DAY_15_CLOSING = DAY_14_CLOSING + DAY_15_PURCHASE - DAY_15_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_14_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:56:23] Cascading updates completed for all days after purchase day
[2025-12-24 14:56:23] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010087",
    "purchaseDate": "2025-11-14"
}
[2025-12-24 14:56:23] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 14:56:23] Cascading completed up to current date
[2025-12-24 14:56:23] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-24 14:56:24] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 14:59:06] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:59:06] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:59:06] POST data: []
[2025-12-24 14:59:06] GET data: {
    "mode": "F"
}
[2025-12-24 14:59:06] Company ID from session: 1
[2025-12-24 14:59:06] Database connection included
[2025-12-24 14:59:06] License functions included
[2025-12-24 14:59:06] License type: FL-II
[2025-12-24 14:59:06] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:59:06] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:59:06] Purchase mode: F
[2025-12-24 14:59:06] Next voucher number: 4
[2025-12-24 14:59:06] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:59:06] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:59:07] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:59:07] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:59:07] Database connection closed
[2025-12-24 14:59:07] === PURCHASE SESSION ENDED ===
[2025-12-24 14:59:14] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:59:14] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:59:14] POST data: {
    "mode": "F",
    "voc_no": "4",
    "date": "2025-11-18",
    "auto_tp_no": "FL170-171125\/24022",
    "tp_no": "24022",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMBR0018160",
            "name": "Carlsberg Elephant Strong Super Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "762",
            "auto_batch": "BTBL4-160925\/762",
            "mfg_month": "Sep-2025",
            "bl": "7.8",
            "vv": "8",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "250"
        },
        {
            "code": "SCMBR0018161",
            "name": "Tuborg Strong Premium Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "814",
            "auto_batch": "BTBL5-131025\/970",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "8",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018164",
            "name": "Tuborg Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "925",
            "auto_batch": "BTBL5-131125\/1120",
            "mfg_month": "Nov-2025",
            "bl": "31.2",
            "vv": "8",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "4",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "195"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "3400.00",
    "tamt": "3400.00"
}
[2025-12-24 14:59:14] GET data: {
    "mode": "F"
}
[2025-12-24 14:59:14] Company ID from session: 1
[2025-12-24 14:59:14] Database connection included
[2025-12-24 14:59:14] License functions included
[2025-12-24 14:59:14] License type: FL-II
[2025-12-24 14:59:14] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:59:14] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:59:14] Purchase mode: F
[2025-12-24 14:59:14] Next voucher number: 4
[2025-12-24 14:59:14] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:59:14] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:59:14] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:59:14] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:59:14] === FORM SUBMISSION STARTED ===
[2025-12-24 14:59:14] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "4",
    "auto_tp_no": "FL170-171125\/24022",
    "tp_no": "24022",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "3400.00",
    "total_amt": "3400.00"
}
[2025-12-24 14:59:14] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 14:59:14] Purchase header inserted successfully: {
    "purchase_id": 4,
    "affected_rows": 1
}
[2025-12-24 14:59:14] Starting to process purchase items: {
    "item_count": 3
}
[2025-12-24 14:59:14] Processing item 0: {
    "item_code": "SCMBR0018160",
    "mrp": 250,
    "tot_bott": 12
}
[2025-12-24 14:59:14] cleanItemCode: 'SCMBR0018160' -> 'BR0018160'
[2025-12-24 14:59:14] Updating MRP for item: {
    "item_code": "BR0018160",
    "mrp": 250
}
[2025-12-24 14:59:14] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018160",
    "mrp": 250
}
[2025-12-24 14:59:14] Updating stock for item: {
    "item_code": "SCMBR0018160",
    "total_bottles": 12,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-24 14:59:14] Month is archived, updating archive table with cascading
[2025-12-24 14:59:14] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018160",
    "dayOfMonth": "18",
    "totalBottles": 12
}
[2025-12-24 14:59:14] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018160",
    "purchaseDay": "18"
}
[2025-12-24 14:59:14] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 14:59:14] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:14] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:14] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:14] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:14] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:14] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:14] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading updates completed for all days after purchase day
[2025-12-24 14:59:15] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018160",
    "purchaseDate": "2025-11-18"
}
[2025-12-24 14:59:15] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 14:59:15] Cascading completed up to current date
[2025-12-24 14:59:15] Processing item 1: {
    "item_code": "SCMBR0018161",
    "mrp": 130,
    "tot_bott": 24
}
[2025-12-24 14:59:15] cleanItemCode: 'SCMBR0018161' -> 'BR0018161'
[2025-12-24 14:59:15] Updating MRP for item: {
    "item_code": "BR0018161",
    "mrp": 130
}
[2025-12-24 14:59:15] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018161",
    "mrp": 130
}
[2025-12-24 14:59:15] Updating stock for item: {
    "item_code": "SCMBR0018161",
    "total_bottles": 24,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-24 14:59:15] Month is archived, updating archive table with cascading
[2025-12-24 14:59:15] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "dayOfMonth": "18",
    "totalBottles": 24
}
[2025-12-24 14:59:15] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "purchaseDay": "18"
}
[2025-12-24 14:59:15] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 14:59:15] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:15] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading updates completed for all days after purchase day
[2025-12-24 14:59:16] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018161",
    "purchaseDate": "2025-11-18"
}
[2025-12-24 14:59:16] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 14:59:16] Cascading completed up to current date
[2025-12-24 14:59:16] Processing item 2: {
    "item_code": "SCMBR0018164",
    "mrp": 195,
    "tot_bott": 48
}
[2025-12-24 14:59:16] cleanItemCode: 'SCMBR0018164' -> 'BR0018164'
[2025-12-24 14:59:16] Updating MRP for item: {
    "item_code": "BR0018164",
    "mrp": 195
}
[2025-12-24 14:59:16] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018164",
    "mrp": 195
}
[2025-12-24 14:59:16] Updating stock for item: {
    "item_code": "SCMBR0018164",
    "total_bottles": 48,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-24 14:59:16] Month is archived, updating archive table with cascading
[2025-12-24 14:59:16] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "dayOfMonth": "18",
    "totalBottles": 48
}
[2025-12-24 14:59:16] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "purchaseDay": "18"
}
[2025-12-24 14:59:16] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 14:59:16] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 14:59:16] Cascading updates completed for all days after purchase day
[2025-12-24 14:59:16] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018164",
    "purchaseDate": "2025-11-18"
}
[2025-12-24 14:59:16] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 14:59:17] Cascading completed up to current date
[2025-12-24 14:59:17] Purchase items processing completed: {
    "successful_items": 3
}
[2025-12-24 14:59:17] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 14:59:51] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:59:51] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:59:51] POST data: []
[2025-12-24 14:59:51] GET data: {
    "mode": "F"
}
[2025-12-24 14:59:51] Company ID from session: 1
[2025-12-24 14:59:51] Database connection included
[2025-12-24 14:59:51] License functions included
[2025-12-24 14:59:51] License type: FL-II
[2025-12-24 14:59:51] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:59:51] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:59:51] Purchase mode: F
[2025-12-24 14:59:51] Next voucher number: 5
[2025-12-24 14:59:51] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:59:51] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:59:51] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 14:59:51] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:59:51] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:59:51] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 14:59:51] POST data: []
[2025-12-24 14:59:51] GET data: {
    "mode": "F"
}
[2025-12-24 14:59:51] Company ID from session: 1
[2025-12-24 14:59:51] Database connection included
[2025-12-24 14:59:51] License functions included
[2025-12-24 14:59:51] License type: FL-II
[2025-12-24 14:59:51] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 14:59:51] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 14:59:51] Purchase mode: F
[2025-12-24 14:59:51] Next voucher number: 5
[2025-12-24 14:59:51] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 14:59:51] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 14:59:51] Items fetched from database: {
    "count": 3757,
    "license_filter_applied": true
}
[2025-12-24 14:59:51] Suppliers fetched: {
    "count": 36
}
[2025-12-24 14:59:51] Database connection closed
[2025-12-24 14:59:51] === PURCHASE SESSION ENDED ===
[2025-12-24 15:01:25] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:01:25] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:01:25] POST data: []
[2025-12-24 15:01:25] GET data: {
    "mode": "F"
}
[2025-12-24 15:01:25] Company ID from session: 1
[2025-12-24 15:01:25] Database connection included
[2025-12-24 15:01:25] License functions included
[2025-12-24 15:01:25] License type: FL-II
[2025-12-24 15:01:25] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:01:25] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:01:25] Purchase mode: F
[2025-12-24 15:01:25] Next voucher number: 5
[2025-12-24 15:01:25] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:01:25] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:01:26] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:01:26] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:01:26] Database connection closed
[2025-12-24 15:01:26] === PURCHASE SESSION ENDED ===
[2025-12-24 15:01:37] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:01:37] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:01:37] POST data: []
[2025-12-24 15:01:37] GET data: {
    "mode": "F"
}
[2025-12-24 15:01:37] Company ID from session: 1
[2025-12-24 15:01:37] Database connection included
[2025-12-24 15:01:37] License functions included
[2025-12-24 15:01:37] License type: FL-II
[2025-12-24 15:01:37] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:01:37] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:01:37] Purchase mode: F
[2025-12-24 15:01:37] Next voucher number: 5
[2025-12-24 15:01:37] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:01:37] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:01:37] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:01:37] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:01:38] Database connection closed
[2025-12-24 15:01:38] === PURCHASE SESSION ENDED ===
[2025-12-24 15:01:48] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:01:48] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:01:48] POST data: []
[2025-12-24 15:01:48] GET data: {
    "mode": "F"
}
[2025-12-24 15:01:48] Company ID from session: 1
[2025-12-24 15:01:48] Database connection included
[2025-12-24 15:01:48] License functions included
[2025-12-24 15:01:48] License type: FL-II
[2025-12-24 15:01:48] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:01:48] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:01:48] Purchase mode: F
[2025-12-24 15:01:48] Next voucher number: 5
[2025-12-24 15:01:48] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:01:48] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:01:49] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:01:49] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:01:49] Database connection closed
[2025-12-24 15:01:49] === PURCHASE SESSION ENDED ===
[2025-12-24 15:02:02] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:02:02] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:02:02] POST data: {
    "mode": "F",
    "voc_no": "5",
    "date": "2025-11-18",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "SAMBARAGI TRADERS",
    "supplier_code": "SAMB",
    "items": [
        {
            "code": "SCMKS0039633",
            "name": "Smirnoff Minty Jamum Triple Distilled Flavoured Vo",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "33",
            "auto_batch": "BTOS190-1291",
            "mfg_month": "Oct-2025",
            "bl": "0.54",
            "vv": "25",
            "tot_bott": "3",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "3",
            "case_rate": "80.000",
            "mrp": "440"
        },
        {
            "code": "SCMLS0042805",
            "name": "Johnnie Walker Blonde Blended Scotch Whisky .",
            "size": "200 ML (24)",
            "bottles_per_case": "24",
            "batch_no": "I1221025",
            "auto_batch": "BTOI67-824",
            "mfg_month": "Sep-2025",
            "bl": "0.2",
            "vv": "25",
            "tot_bott": "1",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "1",
            "case_rate": "0.000",
            "mrp": "850"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "240.00",
    "tamt": "240.00"
}
[2025-12-24 15:02:02] GET data: {
    "mode": "F"
}
[2025-12-24 15:02:02] Company ID from session: 1
[2025-12-24 15:02:02] Database connection included
[2025-12-24 15:02:02] License functions included
[2025-12-24 15:02:02] License type: FL-II
[2025-12-24 15:02:02] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:02:02] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:02:02] Purchase mode: F
[2025-12-24 15:02:02] Next voucher number: 5
[2025-12-24 15:02:02] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:02:02] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:02:02] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:02:02] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:02:02] === FORM SUBMISSION STARTED ===
[2025-12-24 15:02:02] Form data extracted: {
    "date": "2025-11-18",
    "voc_no": "5",
    "auto_tp_no": "FL167-171125\/17008",
    "tp_no": "17007",
    "tp_date": "2025-11-17",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "SAMB",
    "supplier_name": "SAMBARAGI TRADERS",
    "basic_amt": "240.00",
    "total_amt": "240.00"
}
[2025-12-24 15:02:02] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 15:02:02] Purchase header inserted successfully: {
    "purchase_id": 5,
    "affected_rows": 1
}
[2025-12-24 15:02:02] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-24 15:02:02] Processing item 0: {
    "item_code": "SCMKS0039633",
    "mrp": 440,
    "tot_bott": 3
}
[2025-12-24 15:02:02] cleanItemCode: 'SCMKS0039633' -> 'KS0039633'
[2025-12-24 15:02:02] Updating MRP for item: {
    "item_code": "KS0039633",
    "mrp": 440
}
[2025-12-24 15:02:02] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "KS0039633",
    "mrp": 440
}
[2025-12-24 15:02:02] Updating stock for item: {
    "item_code": "SCMKS0039633",
    "total_bottles": 3,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:02:02] Month is archived, updating archive table with cascading
[2025-12-24 15:02:02] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "dayOfMonth": "18",
    "totalBottles": 3
}
[2025-12-24 15:02:02] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKS0039633",
    "purchaseDay": "18"
}
[2025-12-24 15:02:02] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:02:02] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:02] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:02] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:02] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:02] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:02] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:02] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:02] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:03] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:03] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:03] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:03] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:03] Cascading updates completed for all days after purchase day
[2025-12-24 15:02:03] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMKS0039633",
    "purchaseDate": "2025-11-18"
}
[2025-12-24 15:02:03] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:02:03] Cascading completed up to current date
[2025-12-24 15:02:03] Processing item 1: {
    "item_code": "SCMLS0042805",
    "mrp": 850,
    "tot_bott": 1
}
[2025-12-24 15:02:03] cleanItemCode: 'SCMLS0042805' -> 'LS0042805'
[2025-12-24 15:02:03] Updating MRP for item: {
    "item_code": "LS0042805",
    "mrp": 850
}
[2025-12-24 15:02:03] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "LS0042805",
    "mrp": 850
}
[2025-12-24 15:02:03] Updating stock for item: {
    "item_code": "SCMLS0042805",
    "total_bottles": 1,
    "purchase_date": "2025-11-18",
    "day_of_month": "18",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:02:03] Month is archived, updating archive table with cascading
[2025-12-24 15:02:03] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMLS0042805",
    "dayOfMonth": "18",
    "totalBottles": 1
}
[2025-12-24 15:02:03] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMLS0042805",
    "purchaseDate": "2025-11-18"
}
[2025-12-24 15:02:03] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:02:03] Cascading completed up to current date
[2025-12-24 15:02:03] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-24 15:02:03] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 15:02:26] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:02:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:02:26] POST data: []
[2025-12-24 15:02:26] GET data: {
    "mode": "F"
}
[2025-12-24 15:02:26] Company ID from session: 1
[2025-12-24 15:02:26] Database connection included
[2025-12-24 15:02:26] License functions included
[2025-12-24 15:02:26] License type: FL-II
[2025-12-24 15:02:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:02:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:02:26] Purchase mode: F
[2025-12-24 15:02:26] Next voucher number: 6
[2025-12-24 15:02:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:02:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:02:26] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:02:26] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:02:26] Database connection closed
[2025-12-24 15:02:26] === PURCHASE SESSION ENDED ===
[2025-12-24 15:02:34] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:02:34] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:02:34] POST data: {
    "mode": "F",
    "voc_no": "6",
    "date": "2025-11-19",
    "auto_tp_no": "FL177-181125\/10070",
    "tp_no": "10070",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "ROCKY TRADERS",
    "supplier_code": "ROCK",
    "items": [
        {
            "code": "SCMPL0041325",
            "name": "Old Monk Very Old Vatted XXX Rum .",
            "size": "90 ML-(96)",
            "bottles_per_case": "96",
            "batch_no": "409",
            "auto_batch": "BTP31-311025\/409",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "110"
        },
        {
            "code": "SCMPL0041326",
            "name": "Old Monk Very Old Vatted XXX Rum .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "441",
            "auto_batch": "BTP31-111125\/441",
            "mfg_month": "Nov-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "215"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "960.00",
    "tamt": "960.00"
}
[2025-12-24 15:02:34] GET data: {
    "mode": "F"
}
[2025-12-24 15:02:34] Company ID from session: 1
[2025-12-24 15:02:34] Database connection included
[2025-12-24 15:02:34] License functions included
[2025-12-24 15:02:34] License type: FL-II
[2025-12-24 15:02:34] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:02:34] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:02:34] Purchase mode: F
[2025-12-24 15:02:34] Next voucher number: 6
[2025-12-24 15:02:34] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:02:34] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:02:34] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:02:34] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:02:34] === FORM SUBMISSION STARTED ===
[2025-12-24 15:02:34] Form data extracted: {
    "date": "2025-11-19",
    "voc_no": "6",
    "auto_tp_no": "FL177-181125\/10070",
    "tp_no": "10070",
    "tp_date": "2025-11-18",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "ROCK",
    "supplier_name": "ROCKY TRADERS",
    "basic_amt": "960.00",
    "total_amt": "960.00"
}
[2025-12-24 15:02:34] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 15:02:34] Purchase header inserted successfully: {
    "purchase_id": 6,
    "affected_rows": 1
}
[2025-12-24 15:02:34] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-24 15:02:34] Processing item 0: {
    "item_code": "SCMPL0041325",
    "mrp": 110,
    "tot_bott": 96
}
[2025-12-24 15:02:34] cleanItemCode: 'SCMPL0041325' -> 'PL0041325'
[2025-12-24 15:02:34] Updating MRP for item: {
    "item_code": "PL0041325",
    "mrp": 110
}
[2025-12-24 15:02:34] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0041325",
    "mrp": 110
}
[2025-12-24 15:02:34] Updating stock for item: {
    "item_code": "SCMPL0041325",
    "total_bottles": 96,
    "purchase_date": "2025-11-19",
    "day_of_month": "19",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:02:34] Month is archived, updating archive table with cascading
[2025-12-24 15:02:34] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041325",
    "dayOfMonth": "19",
    "totalBottles": 96
}
[2025-12-24 15:02:34] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041325",
    "purchaseDay": "19"
}
[2025-12-24 15:02:34] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:02:34] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:34] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:34] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:34] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:34] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:34] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:34] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading updates completed for all days after purchase day
[2025-12-24 15:02:35] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0041325",
    "purchaseDate": "2025-11-19"
}
[2025-12-24 15:02:35] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:02:35] Cascading completed up to current date
[2025-12-24 15:02:35] Processing item 1: {
    "item_code": "SCMPL0041326",
    "mrp": 215,
    "tot_bott": 96
}
[2025-12-24 15:02:35] cleanItemCode: 'SCMPL0041326' -> 'PL0041326'
[2025-12-24 15:02:35] Updating MRP for item: {
    "item_code": "PL0041326",
    "mrp": 215
}
[2025-12-24 15:02:35] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0041326",
    "mrp": 215
}
[2025-12-24 15:02:35] Updating stock for item: {
    "item_code": "SCMPL0041326",
    "total_bottles": 96,
    "purchase_date": "2025-11-19",
    "day_of_month": "19",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:02:35] Month is archived, updating archive table with cascading
[2025-12-24 15:02:35] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041326",
    "dayOfMonth": "19",
    "totalBottles": 96
}
[2025-12-24 15:02:35] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0041326",
    "purchaseDay": "19"
}
[2025-12-24 15:02:35] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:02:35] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:35] Cascading updates completed for all days after purchase day
[2025-12-24 15:02:35] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0041326",
    "purchaseDate": "2025-11-19"
}
[2025-12-24 15:02:35] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:02:36] Cascading completed up to current date
[2025-12-24 15:02:36] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-24 15:02:36] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 15:02:52] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:02:52] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:02:52] POST data: []
[2025-12-24 15:02:52] GET data: {
    "mode": "F"
}
[2025-12-24 15:02:52] Company ID from session: 1
[2025-12-24 15:02:52] Database connection included
[2025-12-24 15:02:52] License functions included
[2025-12-24 15:02:52] License type: FL-II
[2025-12-24 15:02:52] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:02:52] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:02:52] Purchase mode: F
[2025-12-24 15:02:52] Next voucher number: 7
[2025-12-24 15:02:52] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:02:52] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:02:52] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:02:52] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:02:52] Database connection closed
[2025-12-24 15:02:52] === PURCHASE SESSION ENDED ===
[2025-12-24 15:02:58] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:02:58] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:02:58] POST data: {
    "mode": "F",
    "voc_no": "7",
    "date": "2025-11-23",
    "auto_tp_no": "FL170-221125\/24665",
    "tp_no": "24666",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "HARESH TRADERS",
    "supplier_code": "HARE",
    "items": [
        {
            "code": "SCMBR0018161",
            "name": "Tuborg Strong Premium Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "810",
            "auto_batch": "BTBL5-121025\/965",
            "mfg_month": "Oct-2025",
            "bl": "39.6",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "130"
        },
        {
            "code": "SCMBR0018164",
            "name": "Tuborg Strong Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "901",
            "auto_batch": "BTBL5-071125\/1086",
            "mfg_month": "Nov-2025",
            "bl": "117",
            "vv": "8",
            "tot_bott": "180",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "15",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "195"
        },
        {
            "code": "SCMPL0036328",
            "name": "Royal Challenge Finest Premium Whisky .",
            "size": "90 ML(100)",
            "bottles_per_case": "100",
            "batch_no": "497",
            "auto_batch": "BTP17-311025\/497",
            "mfg_month": "Nov-2025",
            "bl": "9",
            "vv": "25",
            "tot_bott": "100",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "120.000",
            "mrp": "135"
        },
        {
            "code": "SCMPL0042623",
            "name": "Royal Challenge Classic Premium Whisky .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "031",
            "auto_batch": "BTP4-041125\/653",
            "mfg_month": "Nov-2025",
            "bl": "17.28",
            "vv": "25",
            "tot_bott": "96",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "2",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "250"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "12680.00",
    "tamt": "12680.00"
}
[2025-12-24 15:02:58] GET data: {
    "mode": "F"
}
[2025-12-24 15:02:58] Company ID from session: 1
[2025-12-24 15:02:58] Database connection included
[2025-12-24 15:02:58] License functions included
[2025-12-24 15:02:58] License type: FL-II
[2025-12-24 15:02:58] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:02:58] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:02:58] Purchase mode: F
[2025-12-24 15:02:58] Next voucher number: 7
[2025-12-24 15:02:59] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:02:59] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:02:59] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:02:59] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:02:59] === FORM SUBMISSION STARTED ===
[2025-12-24 15:02:59] Form data extracted: {
    "date": "2025-11-23",
    "voc_no": "7",
    "auto_tp_no": "FL170-221125\/24665",
    "tp_no": "24666",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "HARE",
    "supplier_name": "HARESH TRADERS",
    "basic_amt": "12680.00",
    "total_amt": "12680.00"
}
[2025-12-24 15:02:59] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 15:02:59] Purchase header inserted successfully: {
    "purchase_id": 7,
    "affected_rows": 1
}
[2025-12-24 15:02:59] Starting to process purchase items: {
    "item_count": 4
}
[2025-12-24 15:02:59] Processing item 0: {
    "item_code": "SCMBR0018161",
    "mrp": 130,
    "tot_bott": 120
}
[2025-12-24 15:02:59] cleanItemCode: 'SCMBR0018161' -> 'BR0018161'
[2025-12-24 15:02:59] Updating MRP for item: {
    "item_code": "BR0018161",
    "mrp": 130
}
[2025-12-24 15:02:59] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018161",
    "mrp": 130
}
[2025-12-24 15:02:59] Updating stock for item: {
    "item_code": "SCMBR0018161",
    "total_bottles": 120,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:02:59] Month is archived, updating archive table with cascading
[2025-12-24 15:02:59] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "dayOfMonth": "23",
    "totalBottles": 120
}
[2025-12-24 15:02:59] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018161",
    "purchaseDay": "23"
}
[2025-12-24 15:02:59] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:02:59] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:59] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:59] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:59] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:59] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:59] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:59] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:02:59] Cascading updates completed for all days after purchase day
[2025-12-24 15:02:59] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018161",
    "purchaseDate": "2025-11-23"
}
[2025-12-24 15:02:59] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:02:59] Cascading completed up to current date
[2025-12-24 15:02:59] Processing item 1: {
    "item_code": "SCMBR0018164",
    "mrp": 195,
    "tot_bott": 180
}
[2025-12-24 15:02:59] cleanItemCode: 'SCMBR0018164' -> 'BR0018164'
[2025-12-24 15:02:59] Updating MRP for item: {
    "item_code": "BR0018164",
    "mrp": 195
}
[2025-12-24 15:02:59] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018164",
    "mrp": 195
}
[2025-12-24 15:02:59] Updating stock for item: {
    "item_code": "SCMBR0018164",
    "total_bottles": 180,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:02:59] Month is archived, updating archive table with cascading
[2025-12-24 15:02:59] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "dayOfMonth": "23",
    "totalBottles": 180
}
[2025-12-24 15:02:59] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018164",
    "purchaseDay": "23"
}
[2025-12-24 15:02:59] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:03:00] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:00] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:00] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:00] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:00] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:00] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:00] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:00] Cascading updates completed for all days after purchase day
[2025-12-24 15:03:00] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018164",
    "purchaseDate": "2025-11-23"
}
[2025-12-24 15:03:00] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:03:00] Cascading completed up to current date
[2025-12-24 15:03:00] Processing item 2: {
    "item_code": "SCMPL0036328",
    "mrp": 135,
    "tot_bott": 100
}
[2025-12-24 15:03:00] cleanItemCode: 'SCMPL0036328' -> 'PL0036328'
[2025-12-24 15:03:00] Updating MRP for item: {
    "item_code": "PL0036328",
    "mrp": 135
}
[2025-12-24 15:03:00] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036328",
    "mrp": 135
}
[2025-12-24 15:03:00] Updating stock for item: {
    "item_code": "SCMPL0036328",
    "total_bottles": 100,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:03:00] Month is archived, updating archive table with cascading
[2025-12-24 15:03:00] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036328",
    "dayOfMonth": "23",
    "totalBottles": 100
}
[2025-12-24 15:03:01] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036328",
    "purchaseDay": "23"
}
[2025-12-24 15:03:01] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:03:01] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading updates completed for all days after purchase day
[2025-12-24 15:03:01] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036328",
    "purchaseDate": "2025-11-23"
}
[2025-12-24 15:03:01] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:03:01] Cascading completed up to current date
[2025-12-24 15:03:01] Processing item 3: {
    "item_code": "SCMPL0042623",
    "mrp": 250,
    "tot_bott": 96
}
[2025-12-24 15:03:01] cleanItemCode: 'SCMPL0042623' -> 'PL0042623'
[2025-12-24 15:03:01] Updating MRP for item: {
    "item_code": "PL0042623",
    "mrp": 250
}
[2025-12-24 15:03:01] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0042623",
    "mrp": 250
}
[2025-12-24 15:03:01] Updating stock for item: {
    "item_code": "SCMPL0042623",
    "total_bottles": 96,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:03:01] Month is archived, updating archive table with cascading
[2025-12-24 15:03:01] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0042623",
    "dayOfMonth": "23",
    "totalBottles": 96
}
[2025-12-24 15:03:01] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0042623",
    "purchaseDay": "23"
}
[2025-12-24 15:03:01] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:03:01] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:01] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:02] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:02] Cascading updates completed for all days after purchase day
[2025-12-24 15:03:02] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0042623",
    "purchaseDate": "2025-11-23"
}
[2025-12-24 15:03:02] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:03:02] Cascading completed up to current date
[2025-12-24 15:03:02] Purchase items processing completed: {
    "successful_items": 4
}
[2025-12-24 15:03:02] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 15:03:42] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:03:42] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:03:42] POST data: []
[2025-12-24 15:03:42] GET data: {
    "mode": "F"
}
[2025-12-24 15:03:42] Company ID from session: 1
[2025-12-24 15:03:42] Database connection included
[2025-12-24 15:03:42] License functions included
[2025-12-24 15:03:42] License type: FL-II
[2025-12-24 15:03:42] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:03:42] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:03:42] Purchase mode: F
[2025-12-24 15:03:42] Next voucher number: 8
[2025-12-24 15:03:42] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:03:42] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:03:42] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:03:43] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:03:43] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:03:43] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:03:43] POST data: []
[2025-12-24 15:03:43] GET data: {
    "mode": "F"
}
[2025-12-24 15:03:43] Company ID from session: 1
[2025-12-24 15:03:43] Database connection included
[2025-12-24 15:03:43] License functions included
[2025-12-24 15:03:43] License type: FL-II
[2025-12-24 15:03:43] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:03:43] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:03:43] Purchase mode: F
[2025-12-24 15:03:43] Next voucher number: 8
[2025-12-24 15:03:43] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:03:43] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:03:43] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:03:43] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:03:43] Database connection closed
[2025-12-24 15:03:43] === PURCHASE SESSION ENDED ===
[2025-12-24 15:03:49] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:03:49] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:03:49] POST data: {
    "mode": "F",
    "voc_no": "8",
    "date": "2025-11-23",
    "auto_tp_no": "FL1249-221125\/4570",
    "tp_no": "4595",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "supplier_code": "EM2",
    "items": [
        {
            "code": "SCMPL0010088",
            "name": "Seagram\\'s Imperial Blue Superior Grain Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2269",
            "auto_batch": "BTP28-171125\/2269",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "220"
        },
        {
            "code": "SCMPL0010702",
            "name": "Seagram\\'s Blenders Pride Ultra Premium Whisky .",
            "size": "180 ML",
            "bottles_per_case": "1",
            "batch_no": "2197",
            "auto_batch": "BTP28-121125\/2197",
            "mfg_month": "Nov-2025",
            "bl": "8.64",
            "vv": "25",
            "tot_bott": "48",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "100.000",
            "mrp": "380"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "200.00",
    "tamt": "200.00"
}
[2025-12-24 15:03:49] GET data: {
    "mode": "F"
}
[2025-12-24 15:03:49] Company ID from session: 1
[2025-12-24 15:03:49] Database connection included
[2025-12-24 15:03:49] License functions included
[2025-12-24 15:03:49] License type: FL-II
[2025-12-24 15:03:49] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:03:49] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:03:49] Purchase mode: F
[2025-12-24 15:03:49] Next voucher number: 8
[2025-12-24 15:03:49] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:03:49] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:03:49] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:03:49] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:03:49] === FORM SUBMISSION STARTED ===
[2025-12-24 15:03:49] Form data extracted: {
    "date": "2025-11-23",
    "voc_no": "8",
    "auto_tp_no": "FL1249-221125\/4570",
    "tp_no": "4595",
    "tp_date": "2025-11-22",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "EM2",
    "supplier_name": "EMPIRE SPIRT INDIA",
    "basic_amt": "200.00",
    "total_amt": "200.00"
}
[2025-12-24 15:03:49] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 15:03:49] Purchase header inserted successfully: {
    "purchase_id": 8,
    "affected_rows": 1
}
[2025-12-24 15:03:49] Starting to process purchase items: {
    "item_count": 2
}
[2025-12-24 15:03:49] Processing item 0: {
    "item_code": "SCMPL0010088",
    "mrp": 220,
    "tot_bott": 48
}
[2025-12-24 15:03:49] cleanItemCode: 'SCMPL0010088' -> 'PL0010088'
[2025-12-24 15:03:49] Updating MRP for item: {
    "item_code": "PL0010088",
    "mrp": 220
}
[2025-12-24 15:03:49] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010088",
    "mrp": 220
}
[2025-12-24 15:03:49] Updating stock for item: {
    "item_code": "SCMPL0010088",
    "total_bottles": 48,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:03:49] Month is archived, updating archive table with cascading
[2025-12-24 15:03:49] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010088",
    "dayOfMonth": "23",
    "totalBottles": 48
}
[2025-12-24 15:03:50] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010088",
    "purchaseDay": "23"
}
[2025-12-24 15:03:50] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:03:50] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading updates completed for all days after purchase day
[2025-12-24 15:03:50] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010088",
    "purchaseDate": "2025-11-23"
}
[2025-12-24 15:03:50] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:03:50] Cascading completed up to current date
[2025-12-24 15:03:50] Processing item 1: {
    "item_code": "SCMPL0010702",
    "mrp": 380,
    "tot_bott": 48
}
[2025-12-24 15:03:50] cleanItemCode: 'SCMPL0010702' -> 'PL0010702'
[2025-12-24 15:03:50] Updating MRP for item: {
    "item_code": "PL0010702",
    "mrp": 380
}
[2025-12-24 15:03:50] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010702",
    "mrp": 380
}
[2025-12-24 15:03:50] Updating stock for item: {
    "item_code": "SCMPL0010702",
    "total_bottles": 48,
    "purchase_date": "2025-11-23",
    "day_of_month": "23",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:03:50] Month is archived, updating archive table with cascading
[2025-12-24 15:03:50] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010702",
    "dayOfMonth": "23",
    "totalBottles": 48
}
[2025-12-24 15:03:50] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0010702",
    "purchaseDay": "23"
}
[2025-12-24 15:03:50] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:03:50] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:03:50] Cascading updates completed for all days after purchase day
[2025-12-24 15:03:50] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0010702",
    "purchaseDate": "2025-11-23"
}
[2025-12-24 15:03:50] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:03:51] Cascading completed up to current date
[2025-12-24 15:03:51] Purchase items processing completed: {
    "successful_items": 2
}
[2025-12-24 15:03:51] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 15:04:01] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:04:01] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:04:01] POST data: []
[2025-12-24 15:04:01] GET data: {
    "mode": "F"
}
[2025-12-24 15:04:01] Company ID from session: 1
[2025-12-24 15:04:01] Database connection included
[2025-12-24 15:04:01] License functions included
[2025-12-24 15:04:01] License type: FL-II
[2025-12-24 15:04:01] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:04:01] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:04:01] Purchase mode: F
[2025-12-24 15:04:01] Next voucher number: 9
[2025-12-24 15:04:01] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:04:01] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:04:01] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:04:01] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:04:02] Database connection closed
[2025-12-24 15:04:02] === PURCHASE SESSION ENDED ===
[2025-12-24 15:04:07] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:04:07] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:04:07] POST data: []
[2025-12-24 15:04:07] GET data: {
    "mode": "F"
}
[2025-12-24 15:04:07] Company ID from session: 1
[2025-12-24 15:04:07] Database connection included
[2025-12-24 15:04:07] License functions included
[2025-12-24 15:04:07] License type: FL-II
[2025-12-24 15:04:07] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:04:07] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:04:07] Purchase mode: F
[2025-12-24 15:04:07] Next voucher number: 9
[2025-12-24 15:04:07] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:04:07] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:04:07] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:04:07] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:04:08] Database connection closed
[2025-12-24 15:04:08] === PURCHASE SESSION ENDED ===
[2025-12-24 15:04:17] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:04:17] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:04:17] POST data: {
    "mode": "F",
    "voc_no": "9",
    "date": "2025-11-28",
    "auto_tp_no": "FL1305-271125\/12687",
    "tp_no": "12687",
    "tp_date": "2025-11-27",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMBR0009735",
            "name": "Budweiser Premium King of Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "975",
            "auto_batch": "BTBL6-271025\/978",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "5",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "170"
        },
        {
            "code": "SCMBR0018132",
            "name": "Budweiser Premium King of Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "993",
            "auto_batch": "BTBL6-291025\/995",
            "mfg_month": "Oct-2025",
            "bl": "39",
            "vv": "5",
            "tot_bott": "60",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "245"
        },
        {
            "code": "SCMBR0027089",
            "name": "Budweiser Magnum Super Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "887",
            "auto_batch": "BTBL6-061025\/888",
            "mfg_month": "Oct-2025",
            "bl": "78",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0036599",
            "name": "OAKSMITH INTERNATIONAL BLENDED WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "074",
            "auto_batch": "BTP69-280825\/74",
            "mfg_month": "Aug-2025",
            "bl": "2.16",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "12",
            "case_rate": "80.000",
            "mrp": "330"
        },
        {
            "code": "SCMPL0036598",
            "name": "OAKSMITH GOLD INTERNATIONAL BLENDED WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "094",
            "auto_batch": "BTP69-031025\/94",
            "mfg_month": "Oct-2025",
            "bl": "2.16",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "12",
            "case_rate": "800.000",
            "mrp": "400"
        },
        {
            "code": "SCMKB0031388",
            "name": "BUDWEISER MAGNUM UNIVERSAL KING OF BEERS .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "674",
            "auto_batch": "BTBL6-170825\/676",
            "mfg_month": "Aug-2025",
            "bl": "23.76",
            "vv": "8",
            "tot_bott": "72",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "180"
        },
        {
            "code": "SCMPL0031817",
            "name": "BREEZER Tangy CRANBERRY FLAVOUR .",
            "size": "275 ML(24)",
            "bottles_per_case": "24",
            "batch_no": "278",
            "auto_batch": "BTP67-131025\/278",
            "mfg_month": "Oct-2025",
            "bl": "6.6",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "22960.00",
    "tamt": "22960.00"
}
[2025-12-24 15:04:18] GET data: {
    "mode": "F"
}
[2025-12-24 15:04:18] Company ID from session: 1
[2025-12-24 15:04:18] Database connection included
[2025-12-24 15:04:18] License functions included
[2025-12-24 15:04:18] License type: FL-II
[2025-12-24 15:04:18] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:04:18] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:04:18] Purchase mode: F
[2025-12-24 15:04:18] Next voucher number: 9
[2025-12-24 15:04:18] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:04:18] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:04:18] === NEW PURCHASE SESSION STARTED ===
[2025-12-24 15:04:18] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:04:18] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:04:18] === FORM SUBMISSION STARTED ===
[2025-12-24 15:04:18] Form data extracted: {
    "date": "2025-11-28",
    "voc_no": "9",
    "auto_tp_no": "FL1305-271125\/12687",
    "tp_no": "12687",
    "tp_date": "2025-11-27",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "22960.00",
    "total_amt": "22960.00"
}
[2025-12-24 15:04:18] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 15:04:18] Purchase header inserted successfully: {
    "purchase_id": 9,
    "affected_rows": 1
}
[2025-12-24 15:04:18] Starting to process purchase items: {
    "item_count": 7
}
[2025-12-24 15:04:18] Processing item 0: {
    "item_code": "SCMBR0009735",
    "mrp": 170,
    "tot_bott": 24
}
[2025-12-24 15:04:18] cleanItemCode: 'SCMBR0009735' -> 'BR0009735'
[2025-12-24 15:04:18] Updating MRP for item: {
    "item_code": "BR0009735",
    "mrp": 170
}
[2025-12-24 15:04:18] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009735",
    "mrp": 170
}
[2025-12-24 15:04:18] Updating stock for item: {
    "item_code": "SCMBR0009735",
    "total_bottles": 24,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:18] Month is archived, updating archive table with cascading
[2025-12-24 15:04:18] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009735",
    "dayOfMonth": "28",
    "totalBottles": 24
}
[2025-12-24 15:04:18] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009735",
    "purchaseDay": "28"
}
[2025-12-24 15:04:18] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:18] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:18] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:18] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:18] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0009735",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:18] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:18] Cascading completed up to current date
[2025-12-24 15:04:18] Processing item 1: {
    "item_code": "SCMBR0018132",
    "mrp": 245,
    "tot_bott": 60
}
[2025-12-24 15:04:18] cleanItemCode: 'SCMBR0018132' -> 'BR0018132'
[2025-12-24 15:04:18] Updating MRP for item: {
    "item_code": "BR0018132",
    "mrp": 245
}
[2025-12-24 15:04:18] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018132",
    "mrp": 245
}
[2025-12-24 15:04:18] Updating stock for item: {
    "item_code": "SCMBR0018132",
    "total_bottles": 60,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:18] Month is archived, updating archive table with cascading
[2025-12-24 15:04:18] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018132",
    "dayOfMonth": "28",
    "totalBottles": 60
}
[2025-12-24 15:04:18] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018132",
    "purchaseDay": "28"
}
[2025-12-24 15:04:18] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:18] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:18] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:18] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:18] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018132",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:18] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:19] Cascading completed up to current date
[2025-12-24 15:04:19] Processing item 2: {
    "item_code": "SCMBR0027089",
    "mrp": 250,
    "tot_bott": 120
}
[2025-12-24 15:04:19] cleanItemCode: 'SCMBR0027089' -> 'BR0027089'
[2025-12-24 15:04:19] Updating MRP for item: {
    "item_code": "BR0027089",
    "mrp": 250
}
[2025-12-24 15:04:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0027089",
    "mrp": 250
}
[2025-12-24 15:04:19] Updating stock for item: {
    "item_code": "SCMBR0027089",
    "total_bottles": 120,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:19] Month is archived, updating archive table with cascading
[2025-12-24 15:04:19] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0027089",
    "dayOfMonth": "28",
    "totalBottles": 120
}
[2025-12-24 15:04:19] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0027089",
    "purchaseDay": "28"
}
[2025-12-24 15:04:19] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:19] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:19] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:19] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:19] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0027089",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:19] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:19] Cascading completed up to current date
[2025-12-24 15:04:19] Processing item 3: {
    "item_code": "SCMPL0036599",
    "mrp": 330,
    "tot_bott": 12
}
[2025-12-24 15:04:19] cleanItemCode: 'SCMPL0036599' -> 'PL0036599'
[2025-12-24 15:04:19] Updating MRP for item: {
    "item_code": "PL0036599",
    "mrp": 330
}
[2025-12-24 15:04:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036599",
    "mrp": 330
}
[2025-12-24 15:04:19] Updating stock for item: {
    "item_code": "SCMPL0036599",
    "total_bottles": 12,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:19] Month is archived, updating archive table with cascading
[2025-12-24 15:04:19] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036599",
    "dayOfMonth": "28",
    "totalBottles": 12
}
[2025-12-24 15:04:19] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036599",
    "purchaseDay": "28"
}
[2025-12-24 15:04:19] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:19] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:19] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:19] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:19] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036599",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:19] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:19] Cascading completed up to current date
[2025-12-24 15:04:19] Processing item 4: {
    "item_code": "SCMPL0036598",
    "mrp": 400,
    "tot_bott": 12
}
[2025-12-24 15:04:19] cleanItemCode: 'SCMPL0036598' -> 'PL0036598'
[2025-12-24 15:04:19] Updating MRP for item: {
    "item_code": "PL0036598",
    "mrp": 400
}
[2025-12-24 15:04:19] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036598",
    "mrp": 400
}
[2025-12-24 15:04:19] Updating stock for item: {
    "item_code": "SCMPL0036598",
    "total_bottles": 12,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:19] Month is archived, updating archive table with cascading
[2025-12-24 15:04:19] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036598",
    "dayOfMonth": "28",
    "totalBottles": 12
}
[2025-12-24 15:04:19] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036598",
    "purchaseDay": "28"
}
[2025-12-24 15:04:19] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:20] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:20] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:20] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:20] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036598",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:20] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:20] Cascading completed up to current date
[2025-12-24 15:04:20] Processing item 5: {
    "item_code": "SCMKB0031388",
    "mrp": 180,
    "tot_bott": 72
}
[2025-12-24 15:04:20] cleanItemCode: 'SCMKB0031388' -> 'KB0031388'
[2025-12-24 15:04:20] Updating MRP for item: {
    "item_code": "KB0031388",
    "mrp": 180
}
[2025-12-24 15:04:20] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "KB0031388",
    "mrp": 180
}
[2025-12-24 15:04:20] Updating stock for item: {
    "item_code": "SCMKB0031388",
    "total_bottles": 72,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:20] Month is archived, updating archive table with cascading
[2025-12-24 15:04:20] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKB0031388",
    "dayOfMonth": "28",
    "totalBottles": 72
}
[2025-12-24 15:04:20] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKB0031388",
    "purchaseDay": "28"
}
[2025-12-24 15:04:20] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:20] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:20] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:20] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:20] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMKB0031388",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:20] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:21] Cascading completed up to current date
[2025-12-24 15:04:21] Processing item 6: {
    "item_code": "SCMPL0031817",
    "mrp": 150,
    "tot_bott": 24
}
[2025-12-24 15:04:21] cleanItemCode: 'SCMPL0031817' -> 'PL0031817'
[2025-12-24 15:04:21] Updating MRP for item: {
    "item_code": "PL0031817",
    "mrp": 150
}
[2025-12-24 15:04:21] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0031817",
    "mrp": 150
}
[2025-12-24 15:04:21] Updating stock for item: {
    "item_code": "SCMPL0031817",
    "total_bottles": 24,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:21] Month is archived, updating archive table with cascading
[2025-12-24 15:04:21] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0031817",
    "dayOfMonth": "28",
    "totalBottles": 24
}
[2025-12-24 15:04:21] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0031817",
    "purchaseDay": "28"
}
[2025-12-24 15:04:21] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:21] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:21] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:21] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:21] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0031817",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:21] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:21] Cascading completed up to current date
[2025-12-24 15:04:21] Purchase items processing completed: {
    "successful_items": 7
}
[2025-12-24 15:04:21] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-24 15:04:21] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-24 15:04:21] POST data: {
    "mode": "F",
    "voc_no": "9",
    "date": "2025-11-28",
    "auto_tp_no": "FL1305-271125\/12687",
    "tp_no": "12687",
    "tp_date": "2025-11-27",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "AMAR TRADERS",
    "supplier_code": "AMAR",
    "items": [
        {
            "code": "SCMBR0009735",
            "name": "Budweiser Premium King of Beer .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "975",
            "auto_batch": "BTBL6-271025\/978",
            "mfg_month": "Oct-2025",
            "bl": "7.92",
            "vv": "5",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "170"
        },
        {
            "code": "SCMBR0018132",
            "name": "Budweiser Premium King of Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "993",
            "auto_batch": "BTBL6-291025\/995",
            "mfg_month": "Oct-2025",
            "bl": "39",
            "vv": "5",
            "tot_bott": "60",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "5",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "245"
        },
        {
            "code": "SCMBR0027089",
            "name": "Budweiser Magnum Super Premium Beer .",
            "size": "650 ML",
            "bottles_per_case": "1",
            "batch_no": "887",
            "auto_batch": "BTBL6-061025\/888",
            "mfg_month": "Oct-2025",
            "bl": "78",
            "vv": "8",
            "tot_bott": "120",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "10",
            "bottles": "0",
            "case_rate": "800.000",
            "mrp": "250"
        },
        {
            "code": "SCMPL0036599",
            "name": "OAKSMITH INTERNATIONAL BLENDED WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "074",
            "auto_batch": "BTP69-280825\/74",
            "mfg_month": "Aug-2025",
            "bl": "2.16",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "12",
            "case_rate": "80.000",
            "mrp": "330"
        },
        {
            "code": "SCMPL0036598",
            "name": "OAKSMITH GOLD INTERNATIONAL BLENDED WHISKY .",
            "size": "180 ML (Pet)",
            "bottles_per_case": "1",
            "batch_no": "094",
            "auto_batch": "BTP69-031025\/94",
            "mfg_month": "Oct-2025",
            "bl": "2.16",
            "vv": "25",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "0",
            "bottles": "12",
            "case_rate": "800.000",
            "mrp": "400"
        },
        {
            "code": "SCMKB0031388",
            "name": "BUDWEISER MAGNUM UNIVERSAL KING OF BEERS .",
            "size": "330 ML",
            "bottles_per_case": "1",
            "batch_no": "674",
            "auto_batch": "BTBL6-170825\/676",
            "mfg_month": "Aug-2025",
            "bl": "23.76",
            "vv": "8",
            "tot_bott": "72",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "3",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "180"
        },
        {
            "code": "SCMPL0031817",
            "name": "BREEZER Tangy CRANBERRY FLAVOUR .",
            "size": "275 ML(24)",
            "bottles_per_case": "24",
            "batch_no": "278",
            "auto_batch": "BTP67-131025\/278",
            "mfg_month": "Oct-2025",
            "bl": "6.6",
            "vv": "25",
            "tot_bott": "24",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "150"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "22960.00",
    "tamt": "22960.00"
}
[2025-12-24 15:04:21] GET data: {
    "mode": "F"
}
[2025-12-24 15:04:21] Company ID from session: 1
[2025-12-24 15:04:21] Database connection included
[2025-12-24 15:04:21] License functions included
[2025-12-24 15:04:21] License type: FL-II
[2025-12-24 15:04:21] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-24 15:04:21] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-24 15:04:21] Purchase mode: F
[2025-12-24 15:04:21] Next voucher number: 10
[2025-12-24 15:04:21] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-24 15:04:21] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-24 15:04:21] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-24 15:04:21] Suppliers fetched: {
    "count": 36
}
[2025-12-24 15:04:21] === FORM SUBMISSION STARTED ===
[2025-12-24 15:04:21] Form data extracted: {
    "date": "2025-11-28",
    "voc_no": "9",
    "auto_tp_no": "FL1305-271125\/12687",
    "tp_no": "12687",
    "tp_date": "2025-11-27",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "AMAR",
    "supplier_name": "AMAR TRADERS",
    "basic_amt": "22960.00",
    "total_amt": "22960.00"
}
[2025-12-24 15:04:21] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-24 15:04:21] Purchase header inserted successfully: {
    "purchase_id": 10,
    "affected_rows": 1
}
[2025-12-24 15:04:21] Starting to process purchase items: {
    "item_count": 7
}
[2025-12-24 15:04:21] Processing item 0: {
    "item_code": "SCMBR0009735",
    "mrp": 170,
    "tot_bott": 24
}
[2025-12-24 15:04:21] cleanItemCode: 'SCMBR0009735' -> 'BR0009735'
[2025-12-24 15:04:21] Updating MRP for item: {
    "item_code": "BR0009735",
    "mrp": 170
}
[2025-12-24 15:04:21] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0009735",
    "mrp": 170
}
[2025-12-24 15:04:21] Updating stock for item: {
    "item_code": "SCMBR0009735",
    "total_bottles": 24,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:21] Month is archived, updating archive table with cascading
[2025-12-24 15:04:21] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009735",
    "dayOfMonth": "28",
    "totalBottles": 24
}
[2025-12-24 15:04:21] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0009735",
    "purchaseDay": "28"
}
[2025-12-24 15:04:21] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:21] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:21] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:22] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:22] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0009735",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:22] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:22] Cascading completed up to current date
[2025-12-24 15:04:22] Processing item 1: {
    "item_code": "SCMBR0018132",
    "mrp": 245,
    "tot_bott": 60
}
[2025-12-24 15:04:22] cleanItemCode: 'SCMBR0018132' -> 'BR0018132'
[2025-12-24 15:04:22] Updating MRP for item: {
    "item_code": "BR0018132",
    "mrp": 245
}
[2025-12-24 15:04:22] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0018132",
    "mrp": 245
}
[2025-12-24 15:04:22] Updating stock for item: {
    "item_code": "SCMBR0018132",
    "total_bottles": 60,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:22] Month is archived, updating archive table with cascading
[2025-12-24 15:04:22] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018132",
    "dayOfMonth": "28",
    "totalBottles": 60
}
[2025-12-24 15:04:22] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0018132",
    "purchaseDay": "28"
}
[2025-12-24 15:04:22] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:22] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:22] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:22] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:22] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0018132",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:22] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:22] Cascading completed up to current date
[2025-12-24 15:04:22] Processing item 2: {
    "item_code": "SCMBR0027089",
    "mrp": 250,
    "tot_bott": 120
}
[2025-12-24 15:04:22] cleanItemCode: 'SCMBR0027089' -> 'BR0027089'
[2025-12-24 15:04:22] Updating MRP for item: {
    "item_code": "BR0027089",
    "mrp": 250
}
[2025-12-24 15:04:22] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "BR0027089",
    "mrp": 250
}
[2025-12-24 15:04:22] Updating stock for item: {
    "item_code": "SCMBR0027089",
    "total_bottles": 120,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:22] Month is archived, updating archive table with cascading
[2025-12-24 15:04:22] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0027089",
    "dayOfMonth": "28",
    "totalBottles": 120
}
[2025-12-24 15:04:22] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMBR0027089",
    "purchaseDay": "28"
}
[2025-12-24 15:04:22] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:22] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:22] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:22] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:22] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMBR0027089",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:22] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:23] Cascading completed up to current date
[2025-12-24 15:04:23] Processing item 3: {
    "item_code": "SCMPL0036599",
    "mrp": 330,
    "tot_bott": 12
}
[2025-12-24 15:04:23] cleanItemCode: 'SCMPL0036599' -> 'PL0036599'
[2025-12-24 15:04:23] Updating MRP for item: {
    "item_code": "PL0036599",
    "mrp": 330
}
[2025-12-24 15:04:23] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036599",
    "mrp": 330
}
[2025-12-24 15:04:23] Updating stock for item: {
    "item_code": "SCMPL0036599",
    "total_bottles": 12,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:23] Month is archived, updating archive table with cascading
[2025-12-24 15:04:23] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036599",
    "dayOfMonth": "28",
    "totalBottles": 12
}
[2025-12-24 15:04:23] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036599",
    "purchaseDay": "28"
}
[2025-12-24 15:04:23] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:23] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:23] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:23] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:23] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036599",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:23] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:23] Cascading completed up to current date
[2025-12-24 15:04:23] Processing item 4: {
    "item_code": "SCMPL0036598",
    "mrp": 400,
    "tot_bott": 12
}
[2025-12-24 15:04:23] cleanItemCode: 'SCMPL0036598' -> 'PL0036598'
[2025-12-24 15:04:23] Updating MRP for item: {
    "item_code": "PL0036598",
    "mrp": 400
}
[2025-12-24 15:04:23] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0036598",
    "mrp": 400
}
[2025-12-24 15:04:23] Updating stock for item: {
    "item_code": "SCMPL0036598",
    "total_bottles": 12,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:23] Month is archived, updating archive table with cascading
[2025-12-24 15:04:23] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036598",
    "dayOfMonth": "28",
    "totalBottles": 12
}
[2025-12-24 15:04:23] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0036598",
    "purchaseDay": "28"
}
[2025-12-24 15:04:23] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:23] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:23] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:23] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:23] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0036598",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:23] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:23] Cascading completed up to current date
[2025-12-24 15:04:23] Processing item 5: {
    "item_code": "SCMKB0031388",
    "mrp": 180,
    "tot_bott": 72
}
[2025-12-24 15:04:24] cleanItemCode: 'SCMKB0031388' -> 'KB0031388'
[2025-12-24 15:04:24] Updating MRP for item: {
    "item_code": "KB0031388",
    "mrp": 180
}
[2025-12-24 15:04:24] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "KB0031388",
    "mrp": 180
}
[2025-12-24 15:04:24] Updating stock for item: {
    "item_code": "SCMKB0031388",
    "total_bottles": 72,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:24] Month is archived, updating archive table with cascading
[2025-12-24 15:04:24] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKB0031388",
    "dayOfMonth": "28",
    "totalBottles": 72
}
[2025-12-24 15:04:24] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMKB0031388",
    "purchaseDay": "28"
}
[2025-12-24 15:04:24] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:24] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:24] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:24] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:24] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMKB0031388",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:24] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:24] Cascading completed up to current date
[2025-12-24 15:04:24] Processing item 6: {
    "item_code": "SCMPL0031817",
    "mrp": 150,
    "tot_bott": 24
}
[2025-12-24 15:04:24] cleanItemCode: 'SCMPL0031817' -> 'PL0031817'
[2025-12-24 15:04:24] Updating MRP for item: {
    "item_code": "PL0031817",
    "mrp": 150
}
[2025-12-24 15:04:24] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0031817",
    "mrp": 150
}
[2025-12-24 15:04:24] Updating stock for item: {
    "item_code": "SCMPL0031817",
    "total_bottles": 24,
    "purchase_date": "2025-11-28",
    "day_of_month": "28",
    "month": "11",
    "year": "2025"
}
[2025-12-24 15:04:24] Month is archived, updating archive table with cascading
[2025-12-24 15:04:24] Updating archived month stock: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0031817",
    "dayOfMonth": "28",
    "totalBottles": 24
}
[2025-12-24 15:04:24] Starting cascading updates in table: {
    "table": "tbldailystock_1_11_25",
    "monthYear": "2025-11",
    "itemCode": "SCMPL0031817",
    "purchaseDay": "28"
}
[2025-12-24 15:04:24] Month has 30 days: {
    "timestamp": "2025-11-01",
    "daysInMonth": "30"
}
[2025-12-24 15:04:24] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:24] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1_11_25 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-24 15:04:24] Cascading updates completed for all days after purchase day
[2025-12-24 15:04:24] Continuing cascading to current month: {
    "comp_id": 1,
    "itemCode": "SCMPL0031817",
    "purchaseDate": "2025-11-28"
}
[2025-12-24 15:04:24] Starting cascading from month: {
    "startMonth": 12,
    "startYear": "2025"
}
[2025-12-24 15:04:24] Cascading completed up to current date
[2025-12-24 15:04:24] Purchase items processing completed: {
    "successful_items": 7
}
[2025-12-24 15:04:24] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2025-12-25 05:52:39] === NEW PURCHASE SESSION STARTED ===
[2025-12-25 05:52:39] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-25 05:52:39] POST data: []
[2025-12-25 05:52:39] GET data: []
[2025-12-25 05:52:39] Company ID from session: 1
[2025-12-25 05:52:39] Database connection included
[2025-12-25 05:52:39] License functions included
[2025-12-25 05:52:39] License type: FL-II
[2025-12-25 05:52:39] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-25 05:52:39] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-25 05:52:39] Purchase mode: F
[2025-12-25 05:52:39] Next voucher number: 10
[2025-12-25 05:52:39] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-25 05:52:39] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-25 05:52:40] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-25 05:52:40] Suppliers fetched: {
    "count": 36
}
[2025-12-25 05:52:40] Database connection closed
[2025-12-25 05:52:40] === PURCHASE SESSION ENDED ===
[2025-12-25 06:15:12] === NEW PURCHASE SESSION STARTED ===
[2025-12-25 06:15:12] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "sale_quantities": []
}
[2025-12-25 06:15:12] POST data: []
[2025-12-25 06:15:12] GET data: []
[2025-12-25 06:15:12] Company ID from session: 1
[2025-12-25 06:15:12] Database connection included
[2025-12-25 06:15:12] License functions included
[2025-12-25 06:15:12] License type: FL-II
[2025-12-25 06:15:12] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "8",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "10",
        "SGROUP": "O",
        "DESC": "OTHERS\/GENERAL",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "11",
        "SGROUP": "O",
        "DESC": "COLD DRINKS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "12",
        "SGROUP": "O",
        "DESC": "SODA",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "13",
        "SGROUP": "O",
        "DESC": "EXTRA CLASS",
        "LIQ_FLAG": "O"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-25 06:15:12] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "O",
    "L",
    "O",
    "O",
    "O",
    "O",
    "M",
    "I",
    "Q"
]
[2025-12-25 06:15:12] Purchase mode: F
[2025-12-25 06:15:12] Next voucher number: 10
[2025-12-25 06:15:12] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-25 06:15:12] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "O",
        "L",
        "O",
        "O",
        "O",
        "O",
        "M",
        "I",
        "Q"
    ],
    "types": "ssssssssssssssss"
}
[2025-12-25 06:15:12] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-25 06:15:12] Suppliers fetched: {
    "count": 36
}
[2025-12-25 06:15:12] Database connection closed
[2025-12-25 06:15:12] === PURCHASE SESSION ENDED ===
[2025-12-29 05:28:03] === NEW PURCHASE SESSION STARTED ===
[2025-12-29 05:28:03] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "last_submission": 1766978892,
    "sale_quantities": []
}
[2025-12-29 05:28:03] POST data: []
[2025-12-29 05:28:03] GET data: []
[2025-12-29 05:28:03] Company ID from session: 1
[2025-12-29 05:28:03] Database connection included
[2025-12-29 05:28:03] License functions included
[2025-12-29 05:28:03] License type: FL-II
[2025-12-29 05:28:03] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-29 05:28:03] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2025-12-29 05:28:03] Purchase mode: F
[2025-12-29 05:28:03] Next voucher number: 10
[2025-12-29 05:28:03] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-29 05:28:03] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2025-12-29 05:28:03] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-29 05:28:03] Suppliers fetched: {
    "count": 36
}
[2025-12-29 05:28:04] Database connection closed
[2025-12-29 05:28:04] === PURCHASE SESSION ENDED ===
[2025-12-29 14:47:00] === NEW PURCHASE SESSION STARTED ===
[2025-12-29 14:47:00] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-29 14:47:00] POST data: []
[2025-12-29 14:47:00] GET data: []
[2025-12-29 14:47:00] Company ID from session: 1
[2025-12-29 14:47:00] Database connection included
[2025-12-29 14:47:00] License functions included
[2025-12-29 14:47:00] License type: FL-II
[2025-12-29 14:47:00] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-29 14:47:00] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2025-12-29 14:47:00] Purchase mode: F
[2025-12-29 14:47:00] Next voucher number: 10
[2025-12-29 14:47:00] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-29 14:47:00] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2025-12-29 14:47:01] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-29 14:47:01] Suppliers fetched: {
    "count": 36
}
[2025-12-29 14:47:01] Database connection closed
[2025-12-29 14:47:01] === PURCHASE SESSION ENDED ===
[2025-12-31 06:44:05] === NEW PURCHASE SESSION STARTED ===
[2025-12-31 06:44:05] === NEW PURCHASE SESSION STARTED ===
[2025-12-31 06:44:05] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-31 06:44:05] POST data: []
[2025-12-31 06:44:05] GET data: {
    "mode": "F"
}
[2025-12-31 06:44:05] Company ID from session: 1
[2025-12-31 06:44:05] Database connection included
[2025-12-31 06:44:05] License functions included
[2025-12-31 06:44:05] License type: FL-II
[2025-12-31 06:44:05] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-31 06:44:05] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2025-12-31 06:44:05] Purchase mode: F
[2025-12-31 06:44:05] Next voucher number: 1
[2025-12-31 06:44:05] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-31 06:44:05] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2025-12-31 06:44:05] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-31 06:44:05] Suppliers fetched: {
    "count": 36
}
[2025-12-31 06:44:05] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-31 06:44:05] POST data: []
[2025-12-31 06:44:05] GET data: {
    "mode": "F"
}
[2025-12-31 06:44:05] Company ID from session: 1
[2025-12-31 06:44:05] Database connection included
[2025-12-31 06:44:05] License functions included
[2025-12-31 06:44:05] License type: FL-II
[2025-12-31 06:44:05] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-31 06:44:05] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2025-12-31 06:44:05] Purchase mode: F
[2025-12-31 06:44:05] Next voucher number: 1
[2025-12-31 06:44:05] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-31 06:44:05] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2025-12-31 06:44:06] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-31 06:44:06] Suppliers fetched: {
    "count": 36
}
[2025-12-31 06:44:06] Database connection closed
[2025-12-31 06:44:06] === PURCHASE SESSION ENDED ===
[2025-12-31 06:44:50] === NEW PURCHASE SESSION STARTED ===
[2025-12-31 06:44:50] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2025-12-31 06:44:50] POST data: {
    "mode": "F",
    "voc_no": "1",
    "date": "2025-12-15",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "2007",
    "tp_date": "2025-12-15",
    "inv_no": "",
    "inv_date": "",
    "supplier_name": "KASHMIRA TRADER",
    "supplier_code": "KASH",
    "items": [
        {
            "code": "SCMPL0010513",
            "name": "McDowell\\'s Green Label Superior Grain Whisky .",
            "size": "90 ML-(96)",
            "bottles_per_case": "12",
            "batch_no": "",
            "auto_batch": "",
            "mfg_month": "",
            "bl": "1.08",
            "vv": "0",
            "tot_bott": "12",
            "free_cases": "0",
            "free_bottles": "0",
            "cases": "1",
            "bottles": "0",
            "case_rate": "80.000",
            "mrp": "0"
        }
    ],
    "cash_disc": "0.00",
    "trade_disc": "0.00",
    "octroi": "0.00",
    "freight": "0.00",
    "stax_per": "0.00",
    "stax_amt": "0.00",
    "tcs_per": "0.00",
    "tcs_amt": "0.00",
    "misc_charg": "0.00",
    "basic_amt": "80.00",
    "tamt": "80.00"
}
[2025-12-31 06:44:50] GET data: {
    "mode": "F"
}
[2025-12-31 06:44:50] Company ID from session: 1
[2025-12-31 06:44:50] Database connection included
[2025-12-31 06:44:50] License functions included
[2025-12-31 06:44:50] License type: FL-II
[2025-12-31 06:44:50] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2025-12-31 06:44:50] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2025-12-31 06:44:50] Purchase mode: F
[2025-12-31 06:44:50] Next voucher number: 1
[2025-12-31 06:44:50] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2025-12-31 06:44:50] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2025-12-31 06:44:50] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2025-12-31 06:44:50] Suppliers fetched: {
    "count": 36
}
[2025-12-31 06:44:50] === FORM SUBMISSION STARTED ===
[2025-12-31 06:44:50] Form data extracted: {
    "date": "2025-12-15",
    "voc_no": "1",
    "auto_tp_no": "FL1249-191125\/4540",
    "tp_no": "2007",
    "tp_date": "2025-12-15",
    "inv_no": "",
    "inv_date": "",
    "supplier_code": "KASH",
    "supplier_name": "KASHMIRA TRADER",
    "basic_amt": "80.00",
    "total_amt": "80.00"
}
[2025-12-31 06:44:50] Purchase header insert query: {
    "query": "INSERT INTO tblpurchases (\n        DATE, SUBCODE, AUTO_TPNO, VOC_NO, INV_NO, INV_DATE, TAMT, \n        TPNO, TP_DATE, SCHDIS, CASHDIS, OCTROI, FREIGHT, STAX_PER, STAX_AMT, \n        TCS_PER, TCS_AMT, MISC_CHARG, PUR_FLAG, CompID\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"
}
[2025-12-31 06:44:50] Purchase header inserted successfully: {
    "purchase_id": 11,
    "affected_rows": 1
}
[2025-12-31 06:44:50] Starting to process purchase items: {
    "item_count": 1
}
[2025-12-31 06:44:50] Processing item 0: {
    "item_code": "SCMPL0010513",
    "mrp": 0,
    "tot_bott": 12
}
[2025-12-31 06:44:50] cleanItemCode: 'SCMPL0010513' -> 'PL0010513'
[2025-12-31 06:44:50] Updating MRP for item: {
    "item_code": "PL0010513",
    "mrp": 0
}
[2025-12-31 06:44:50] MRP update result: {
    "success": true,
    "affected_rows": 0,
    "clean_code": "PL0010513",
    "mrp": 0
}
[2025-12-31 06:44:50] Updating stock for item: {
    "item_code": "SCMPL0010513",
    "total_bottles": 12,
    "purchase_date": "2025-12-15",
    "day_of_month": "15",
    "month": "12",
    "year": "2025"
}
[2025-12-31 06:44:50] Month is current, updating current table with cascading
[2025-12-31 06:44:50] Updating current month stock: {
    "table": "tbldailystock_1",
    "monthYear": "2025-12",
    "itemCode": "SCMPL0010513",
    "dayOfMonth": "15",
    "totalBottles": 12
}
[2025-12-31 06:44:50] Starting cascading updates in table: {
    "table": "tbldailystock_1",
    "monthYear": "2025-12",
    "itemCode": "SCMPL0010513",
    "purchaseDay": "15"
}
[2025-12-31 06:44:50] Month has 31 days: {
    "timestamp": "2025-12-01",
    "daysInMonth": "31"
}
[2025-12-31 06:44:50] Cascading update for day 16: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_16_OPEN = DAY_15_CLOSING,\n                               DAY_16_CLOSING = DAY_15_CLOSING + DAY_16_PURCHASE - DAY_16_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_15_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 17: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_17_OPEN = DAY_16_CLOSING,\n                               DAY_17_CLOSING = DAY_16_CLOSING + DAY_17_PURCHASE - DAY_17_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_16_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 18: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_18_OPEN = DAY_17_CLOSING,\n                               DAY_18_CLOSING = DAY_17_CLOSING + DAY_18_PURCHASE - DAY_18_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_17_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 19: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_19_OPEN = DAY_18_CLOSING,\n                               DAY_19_CLOSING = DAY_18_CLOSING + DAY_19_PURCHASE - DAY_19_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_18_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 20: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_20_OPEN = DAY_19_CLOSING,\n                               DAY_20_CLOSING = DAY_19_CLOSING + DAY_20_PURCHASE - DAY_20_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_19_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 21: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_21_OPEN = DAY_20_CLOSING,\n                               DAY_21_CLOSING = DAY_20_CLOSING + DAY_21_PURCHASE - DAY_21_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_20_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 22: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_22_OPEN = DAY_21_CLOSING,\n                               DAY_22_CLOSING = DAY_21_CLOSING + DAY_22_PURCHASE - DAY_22_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_21_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 23: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_23_OPEN = DAY_22_CLOSING,\n                               DAY_23_CLOSING = DAY_22_CLOSING + DAY_23_PURCHASE - DAY_23_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_22_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:50] Cascading update for day 24: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_24_OPEN = DAY_23_CLOSING,\n                               DAY_24_CLOSING = DAY_23_CLOSING + DAY_24_PURCHASE - DAY_24_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_23_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading update for day 25: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_25_OPEN = DAY_24_CLOSING,\n                               DAY_25_CLOSING = DAY_24_CLOSING + DAY_25_PURCHASE - DAY_25_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_24_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading update for day 26: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_26_OPEN = DAY_25_CLOSING,\n                               DAY_26_CLOSING = DAY_25_CLOSING + DAY_26_PURCHASE - DAY_26_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_25_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading update for day 27: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_27_OPEN = DAY_26_CLOSING,\n                               DAY_27_CLOSING = DAY_26_CLOSING + DAY_27_PURCHASE - DAY_27_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_26_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading update for day 28: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_28_OPEN = DAY_27_CLOSING,\n                               DAY_28_CLOSING = DAY_27_CLOSING + DAY_28_PURCHASE - DAY_28_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_27_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading update for day 29: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_29_OPEN = DAY_28_CLOSING,\n                               DAY_29_CLOSING = DAY_28_CLOSING + DAY_29_PURCHASE - DAY_29_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_28_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading update for day 30: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_30_OPEN = DAY_29_CLOSING,\n                               DAY_30_CLOSING = DAY_29_CLOSING + DAY_30_PURCHASE - DAY_30_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_29_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading update for day 31: {
    "query": "UPDATE tbldailystock_1 \n                           SET DAY_31_OPEN = DAY_30_CLOSING,\n                               DAY_31_CLOSING = DAY_30_CLOSING + DAY_31_PURCHASE - DAY_31_SALES\n                           WHERE STK_MONTH = ? AND ITEM_CODE = ?",
    "prevDayClosing": "DAY_30_CLOSING",
    "columns_exist": true
}
[2025-12-31 06:44:51] Cascading updates completed for all days after purchase day
[2025-12-31 06:44:51] Purchase items processing completed: {
    "successful_items": 1
}
[2025-12-31 06:44:51] === FORM SUBMISSION COMPLETED SUCCESSFULLY ===
[2026-01-02 15:23:26] === NEW PURCHASE SESSION STARTED ===
[2026-01-02 15:23:26] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "last_submission": 1767362216,
    "sale_quantities": [],
    "selected_customer": 163
}
[2026-01-02 15:23:26] POST data: []
[2026-01-02 15:23:26] GET data: []
[2026-01-02 15:23:26] Company ID from session: 1
[2026-01-02 15:23:26] Database connection included
[2026-01-02 15:23:26] License functions included
[2026-01-02 15:23:26] License type: FL-II
[2026-01-02 15:23:26] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2026-01-02 15:23:26] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2026-01-02 15:23:26] Purchase mode: F
[2026-01-02 15:23:26] Next voucher number: 1
[2026-01-02 15:23:26] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2026-01-02 15:23:26] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2026-01-02 15:23:26] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2026-01-02 15:23:26] Suppliers fetched: {
    "count": 36
}
[2026-01-02 15:23:26] Database connection closed
[2026-01-02 15:23:26] === PURCHASE SESSION ENDED ===
[2026-01-02 16:19:18] === NEW PURCHASE SESSION STARTED ===
[2026-01-02 16:19:18] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "last_submission": 1767362216,
    "last_bill_data": {
        "bill_no": 1,
        "retail_bill_no": "BL0001",
        "customer_id": 162,
        "customer_name": "Sagar",
        "bill_date": "2026-01-02",
        "items": {
            "SCMPL0010694": {
                "code": "SCMPL0010694",
                "name": "AFTER DARK FINE GRAIN WHISKY .",
                "size": "180 ML",
                "rate": "700.000",
                "quantity": 1,
                "amount": 700
            }
        },
        "total_amount": 700,
        "tax_rate": 0.08,
        "tax_amount": 56,
        "final_amount": 756
    },
    "success_message": "Sales distributed successfully! Generated 0 bills. Total Amount: 0.00",
    "generated_bills": 0,
    "total_amount": 0,
    "sale_quantities": {
        "SCMPL0009678": 2
    }
}
[2026-01-02 16:19:18] POST data: []
[2026-01-02 16:19:18] GET data: []
[2026-01-02 16:19:18] Company ID from session: 1
[2026-01-02 16:19:18] Database connection included
[2026-01-02 16:19:18] License functions included
[2026-01-02 16:19:18] License type: FL-II
[2026-01-02 16:19:18] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2026-01-02 16:19:18] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2026-01-02 16:19:18] Purchase mode: F
[2026-01-02 16:19:18] Next voucher number: 1
[2026-01-02 16:19:18] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2026-01-02 16:19:18] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2026-01-02 16:19:18] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2026-01-02 16:19:18] Suppliers fetched: {
    "count": 36
}
[2026-01-02 16:19:18] Database connection closed
[2026-01-02 16:19:18] === PURCHASE SESSION ENDED ===
[2026-01-03 07:36:42] === NEW PURCHASE SESSION STARTED ===
[2026-01-03 07:36:42] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan"
}
[2026-01-03 07:36:42] POST data: []
[2026-01-03 07:36:42] GET data: []
[2026-01-03 07:36:42] Company ID from session: 1
[2026-01-03 07:36:42] Database connection included
[2026-01-03 07:36:42] License functions included
[2026-01-03 07:36:42] License type: FL-II
[2026-01-03 07:36:42] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2026-01-03 07:36:42] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2026-01-03 07:36:42] Purchase mode: F
[2026-01-03 07:36:42] Next voucher number: 1
[2026-01-03 07:36:42] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2026-01-03 07:36:42] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2026-01-03 07:36:43] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2026-01-03 07:36:43] Suppliers fetched: {
    "count": 36
}
[2026-01-03 07:36:43] Database connection closed
[2026-01-03 07:36:43] === PURCHASE SESSION ENDED ===
[2026-01-04 14:32:22] === NEW PURCHASE SESSION STARTED ===
[2026-01-04 14:32:22] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "sale_quantities": {
        "SCMPL0009678": 3,
        "SCMPL0009698": 3
    }
}
[2026-01-04 14:32:22] POST data: []
[2026-01-04 14:32:22] GET data: []
[2026-01-04 14:32:22] Company ID from session: 1
[2026-01-04 14:32:22] Database connection included
[2026-01-04 14:32:22] License functions included
[2026-01-04 14:32:22] License type: FL-II
[2026-01-04 14:32:22] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2026-01-04 14:32:22] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2026-01-04 14:32:22] Purchase mode: F
[2026-01-04 14:32:22] Next voucher number: 1
[2026-01-04 14:32:22] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2026-01-04 14:32:22] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2026-01-04 14:32:22] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2026-01-04 14:32:22] Suppliers fetched: {
    "count": 36
}
[2026-01-04 14:32:22] Database connection closed
[2026-01-04 14:32:22] === PURCHASE SESSION ENDED ===
[2026-01-05 06:13:02] === NEW PURCHASE SESSION STARTED ===
[2026-01-05 06:13:02] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "form_token": "45f31707a7541d9006636ec1199755ef21bcdc221de5de9cd5c79c9968d20ae7",
    "sale_items": [],
    "sale_count": 0,
    "current_focus_index": -1,
    "selected_customer": 162,
    "sale_cart": {
        "SCMPL0019030": {
            "code": "SCMPL0019030",
            "name": "20-20 Fine Whisky .",
            "size": "750 ML",
            "rate": "700.000",
            "quantity": 1,
            "amount": 700
        }
    }
}
[2026-01-05 06:13:02] POST data: []
[2026-01-05 06:13:02] GET data: []
[2026-01-05 06:13:02] Company ID from session: 1
[2026-01-05 06:13:02] Database connection included
[2026-01-05 06:13:02] License functions included
[2026-01-05 06:13:02] License type: FL-II
[2026-01-05 06:13:02] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2026-01-05 06:13:02] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2026-01-05 06:13:02] Purchase mode: F
[2026-01-05 06:13:02] Next voucher number: 1
[2026-01-05 06:13:02] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2026-01-05 06:13:02] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2026-01-05 06:13:02] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2026-01-05 06:13:02] Suppliers fetched: {
    "count": 36
}
[2026-01-05 06:13:02] Database connection closed
[2026-01-05 06:13:02] === PURCHASE SESSION ENDED ===
[2026-01-06 05:57:51] === NEW PURCHASE SESSION STARTED ===
[2026-01-06 05:57:51] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "sale_quantities": []
}
[2026-01-06 05:57:51] POST data: []
[2026-01-06 05:57:51] GET data: []
[2026-01-06 05:57:51] Company ID from session: 1
[2026-01-06 05:57:51] Database connection included
[2026-01-06 05:57:51] License functions included
[2026-01-06 05:57:51] License type: FL-II
[2026-01-06 05:57:51] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2026-01-06 05:57:51] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2026-01-06 05:57:51] Purchase mode: F
[2026-01-06 05:57:51] Next voucher number: 1
[2026-01-06 05:57:51] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2026-01-06 05:57:51] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2026-01-06 05:57:52] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2026-01-06 05:57:52] Suppliers fetched: {
    "count": 36
}
[2026-01-06 07:01:25] === NEW PURCHASE SESSION STARTED ===
[2026-01-06 07:01:25] Session data: {
    "user_id": "1",
    "username": "admin",
    "CompID": 1,
    "FIN_YEAR_ID": "1",
    "FIN_YEAR_START": "2025-04-01 12:24:30",
    "FIN_YEAR_END": "2026-03-31 12:24:30",
    "FIN_YEAR_DISPLAY": "2025-2026",
    "COMP_NAME": "Nandanwan",
    "sale_quantities": []
}
[2026-01-06 07:01:25] POST data: []
[2026-01-06 07:01:25] GET data: []
[2026-01-06 07:01:25] Company ID from session: 1
[2026-01-06 07:01:25] Database connection included
[2026-01-06 07:01:25] License functions included
[2026-01-06 07:01:25] License type: FL-II
[2026-01-06 07:01:25] Available classes: [
    {
        "SRNO": "1",
        "SGROUP": "W",
        "DESC": "WHISKY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "2",
        "SGROUP": "V",
        "DESC": "WINES",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "3",
        "SGROUP": "G",
        "DESC": "GIN",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "4",
        "SGROUP": "F",
        "DESC": "FERMENTED BEER",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "5",
        "SGROUP": "D",
        "DESC": "BRANDY",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "6",
        "SGROUP": "K",
        "DESC": "VODKA",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "7",
        "SGROUP": "R",
        "DESC": "RUM",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "9",
        "SGROUP": "L",
        "DESC": "LIQUORS",
        "LIQ_FLAG": "C"
    },
    {
        "SRNO": "14",
        "SGROUP": "M",
        "DESC": "Mild Beer",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "15",
        "SGROUP": "I",
        "DESC": "Imported Spirit",
        "LIQ_FLAG": "F"
    },
    {
        "SRNO": "16",
        "SGROUP": "Q",
        "DESC": "Wine Imp",
        "LIQ_FLAG": "F"
    }
]
[2026-01-06 07:01:25] Allowed class SGROUP values: [
    "W",
    "V",
    "G",
    "F",
    "D",
    "K",
    "R",
    "L",
    "M",
    "I",
    "Q"
]
[2026-01-06 07:01:25] Purchase mode: F
[2026-01-06 07:01:25] Next voucher number: 1
[2026-01-06 07:01:25] Distinct sizes from database: [
    "50",
    "60",
    "90",
    "170",
    "180",
    "200",
    "250",
    "275",
    "330",
    "355",
    "375",
    "500",
    "650",
    "700",
    "750",
    "1000",
    "1500",
    "1750",
    "2000",
    "3000",
    "4500",
    "15000",
    "20000",
    "30000",
    "50000"
]
[2026-01-06 07:01:25] Items query parameters: {
    "query": "SELECT im.CODE, im.DETAILS, im.DETAILS2, im.PPRICE, im.ITEM_GROUP, im.LIQ_FLAG, im.CLASS,\n                          COALESCE(sc.BOTTLE_PER_CASE, 12) AS BOTTLE_PER_CASE,\n                          CONCAT('SCM', im.CODE) AS SCM_CODE\n                     FROM tblitemmaster im\n                     LEFT JOIN tblsubclass sc ON im.ITEM_GROUP = sc.ITEM_GROUP AND im.LIQ_FLAG = sc.LIQ_FLAG\n                    WHERE im.CLASS IN (?,?,?,?,?,?,?,?,?,?,?)\n                 ORDER BY im.DETAILS",
    "params": [
        "W",
        "V",
        "G",
        "F",
        "D",
        "K",
        "R",
        "L",
        "M",
        "I",
        "Q"
    ],
    "types": "sssssssssss"
}
[2026-01-06 07:01:25] Items fetched from database: {
    "count": 3758,
    "license_filter_applied": true
}
[2026-01-06 07:01:25] Suppliers fetched: {
    "count": 36
}
[2026-01-06 07:01:25] Database connection closed
[2026-01-06 07:01:25] === PURCHASE SESSION ENDED ===
